diff --git a/dist/appData/widgets/common/common.js b/dist/appData/widgets/common/common.js
index fc8b13f..576d0f7 100644
--- a/dist/appData/widgets/common/common.js
+++ b/dist/appData/widgets/common/common.js
@@ -1,4 +1,4 @@
-!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/console",n(n.s=14)}([function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=n(18),o=n(7);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?o(e):t}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var r=n(19);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){e.exports=n(32)()},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t,n){e.exports=n(29)},function(e,t,n){var r=n(47),o=n(48),i=n(49);e.exports=function(e){return r(e)||o(e)||i()}},function(e,t,n){!function(e){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var n={UNINITIALIZED:"uninitialized",LOADING:"loading",DONE:"done",ALERT:"alert",FAILED:"failed"},r={nodeStatuses:n},o={getEventIcon:function(e){var t={policy_failed:"",policy_success:"",sending_task:"",task_failed:"",task_received:"",task_rescheduled:"",task_retried:"",task_started:"",task_succeeded:"",workflow_cancelled:"",workflow_failed:"",workflow_initializing_node:"",workflow_initializing_policies:"",workflow_received:"",workflow_stage:"",workflow_started:"",workflow_succeeded:""};return t[e]?t[e]:""},getNodeIcon:function(e){var t={"cloudify.nodes.ApplicationModule":"","cloudify.nodes.ApplicationServer":"","cloudify.nodes.Compute":"","cloudify.nodes.Database":"","cloudify.nodes.DBMS":"","cloudify.nodes.FileSystem":"","cloudify.nodes.LoadBalancer":"","cloudify.nodes.MessageBusServer":"","cloudify.nodes.Network":"","cloudify.nodes.ObjectStorage":"","cloudify.nodes.Port":"","cloudify.nodes.Root":"","cloudify.nodes.Router":"","cloudify.nodes.SecurityGroup":"","cloudify.nodes.SoftwareComponent":"","cloudify.nodes.Subnet":"","cloudify.nodes.Tier":"","cloudify.nodes.VirtualIP":"","cloudify.nodes.Volume":"","cloudify.nodes.WebServer":"","cloudify.nodes.Component":"","cloudify.nodes.SharedResource":""},n=(Array.isArray(e)?e:[e||""]).find((function(e){return!!t[e]}));return n?t[n]:t["cloudify.nodes.ApplicationModule"]},getNodeStatusIcon:function(e){var r,o=(t(r={},n.ALERT,""),t(r,n.DONE,""),t(r,n.FAILED,""),t(r,n.LOADING,""),r);return o[e]?o[e]:""}};e.consts=r,e.icons=o,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t){function n(e,t,n,r,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function l(e){n(a,o,i,l,s,"next",e)}function s(e){n(a,o,i,l,s,"throw",e)}l(void 0)}))}}},function(e,t,n){
+!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/console",n(n.s=16)}([function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=n(20),o=n(6);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?o(e):t}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var r=n(21);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){e.exports=n(47)()},function(e,t,n){var r=n(33),o=n(34),i=n(35);e.exports=function(e,t){return r(e)||o(e,t)||i()}},function(e,t,n){var r=n(30),o=n(31),i=n(32);e.exports=function(e){return r(e)||o(e)||i()}},function(e,t,n){e.exports=n(25)},function(e,t){function n(e,t,n,r,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function l(e){n(a,o,i,l,s,"next",e)}function s(e){n(a,o,i,l,s,"throw",e)}l(void 0)}))}}},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t,n){var r;r=function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){e.exports=n(5)()},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=function(e,t,n){var r=e.direction,o=e.value;switch(r){case"top":return n.top+o<t.top&&n.bottom>t.bottom&&n.left<t.left&&n.right>t.right;case"left":return n.left+o<t.left&&n.bottom>t.bottom&&n.top<t.top&&n.right>t.right;case"bottom":return n.bottom-o>t.bottom&&n.left<t.left&&n.right>t.right&&n.top<t.top;case"right":return n.right-o>t.right&&n.left<t.left&&n.top<t.top&&n.bottom>t.bottom}}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(0),s=n.n(l),c=n(3),u=n.n(c);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=f(t).call(this,e),n=!o||"object"!==p(o)&&"function"!=typeof o?h(r):o,g(h(n),"getContainer",(function(){return n.props.containment||window})),g(h(n),"addEventListener",(function(e,t,r,o){var i;n.debounceCheck||(n.debounceCheck={});var a=function(){i=null,n.check()},l={target:e,fn:o>-1?function(){i||(i=setTimeout(a,o||0))}:function(){clearTimeout(i),i=setTimeout(a,r||0)},getLastTimeout:function(){return i}};e.addEventListener(t,l.fn),n.debounceCheck[t]=l})),g(h(n),"startWatching",(function(){n.debounceCheck||n.interval||(n.props.intervalCheck&&(n.interval=setInterval(n.check,n.props.intervalDelay)),n.props.scrollCheck&&n.addEventListener(n.getContainer(),"scroll",n.props.scrollDelay,n.props.scrollThrottle),n.props.resizeCheck&&n.addEventListener(window,"resize",n.props.resizeDelay,n.props.resizeThrottle),!n.props.delayedCall&&n.check())})),g(h(n),"stopWatching",(function(){if(n.debounceCheck)for(var e in n.debounceCheck)if(n.debounceCheck.hasOwnProperty(e)){var t=n.debounceCheck[e];clearTimeout(t.getLastTimeout()),t.target.removeEventListener(e,t.fn),n.debounceCheck[e]=null}n.debounceCheck=null,n.interval&&(n.interval=clearInterval(n.interval))})),g(h(n),"check",(function(){var e,t,r=n.node;if(!r)return n.state;if(e=function(e){return void 0===e.width&&(e.width=e.right-e.left),void 0===e.height&&(e.height=e.bottom-e.top),e}(n.roundRectDown(r.getBoundingClientRect())),n.props.containment){var o=n.props.containment.getBoundingClientRect();t={top:o.top,left:o.left,bottom:o.bottom,right:o.right}}else t={top:0,left:0,bottom:window.innerHeight||document.documentElement.clientHeight,right:window.innerWidth||document.documentElement.clientWidth};var i=n.props.offset||{};"object"===p(i)&&(t.top+=i.top||0,t.left+=i.left||0,t.bottom-=i.bottom||0,t.right-=i.right||0);var a={top:e.top>=t.top,left:e.left>=t.left,bottom:e.bottom<=t.bottom,right:e.right<=t.right},l=e.height>0&&e.width>0,s=l&&a.top&&a.left&&a.bottom&&a.right;if(l&&n.props.partialVisibility){var c=e.top<=t.bottom&&e.bottom>=t.top&&e.left<=t.right&&e.right>=t.left;"string"==typeof n.props.partialVisibility&&(c=a[n.props.partialVisibility]),s=n.props.minTopValue?c&&e.top<=t.bottom-n.props.minTopValue:c}"string"==typeof i.direction&&"number"==typeof i.value&&(console.warn("[notice] offset.direction and offset.value have been deprecated. They still work for now, but will be removed in next major version. Please upgrade to the new syntax: { %s: %d }",i.direction,i.value),s=u()(i,e,t));var d=n.state;return n.state.isVisible!==s&&(d={isVisible:s,visibilityRect:a},n.setState(d),n.props.onChange&&n.props.onChange(s)),d})),n.state={isVisible:null,visibilityRect:{}},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this.node=a.a.findDOMNode(this),this.props.active&&this.startWatching()}},{key:"componentWillUnmount",value:function(){this.stopWatching()}},{key:"componentDidUpdate",value:function(e){this.node=a.a.findDOMNode(this),this.props.active&&!e.active?(this.setState({isVisible:null,visibilityRect:{}}),this.startWatching()):this.props.active||this.stopWatching()}},{key:"roundRectDown",value:function(e){return{top:Math.floor(e.top),left:Math.floor(e.left),bottom:Math.floor(e.bottom),right:Math.floor(e.right)}}},{key:"render",value:function(){return this.props.children instanceof Function?this.props.children({isVisible:this.state.isVisible,visibilityRect:this.state.visibilityRect}):o.a.Children.only(this.props.children)}}])&&d(n.prototype,r),i&&d(n,i),t}(o.a.Component);g(y,"defaultProps",{active:!0,partialVisibility:!1,minTopValue:0,scrollCheck:!1,scrollDelay:250,scrollThrottle:-1,resizeCheck:!1,resizeDelay:250,resizeThrottle:-1,intervalCheck:!0,intervalDelay:100,delayedCall:!1,offset:{},containment:null,children:o.a.createElement("span",null)}),g(y,"propTypes",{onChange:s.a.func,active:s.a.bool,partialVisibility:s.a.oneOfType([s.a.bool,s.a.oneOf(["top","right","bottom","left"])]),delayedCall:s.a.bool,offset:s.a.oneOfType([s.a.shape({top:s.a.number,left:s.a.number,bottom:s.a.number,right:s.a.number}),s.a.shape({direction:s.a.oneOf(["top","right","bottom","left"]),value:s.a.number})]),scrollCheck:s.a.bool,scrollDelay:s.a.number,scrollThrottle:s.a.number,resizeCheck:s.a.bool,resizeDelay:s.a.number,resizeThrottle:s.a.number,intervalCheck:s.a.bool,intervalDelay:s.a.number,containment:"undefined"!=typeof window?s.a.instanceOf(window.Element):s.a.any,children:s.a.oneOfType([s.a.element,s.a.func]),minTopValue:s.a.number})},function(e,t,n){"use strict";var r=n(6);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}])},e.exports=r(n(36),n(37))},function(e,t,n){!function(e){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var n={UNINITIALIZED:"uninitialized",LOADING:"loading",DONE:"done",ALERT:"alert",FAILED:"failed"},r={nodeStatuses:n},o={getEventIcon:function(e){var t={policy_failed:"",policy_success:"",sending_task:"",task_failed:"",task_received:"",task_rescheduled:"",task_retried:"",task_started:"",task_succeeded:"",workflow_cancelled:"",workflow_failed:"",workflow_initializing_node:"",workflow_initializing_policies:"",workflow_received:"",workflow_stage:"",workflow_started:"",workflow_succeeded:""};return t[e]?t[e]:""},getNodeIcon:function(e){var t={"cloudify.nodes.ApplicationModule":"","cloudify.nodes.ApplicationServer":"","cloudify.nodes.Compute":"","cloudify.nodes.Database":"","cloudify.nodes.DBMS":"","cloudify.nodes.FileSystem":"","cloudify.nodes.LoadBalancer":"","cloudify.nodes.MessageBusServer":"","cloudify.nodes.Network":"","cloudify.nodes.ObjectStorage":"","cloudify.nodes.Port":"","cloudify.nodes.Root":"","cloudify.nodes.Router":"","cloudify.nodes.SecurityGroup":"","cloudify.nodes.SoftwareComponent":"","cloudify.nodes.Subnet":"","cloudify.nodes.Tier":"","cloudify.nodes.VirtualIP":"","cloudify.nodes.Volume":"","cloudify.nodes.WebServer":"","cloudify.nodes.Component":"","cloudify.nodes.SharedResource":""},n=(Array.isArray(e)?e:[e||""]).find((function(e){return!!t[e]}));return n?t[n]:t["cloudify.nodes.ApplicationModule"]},getNodeStatusIcon:function(e){var r,o=(t(r={},n.ALERT,""),t(r,n.DONE,""),t(r,n.FAILED,""),t(r,n.LOADING,""),r);return o[e]?o[e]:""}};e.consts=r,e.icons=o,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){
 /*!
 
  diff v3.5.0
@@ -36,4 +36,4 @@ IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISI
 OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 @license
 */
-var r;r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){"use strict";t.__esModule=!0,t.canonicalize=t.convertChangesToXML=t.convertChangesToDMP=t.merge=t.parsePatch=t.applyPatches=t.applyPatch=t.createPatch=t.createTwoFilesPatch=t.structuredPatch=t.diffArrays=t.diffJson=t.diffCss=t.diffSentences=t.diffTrimmedLines=t.diffLines=t.diffWordsWithSpace=t.diffWords=t.diffChars=t.Diff=void 0;var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=n(2),l=n(3),s=n(5),c=n(6),u=n(7),p=n(8),d=n(9),f=n(10),h=n(11),m=n(13),g=n(14),y=n(16),v=n(17);t.Diff=i.default,t.diffChars=a.diffChars,t.diffWords=l.diffWords,t.diffWordsWithSpace=l.diffWordsWithSpace,t.diffLines=s.diffLines,t.diffTrimmedLines=s.diffTrimmedLines,t.diffSentences=c.diffSentences,t.diffCss=u.diffCss,t.diffJson=p.diffJson,t.diffArrays=d.diffArrays,t.structuredPatch=g.structuredPatch,t.createTwoFilesPatch=g.createTwoFilesPatch,t.createPatch=g.createPatch,t.applyPatch=f.applyPatch,t.applyPatches=f.applyPatches,t.parsePatch=h.parsePatch,t.merge=m.merge,t.convertChangesToDMP=y.convertChangesToDMP,t.convertChangesToXML=v.convertChangesToXML,t.canonicalize=p.canonicalize},function(e,t){"use strict";function n(){}function r(e,t,n,r,o){for(var i=0,a=t.length,l=0,s=0;i<a;i++){var c=t[i];if(c.removed){if(c.value=e.join(r.slice(s,s+c.count)),s+=c.count,i&&t[i-1].added){var u=t[i-1];t[i-1]=t[i],t[i]=u}}else{if(!c.added&&o){var p=n.slice(l,l+c.count);p=p.map((function(e,t){var n=r[s+t];return n.length>e.length?n:e})),c.value=e.join(p)}else c.value=e.join(n.slice(l,l+c.count));l+=c.count,c.added||(s+=c.count)}}var d=t[a-1];return a>1&&"string"==typeof d.value&&(d.added||d.removed)&&e.equals("",d.value)&&(t[a-2].value+=d.value,t.pop()),t}function o(e){return{newPos:e.newPos,components:e.components.slice(0)}}t.__esModule=!0,t.default=n,n.prototype={diff:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.callback;"function"==typeof n&&(i=n,n={}),this.options=n;var a=this;function l(e){return i?(setTimeout((function(){i(void 0,e)}),0),!0):e}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e));var s=(t=this.removeEmpty(this.tokenize(t))).length,c=e.length,u=1,p=s+c,d=[{newPos:-1,components:[]}],f=this.extractCommon(d[0],t,e,0);if(d[0].newPos+1>=s&&f+1>=c)return l([{value:this.join(t),count:t.length}]);function h(){for(var n=-1*u;n<=u;n+=2){var i=void 0,p=d[n-1],f=d[n+1],h=(f?f.newPos:0)-n;p&&(d[n-1]=void 0);var m=p&&p.newPos+1<s,g=f&&0<=h&&h<c;if(m||g){if(!m||g&&p.newPos<f.newPos?(i=o(f),a.pushComponent(i.components,void 0,!0)):((i=p).newPos++,a.pushComponent(i.components,!0,void 0)),h=a.extractCommon(i,t,e,n),i.newPos+1>=s&&h+1>=c)return l(r(a,i.components,t,e,a.useLongestToken));d[n]=i}else d[n]=void 0}u++}if(i)!function e(){setTimeout((function(){if(u>p)return i();h()||e()}),0)}();else for(;u<=p;){var m=h();if(m)return m}},pushComponent:function(e,t,n){var r=e[e.length-1];r&&r.added===t&&r.removed===n?e[e.length-1]={count:r.count+1,added:t,removed:n}:e.push({count:1,added:t,removed:n})},extractCommon:function(e,t,n,r){for(var o=t.length,i=n.length,a=e.newPos,l=a-r,s=0;a+1<o&&l+1<i&&this.equals(t[a+1],n[l+1]);)a++,l++,s++;return s&&e.components.push({count:s}),e.newPos=a,l},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}}},function(e,t,n){"use strict";t.__esModule=!0,t.characterDiff=void 0,t.diffChars=function(e,t,n){return a.diff(e,t,n)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=t.characterDiff=new i.default},function(e,t,n){"use strict";t.__esModule=!0,t.wordDiff=void 0,t.diffWords=function(e,t,n){return n=(0,a.generateOptions)(n,{ignoreWhitespace:!0}),c.diff(e,t,n)},t.diffWordsWithSpace=function(e,t,n){return c.diff(e,t,n)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=n(4),l=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,s=/\S/,c=t.wordDiff=new i.default;c.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!s.test(e)&&!s.test(t)},c.tokenize=function(e){for(var t=e.split(/(\s+|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&l.test(t[n])&&l.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t}},function(e,t){"use strict";t.__esModule=!0,t.generateOptions=function(e,t){if("function"==typeof e)t.callback=e;else if(e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}},function(e,t,n){"use strict";t.__esModule=!0,t.lineDiff=void 0,t.diffLines=function(e,t,n){return l.diff(e,t,n)},t.diffTrimmedLines=function(e,t,n){var r=(0,a.generateOptions)(n,{ignoreWhitespace:!0});return l.diff(e,t,r)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=n(4),l=t.lineDiff=new i.default;l.tokenize=function(e){var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var o=n[r];r%2&&!this.options.newlineIsToken?t[t.length-1]+=o:(this.options.ignoreWhitespace&&(o=o.trim()),t.push(o))}return t}},function(e,t,n){"use strict";t.__esModule=!0,t.sentenceDiff=void 0,t.diffSentences=function(e,t,n){return a.diff(e,t,n)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=t.sentenceDiff=new i.default;a.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)}},function(e,t,n){"use strict";t.__esModule=!0,t.cssDiff=void 0,t.diffCss=function(e,t,n){return a.diff(e,t,n)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=t.cssDiff=new i.default;a.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)}},function(e,t,n){"use strict";t.__esModule=!0,t.jsonDiff=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.diffJson=function(e,t,n){return c.diff(e,t,n)},t.canonicalize=u;var o,i=n(1),a=(o=i)&&o.__esModule?o:{default:o},l=n(5),s=Object.prototype.toString,c=t.jsonDiff=new a.default;function u(e,t,n,o,i){t=t||[],n=n||[],o&&(e=o(i,e));var a=void 0;for(a=0;a<t.length;a+=1)if(t[a]===e)return n[a];var l=void 0;if("[object Array]"===s.call(e)){for(t.push(e),l=new Array(e.length),n.push(l),a=0;a<e.length;a+=1)l[a]=u(e[a],t,n,o,i);return t.pop(),n.pop(),l}if(e&&e.toJSON&&(e=e.toJSON()),"object"===(void 0===e?"undefined":r(e))&&null!==e){t.push(e),l={},n.push(l);var c=[],p=void 0;for(p in e)e.hasOwnProperty(p)&&c.push(p);for(c.sort(),a=0;a<c.length;a+=1)l[p=c[a]]=u(e[p],t,n,o,p);t.pop(),n.pop()}else l=e;return l}c.useLongestToken=!0,c.tokenize=l.lineDiff.tokenize,c.castInput=function(e){var t=this.options,n=t.undefinedReplacement,r=t.stringifyReplacer,o=void 0===r?function(e,t){return void 0===t?n:t}:r;return"string"==typeof e?e:JSON.stringify(u(e,null,null,o),o,"  ")},c.equals=function(e,t){return a.default.prototype.equals.call(c,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))}},function(e,t,n){"use strict";t.__esModule=!0,t.arrayDiff=void 0,t.diffArrays=function(e,t,n){return a.diff(e,t,n)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=t.arrayDiff=new i.default;a.tokenize=function(e){return e.slice()},a.join=a.removeEmpty=function(e){return e}},function(e,t,n){"use strict";t.__esModule=!0,t.applyPatch=l,t.applyPatches=function(e,t){"string"==typeof e&&(e=(0,o.parsePatch)(e));var n=0;!function r(){var o=e[n++];if(!o)return t.complete();t.loadFile(o,(function(e,n){if(e)return t.complete(e);var i=l(n,o,t);t.patched(o,i,(function(e){if(e)return t.complete(e);r()}))}))}()};var r,o=n(11),i=n(12),a=(r=i)&&r.__esModule?r:{default:r};function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof t&&(t=(0,o.parsePatch)(t)),Array.isArray(t)){if(t.length>1)throw new Error("applyPatch only works with a single input.");t=t[0]}var r=e.split(/\r\n|[\n\v\f\r\x85]/),i=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],l=t.hunks,s=n.compareLine||function(e,t,n,r){return t===r},c=0,u=n.fuzzFactor||0,p=0,d=0,f=void 0,h=void 0;function m(e,t){for(var n=0;n<e.lines.length;n++){var o=e.lines[n],i=o.length>0?o[0]:" ",a=o.length>0?o.substr(1):o;if(" "===i||"-"===i){if(!s(t+1,r[t],i,a)&&++c>u)return!1;t++}}return!0}for(var g=0;g<l.length;g++){for(var y=l[g],v=r.length-y.oldLines,b=0,E=d+y.oldStart-1,R=(0,a.default)(E,p,v);void 0!==b;b=R())if(m(y,E+b)){y.offset=d+=b;break}if(void 0===b)return!1;p=y.offset+y.oldStart+y.oldLines}for(var w=0,_=0;_<l.length;_++){var C=l[_],S=C.oldStart+C.offset+w-1;w+=C.newLines-C.oldLines,S<0&&(S=0);for(var k=0;k<C.lines.length;k++){var P=C.lines[k],F=P.length>0?P[0]:" ",x=P.length>0?P.substr(1):P,O=C.linedelimiters[k];if(" "===F)S++;else if("-"===F)r.splice(S,1),i.splice(S,1);else if("+"===F)r.splice(S,0,x),i.splice(S,0,O),S++;else if("\\"===F){var T=C.lines[k-1]?C.lines[k-1][0]:null;"+"===T?f=!0:"-"===T&&(h=!0)}}}if(f)for(;!r[r.length-1];)r.pop(),i.pop();else h&&(r.push(""),i.push("\n"));for(var U=0;U<r.length-1;U++)r[U]=r[U]+i[U];return r.join("")}},function(e,t){"use strict";t.__esModule=!0,t.parsePatch=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.split(/\r\n|[\n\v\f\r\x85]/),r=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=[],i=0;function a(){var e={};for(o.push(e);i<n.length;){var r=n[i];if(/^(\-\-\-|\+\+\+|@@)\s/.test(r))break;var a=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(r);a&&(e.index=a[1]),i++}for(l(e),l(e),e.hunks=[];i<n.length;){var c=n[i];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(c))break;if(/^@@/.test(c))e.hunks.push(s());else{if(c&&t.strict)throw new Error("Unknown line "+(i+1)+" "+JSON.stringify(c));i++}}}function l(e){var t=/^(---|\+\+\+)\s+(.*)$/.exec(n[i]);if(t){var r="---"===t[1]?"old":"new",o=t[2].split("\t",2),a=o[0].replace(/\\\\/g,"\\");/^".*"$/.test(a)&&(a=a.substr(1,a.length-2)),e[r+"FileName"]=a,e[r+"Header"]=(o[1]||"").trim(),i++}}function s(){for(var e=i,o=n[i++].split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),a={oldStart:+o[1],oldLines:+o[2]||1,newStart:+o[3],newLines:+o[4]||1,lines:[],linedelimiters:[]},l=0,s=0;i<n.length&&!(0===n[i].indexOf("--- ")&&i+2<n.length&&0===n[i+1].indexOf("+++ ")&&0===n[i+2].indexOf("@@"));i++){var c=0==n[i].length&&i!=n.length-1?" ":n[i][0];if("+"!==c&&"-"!==c&&" "!==c&&"\\"!==c)break;a.lines.push(n[i]),a.linedelimiters.push(r[i]||"\n"),"+"===c?l++:"-"===c?s++:" "===c&&(l++,s++)}if(l||1!==a.newLines||(a.newLines=0),s||1!==a.oldLines||(a.oldLines=0),t.strict){if(l!==a.newLines)throw new Error("Added line count did not match for hunk at line "+(e+1));if(s!==a.oldLines)throw new Error("Removed line count did not match for hunk at line "+(e+1))}return a}for(;i<n.length;)a();return o}},function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t,n){var r=!0,o=!1,i=!1,a=1;return function l(){if(r&&!i){if(o?a++:r=!1,e+a<=n)return a;i=!0}if(!o)return i||(r=!0),t<=e-a?-a++:(o=!0,l())}}},function(e,t,n){"use strict";t.__esModule=!0,t.calcLineCount=l,t.merge=function(e,t,n){e=s(e,n),t=s(t,n);var r={};(e.index||t.index)&&(r.index=e.index||t.index),(e.newFileName||t.newFileName)&&(c(e)?c(t)?(r.oldFileName=u(r,e.oldFileName,t.oldFileName),r.newFileName=u(r,e.newFileName,t.newFileName),r.oldHeader=u(r,e.oldHeader,t.oldHeader),r.newHeader=u(r,e.newHeader,t.newHeader)):(r.oldFileName=e.oldFileName,r.newFileName=e.newFileName,r.oldHeader=e.oldHeader,r.newHeader=e.newHeader):(r.oldFileName=t.oldFileName||e.oldFileName,r.newFileName=t.newFileName||e.newFileName,r.oldHeader=t.oldHeader||e.oldHeader,r.newHeader=t.newHeader||e.newHeader)),r.hunks=[];for(var o=0,i=0,a=0,l=0;o<e.hunks.length||i<t.hunks.length;){var h=e.hunks[o]||{oldStart:1/0},m=t.hunks[i]||{oldStart:1/0};if(p(h,m))r.hunks.push(d(h,a)),o++,l+=h.newLines-h.oldLines;else if(p(m,h))r.hunks.push(d(m,l)),i++,a+=m.newLines-m.oldLines;else{var g={oldStart:Math.min(h.oldStart,m.oldStart),oldLines:0,newStart:Math.min(h.newStart+a,m.oldStart+l),newLines:0,lines:[]};f(g,h.oldStart,h.lines,m.oldStart,m.lines),i++,o++,r.hunks.push(g)}}return r};var r=n(14),o=n(11),i=n(15);function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function l(e){var t=function e(t){var n=0,r=0;return t.forEach((function(t){if("string"!=typeof t){var o=e(t.mine),i=e(t.theirs);void 0!==n&&(o.oldLines===i.oldLines?n+=o.oldLines:n=void 0),void 0!==r&&(o.newLines===i.newLines?r+=o.newLines:r=void 0)}else void 0===r||"+"!==t[0]&&" "!==t[0]||r++,void 0===n||"-"!==t[0]&&" "!==t[0]||n++})),{oldLines:n,newLines:r}}(e.lines),n=t.oldLines,r=t.newLines;void 0!==n?e.oldLines=n:delete e.oldLines,void 0!==r?e.newLines=r:delete e.newLines}function s(e,t){if("string"==typeof e){if(/^@@/m.test(e)||/^Index:/m.test(e))return(0,o.parsePatch)(e)[0];if(!t)throw new Error("Must provide a base reference or pass in a patch");return((0,r.structuredPatch)(void 0,void 0,t,e))}return e}function c(e){return e.newFileName&&e.newFileName!==e.oldFileName}function u(e,t,n){return t===n?t:(e.conflict=!0,{mine:t,theirs:n})}function p(e,t){return e.oldStart<t.oldStart&&e.oldStart+e.oldLines<t.oldStart}function d(e,t){return{oldStart:e.oldStart,oldLines:e.oldLines,newStart:e.newStart+t,newLines:e.newLines,lines:e.lines}}function f(e,t,n,r,o){var i={offset:t,lines:n,index:0},s={offset:r,lines:o,index:0};for(y(e,i,s),y(e,s,i);i.index<i.lines.length&&s.index<s.lines.length;){var c=i.lines[i.index],u=s.lines[s.index];if("-"!==c[0]&&"+"!==c[0]||"-"!==u[0]&&"+"!==u[0])if("+"===c[0]&&" "===u[0]){var p;(p=e.lines).push.apply(p,a(b(i)))}else if("+"===u[0]&&" "===c[0]){var d;(d=e.lines).push.apply(d,a(b(s)))}else"-"===c[0]&&" "===u[0]?m(e,i,s):"-"===u[0]&&" "===c[0]?m(e,s,i,!0):c===u?(e.lines.push(c),i.index++,s.index++):g(e,b(i),b(s));else h(e,i,s)}v(e,i),v(e,s),l(e)}function h(e,t,n){var r=b(t),o=b(n);if(E(r)&&E(o)){var l,s;if((0,i.arrayStartsWith)(r,o)&&R(n,r,r.length-o.length))return void(l=e.lines).push.apply(l,a(r));if((0,i.arrayStartsWith)(o,r)&&R(t,o,o.length-r.length))return void(s=e.lines).push.apply(s,a(o))}else if((0,i.arrayEqual)(r,o)){var c;return void(c=e.lines).push.apply(c,a(r))}g(e,r,o)}function m(e,t,n,r){var o,i=b(t),l=function(e,t){for(var n=[],r=[],o=0,i=!1,a=!1;o<t.length&&e.index<e.lines.length;){var l=e.lines[e.index],s=t[o];if("+"===s[0])break;if(i=i||" "!==l[0],r.push(s),o++,"+"===l[0])for(a=!0;"+"===l[0];)n.push(l),l=e.lines[++e.index];s.substr(1)===l.substr(1)?(n.push(l),e.index++):a=!0}if("+"===(t[o]||"")[0]&&i&&(a=!0),a)return n;for(;o<t.length;)r.push(t[o++]);return{merged:r,changes:n}}(n,i);l.merged?(o=e.lines).push.apply(o,a(l.merged)):g(e,r?l:i,r?i:l)}function g(e,t,n){e.conflict=!0,e.lines.push({conflict:!0,mine:t,theirs:n})}function y(e,t,n){for(;t.offset<n.offset&&t.index<t.lines.length;){var r=t.lines[t.index++];e.lines.push(r),t.offset++}}function v(e,t){for(;t.index<t.lines.length;){var n=t.lines[t.index++];e.lines.push(n)}}function b(e){for(var t=[],n=e.lines[e.index][0];e.index<e.lines.length;){var r=e.lines[e.index];if("-"===n&&"+"===r[0]&&(n="+"),n!==r[0])break;t.push(r),e.index++}return t}function E(e){return e.reduce((function(e,t){return e&&"-"===t[0]}),!0)}function R(e,t,n){for(var r=0;r<n;r++){var o=t[t.length-n+r].substr(1);if(e.lines[e.index+r]!==" "+o)return!1}return e.index+=n,!0}},function(e,t,n){"use strict";t.__esModule=!0,t.structuredPatch=i,t.createTwoFilesPatch=a,t.createPatch=function(e,t,n,r,o,i){return a(e,e,t,n,r,o,i)};var r=n(5);function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t,n,i,a,l,s){s||(s={}),void 0===s.context&&(s.context=4);var c=(0,r.diffLines)(n,i,s);function u(e){return e.map((function(e){return" "+e}))}c.push({value:"",lines:[]});for(var p=[],d=0,f=0,h=[],m=1,g=1,y=function(e){var t=c[e],r=t.lines||t.value.replace(/\n$/,"").split("\n");if(t.lines=r,t.added||t.removed){var a;if(!d){var l=c[e-1];d=m,f=g,l&&(h=s.context>0?u(l.lines.slice(-s.context)):[],d-=h.length,f-=h.length)}(a=h).push.apply(a,o(r.map((function(e){return(t.added?"+":"-")+e})))),t.added?g+=r.length:m+=r.length}else{if(d)if(r.length<=2*s.context&&e<c.length-2){var y;(y=h).push.apply(y,o(u(r)))}else{var v,b=Math.min(r.length,s.context);(v=h).push.apply(v,o(u(r.slice(0,b))));var E={oldStart:d,oldLines:m-d+b,newStart:f,newLines:g-f+b,lines:h};if(e>=c.length-2&&r.length<=s.context){var R=/\n$/.test(n),w=/\n$/.test(i);0!=r.length||R?R&&w||h.push("\\ No newline at end of file"):h.splice(E.oldLines,0,"\\ No newline at end of file")}p.push(E),d=0,f=0,h=[]}m+=r.length,g+=r.length}},v=0;v<c.length;v++)y(v);return{oldFileName:e,newFileName:t,oldHeader:a,newHeader:l,hunks:p}}function a(e,t,n,r,o,a,l){var s=i(e,t,n,r,o,a,l),c=[];e==t&&c.push("Index: "+e),c.push("==================================================================="),c.push("--- "+s.oldFileName+(void 0===s.oldHeader?"":"\t"+s.oldHeader)),c.push("+++ "+s.newFileName+(void 0===s.newHeader?"":"\t"+s.newHeader));for(var u=0;u<s.hunks.length;u++){var p=s.hunks[u];c.push("@@ -"+p.oldStart+","+p.oldLines+" +"+p.newStart+","+p.newLines+" @@"),c.push.apply(c,p.lines)}return c.join("\n")+"\n"}},function(e,t){"use strict";function n(e,t){if(t.length>e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}t.__esModule=!0,t.arrayEqual=function(e,t){return e.length===t.length&&n(e,t)},t.arrayStartsWith=n},function(e,t){"use strict";t.__esModule=!0,t.convertChangesToDMP=function(e){for(var t=[],n=void 0,r=void 0,o=0;o<e.length;o++)n=e[o],r=n.added?1:n.removed?-1:0,t.push([r,n.value]);return t}},function(e,t){"use strict";t.__esModule=!0,t.convertChangesToXML=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.added?t.push("<ins>"):r.removed&&t.push("<del>"),t.push((o=r.value,void 0,o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"))),r.added?t.push("</ins>"):r.removed&&t.push("</del>")}var o;return t.join("")}}])},e.exports=r()},function(e,t,n){n(15),n(16),n(17),n(20),n(21),n(22),n(23),n(24),n(25),n(26),n(27),n(28),n(30),n(31),n(34),n(35),n(36),n(37),n(38),n(39),n(40),n(41),n(42),n(43),n(44),n(45),n(46),n(50),n(51),n(52),n(53),n(54),e.exports=n(55)},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"doGetBlueprints",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.toolbox.getManager().doGet("/blueprints?_include=id",e)}},{key:"doGetFullBlueprintData",value:function(e){return this.toolbox.getManager().doGet("/blueprints/".concat(e.id))}},{key:"doDelete",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.toolbox.getManager().doDelete("/blueprints/".concat(e.id),{force:n}).then((function(){return t.doDeleteImage(e.id)}))}},{key:"doDeploy",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l={blueprint_id:e.id,inputs:n,visibility:r,skip_plugins_validation:o,runtime_only_evaluation:a};return i&&(l.site_name=i),this.toolbox.getManager().doPut("/deployments/".concat(t),null,l)}},{key:"doUpload",value:function(e,t,n,r,o,i,a){var l,s=this,c={visibility:a};if(_.isEmpty(t)||(c.application_file_name=t),_.isEmpty(n)||(c.blueprint_archive_url=n),r){var u=_.endsWith(r.name,".yaml")||_.endsWith(r.name,".yml");l=this.toolbox.getManager().doUpload("/blueprints/".concat(e),c,r,void 0,void 0,u)}else l=this.toolbox.getManager().doPut("/blueprints/".concat(e),c);return l.then((function(){return s.doUploadImage(e,o,i)}))}},{key:"doSetVisibility",value:function(e,t){return this.toolbox.getManager().doPatch("/blueprints/".concat(e,"/set-visibility"),null,{visibility:t})}},{key:"doListYamlFiles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?this.toolbox.getInternal().doUpload("/source/list/yaml",{includeFilename:n},{archive:t}):this.toolbox.getInternal().doPut("/source/list/yaml",{url:e,includeFilename:n})}},{key:"doUploadImage",value:function(e,t,n){if(_.isEmpty(t)&&!n)return Promise.resolve();var r={imageUrl:t};return n?this.toolbox.getInternal().doUpload("/ba/image/".concat(e),r,n,"post"):this.toolbox.getInternal().doPost("/ba/image/".concat(e),r)}},{key:"doDeleteImage",value:function(e){return this.toolbox.getInternal().doDelete("/ba/image/".concat(e))}}]),e}();Stage.defineCommon({name:"BlueprintActions",common:l})},function(e,t){Stage.defineCommon({name:"Consts",common:{defaultVisibility:"tenant",sysAdminRole:"sys_admin",defaultUserRole:"default",adminUsername:"admin",licenseEdition:{premium:"Premium",spire:"Spire"},leaflet:{mapOptions:{minZoom:2,maxZoom:18,maxBounds:[[-90,-180],[90,180]],maxBoundsViscosity:.75},initialZoom:2.5}}})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(7),d=n.n(p),f=n(5),h=n.n(f),m=n(0),g=n.n(m);function y(e){var t=e.name,n=e.description,r=e.version,o=e.derivedFrom,i=e.properties,a=Stage.Basic,l=a.Header,s=a.ParameterValue,c=a.Segment,u=a.Table,p=function(e){var t=e.show,n=e.name,r=e.value;return t&&React.createElement(React.Fragment,null,React.createElement(l,{as:"h4"},_.capitalize(n)),r)},d=Stage.Common.InputsUtils.getTemplateForDataType({properties:i});return React.createElement("div",null,React.createElement(l,{as:"h3",attached:"top"},t),React.createElement(c,{attached:!0},React.createElement(p,{name:"Description",show:!!n,value:n}),React.createElement(p,{name:"Version",show:!!r,value:r}),React.createElement(p,{name:"Derived From",show:!!o,value:o}),React.createElement(p,{name:"Properties",show:!!i,value:React.createElement(u,{celled:!0},React.createElement(u.Header,null,React.createElement(u.Row,null,React.createElement(u.HeaderCell,null,"Name"),React.createElement(u.HeaderCell,null,"Type"),React.createElement(u.HeaderCell,null,"Description"),React.createElement(u.HeaderCell,null,"Default Value"),React.createElement(u.HeaderCell,null,"Required"))),React.createElement(u.Body,null,_.map(i,(function(e,t){return React.createElement(u.Row,{key:t,name:t},React.createElement(u.Cell,null,t),React.createElement(u.Cell,null,e.type),React.createElement(u.Cell,null,e.description),React.createElement(u.Cell,null,React.createElement(s,{value:e.default,showCopyButton:!1})),React.createElement(u.Cell,null,e.required?"Yes":"No"))}))))}),React.createElement(p,{name:"Example",show:!!i,value:React.createElement(s,{value:d})})))}var v=function(e){function t(e){var n;return o()(this,t),(n=s()(this,u()(t).call(this,e))).state={open:!1},n.onOpen=n.onOpen.bind(d()(n)),n.onClose=n.onClose.bind(d()(n)),n}return h()(t,e),a()(t,[{key:"shouldComponentUpdate",value:function(e,t){return!_.isEqual(this.props,e)||!_.isEqual(this.state,t)}},{key:"onOpen",value:function(){this.setState({open:!0})}},{key:"onClose",value:function(){this.setState({open:!1})}},{key:"render",value:function(){var e=Stage.Basic,t=e.Button,n=e.CancelButton,r=e.Modal;return React.createElement("div",null,React.createElement(t,{icon:"code",content:"Show Data Types",onClick:this.onOpen,className:"rightFloated",labelPosition:"left"}),React.createElement(r,{open:this.state.open,onClose:this.onClose},React.createElement(r.Header,null,"Data Types"),React.createElement(r.Content,null,_.map(this.props.types,(function(e,t){return React.createElement(y,{key:t,name:t,description:e.description,derivedFrom:e.derived_from,version:e.version,properties:e.properties})}))),React.createElement(r.Actions,null,React.createElement(n,{onClick:this.onClose,content:"Close"}))))}}]),t}(React.Component);g()(v,"propTypes",{types:PropTypes.objectOf(PropTypes.shape({derived_from:PropTypes.string,version:PropTypes.string,properties:PropTypes.objectOf(PropTypes.shape({description:PropTypes.string,type:PropTypes.string,default:PropTypes.any,required:PropTypes.bool})).isRequired}).isRequired).isRequired}),Stage.defineCommon({name:"DataTypesButton",common:v})},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e,n){return o()(this,t),s()(this,u()(t).call(this,e,n))}return d()(t,e),a()(t,[{key:"render",value:function(){var e=Stage.Basic,t=e.Confirm,n=e.Form,r=e.Segment;return React.createElement(t,{className:this.props.className,header:"Are you sure you want to remove ".concat(this.props.resourceName,"?"),content:React.createElement(r,{basic:!0},React.createElement(n.Field,null,React.createElement(n.Checkbox,{name:"force",toggle:!0,label:"Force",checked:this.props.force,onChange:this.props.onForceChange}))),open:this.props.open,onConfirm:this.props.onConfirm,onCancel:this.props.onCancel})}}]),t}(React.Component);h()(m,"propTypes",{resourceName:PropTypes.string.isRequired,onConfirm:PropTypes.func.isRequired,onCancel:PropTypes.func.isRequired,open:PropTypes.bool.isRequired,className:PropTypes.string,force:PropTypes.bool,onForceChange:PropTypes.func}),h()(m,"defaultProps",{className:"",force:!1,onForceChange:_.noop}),Stage.defineCommon({name:"DeleteConfirm",common:m})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e,n){var r;return o()(this,t),(r=s()(this,u()(t).call(this,e,n))).state=t.initialState,r}return d()(t,e),a()(t,[{key:"componentDidUpdate",value:function(e){var n=this;if(!e.open&&this.props.open){var r=Stage.Common.InputsUtils.getInputsInitialValuesFrom(this.props.blueprint.plan);new Stage.Common.DeploymentActions(this.props.toolbox).doGetSites().then((function(e){n.setState(g({},t.initialState,{deploymentInputs:r,sites:e}))})).catch((function(e){n.setState({loading:!1,error:e.message})}))}}},{key:"onApprove",value:function(){return this.setState({errors:{}},this._submitDeploy),!1}},{key:"onCancel",value:function(){return this.props.onHide(),!0}},{key:"_submitDeploy",value:function(){var e=this,t=Stage.Common.InputsUtils,n={};this.props.blueprint||(n.error="Blueprint not selected"),_.isEmpty(this.state.deploymentName)&&(n.deploymentName="Please provide deployment name");var r={},o=t.getInputsToSend(this.props.blueprint.plan.inputs,this.state.deploymentInputs,r);if(t.addErrors(r,n),!_.isEmpty(n))return this.setState({errors:n}),!1;this.setState({loading:!0}),new Stage.Common.BlueprintActions(this.props.toolbox).doDeploy(this.props.blueprint,this.state.deploymentName,o,this.state.visibility,this.state.skipPluginsValidation,this.state.siteName,this.state.runtimeOnlyEvaluation).then((function(){e.setState({loading:!1,errors:{}}),e.props.toolbox.getEventBus().trigger("deployments:refresh"),e.props.onHide()})).catch((function(n){var r=t.getErrorObject(n.message);e.setState({loading:!1,errors:r})}))}},{key:"_handleYamlFileChange",value:function(e){var t=this;if(e){var n=Stage.Common,r=n.FileActions,o=n.InputsUtils,i=new r(this.props.toolbox);this.setState({fileLoading:!0}),i.doGetYamlFileContent(e).then((function(e){var n=o.getUpdatedInputs(t.props.blueprint.plan.inputs,t.state.deploymentInputs,e);t.setState({errors:{},deploymentInputs:n,fileLoading:!1})})).catch((function(e){var n="Loading values from YAML file failed: ".concat(_.isString(e)?e:e.message);t.setState({errors:{yamlFile:n},fileLoading:!1})}))}}},{key:"_handleInputChange",value:function(e,t){var n=Stage.Basic.Form.fieldNameValue(t);this.setState(n)}},{key:"_handleDeploymentInputChange",value:function(e,t){var n=Stage.Basic.Form.fieldNameValue(t);this.setState({deploymentInputs:g({},this.state.deploymentInputs,{},n)})}},{key:"render",value:function(){var e=this,n=Stage.Basic,r=n.ApproveButton,o=n.CancelButton,i=n.Form,a=n.Icon,l=n.Message,s=n.Modal,c=n.VisibilityField,u=Stage.Common,p=u.DataTypesButton,d=u.InputsHeader,f=u.InputsUtils,h=u.YamlFileButton,m=g({},t.EMPTY_BLUEPRINT,{},this.props.blueprint),y=_.map(this.state.sites.items,(function(e){return{text:e.name,value:e.name}}));return React.createElement(s,{open:this.props.open,onClose:function(){return e.props.onHide()},closeOnEscape:!1,className:"deployBlueprintModal"},React.createElement(s.Header,null,React.createElement(a,{name:"rocket"})," Deploy blueprint ",m.id,React.createElement(c,{visibility:this.state.visibility,className:"rightFloated",onVisibilityChange:function(t){return e.setState({visibility:t})}})),React.createElement(s.Content,null,React.createElement(i,{loading:this.state.loading,errors:this.state.errors,scrollToError:!0,onErrorsDismiss:function(){return e.setState({errors:{}})}},React.createElement(i.Field,{error:this.state.errors.deploymentName,label:"Deployment name",required:!0,help:"Specify a name for this deployment instance."},React.createElement(i.Input,{name:"deploymentName",value:this.state.deploymentName,onChange:this._handleInputChange.bind(this)})),React.createElement(i.Field,{error:this.state.errors.siteName,label:"Site name",help:"(Optional) Specify a site to which this deployment will be assigned."},React.createElement(i.Dropdown,{search:!0,selection:!0,value:this.state.siteName,name:"siteName",options:y,onChange:this._handleInputChange.bind(this)})),m.id&&React.createElement(React.Fragment,null,!_.isEmpty(m.plan.inputs)&&React.createElement(h,{onChange:this._handleYamlFileChange.bind(this),dataType:"deployment's inputs",fileLoading:this.state.fileLoading}),!_.isEmpty(m.plan.data_types)&&React.createElement(p,{types:m.plan.data_types}),React.createElement(d,null),_.isEmpty(m.plan.inputs)&&React.createElement(l,{content:"No inputs available for the blueprint"})),f.getInputFields(m.plan.inputs,this._handleDeploymentInputChange.bind(this),this.state.deploymentInputs,this.state.errors,m.plan.data_types),React.createElement(i.Field,{className:"skipPluginsValidationCheckbox"},React.createElement(i.Checkbox,{toggle:!0,label:"Skip plugins validation",name:"skipPluginsValidation",checked:this.state.skipPluginsValidation,onChange:this._handleInputChange.bind(this)})),this.state.skipPluginsValidation&&React.createElement(l,null,"The recommended path is uploading plugins as wagons to Cloudify. This option is designed for plugin development and advanced users only."),React.createElement(i.Field,{help:"If set, then get_property and get_input intrinsic functions will be evaluated on demand at runtime. If not set, then evaluation will be done at deployment creation time."},React.createElement(i.Checkbox,{toggle:!0,label:"Runtime only evaluation",name:"runtimeOnlyEvaluation",checked:this.state.runtimeOnlyEvaluation,onChange:this._handleInputChange.bind(this)})))),React.createElement(s.Actions,null,React.createElement(o,{onClick:this.onCancel.bind(this),disabled:this.state.loading}),React.createElement(r,{onClick:this.onApprove.bind(this),disabled:this.state.loading,content:"Deploy",icon:"rocket",color:"green"})))}}]),t}(React.Component);h()(y,"EMPTY_BLUEPRINT",{id:"",plan:{inputs:{}}}),h()(y,"initialState",{loading:!1,errors:{},deploymentName:"",yamlFile:null,fileLoading:!1,deploymentInputs:[],visibility:Stage.Common.Consts.defaultVisibility,skipPluginsValidation:!1,siteName:"",sites:{items:[]},runtimeOnlyEvaluation:!1}),h()(y,"propTypes",{toolbox:PropTypes.object.isRequired,open:PropTypes.bool.isRequired,blueprint:PropTypes.object.isRequired,onHide:PropTypes.func}),h()(y,"defaultProps",{onHide:function(){}}),Stage.defineCommon({name:"DeployBlueprintModal",common:y})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"doGet",value:function(e){return this.toolbox.getManager().doGet("/deployments/".concat(e.id))}},{key:"doGetDeployments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.toolbox.getManager().doGet("/deployments?_include=id",e)}},{key:"doDelete",value:function(e){return this.toolbox.getManager().doDelete("/deployments/".concat(e.id))}},{key:"doForceDelete",value:function(e){return this.toolbox.getManager().doDelete("/deployments/".concat(e.id),{ignore_live_nodes:"true"})}},{key:"doCancel",value:function(e,t){return this.toolbox.getManager().doPost("/executions/".concat(e.id),null,{deployment_id:e.deployment_id,action:t})}},{key:"doExecute",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;return this.toolbox.getManager().doPost("/executions",null,{deployment_id:e.id,workflow_id:t.name,dry_run:o,force:r,queue:i,scheduled_time:a,parameters:n})}},{key:"doUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],c=arguments.length>9&&void 0!==arguments[9]&&arguments[9],u=arguments.length>10&&void 0!==arguments[10]&&arguments[10],p={};return _.isEmpty(t)||(p.blueprint_id=t),p.skip_install=!r,p.skip_uninstall=!o,p.install_first=i,p.ignore_failure=a,p.skip_reinstall=!l,p.reinstall_list=s,p.force=c,p.preview=u,_.isEmpty(n)||(p.inputs=n),this.toolbox.getManager().doPut("/deployment-updates/".concat(e,"/update/initiate"),null,p)}},{key:"doSetVisibility",value:function(e,t){return this.toolbox.getManager().doPatch("/deployments/".concat(e,"/set-visibility"),null,{visibility:t})}},{key:"doSetSite",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={detach_site:n};return t&&(r.site_name=t),this.toolbox.getManager().doPost("/deployments/".concat(e,"/set-site"),null,r)}},{key:"doGetSites",value:function(){return this.toolbox.getManager().doGet("/sites?_include=name&_sort=name")}}]),e}();Stage.defineCommon({name:"DeploymentActions",common:l})},function(e,t,n){"use strict";n.r(t);var r,o=n(1),i=n.n(o),a=n(2),l=n.n(a),s=n(0),c=n.n(s),u=function(){function e(){i()(this,e)}return l()(e,null,[{key:"getDeploymentState",value:function(t,n,r){var o=n[t].states,i=n[t].count;return Stage.Utils.Execution.isActiveExecution(r)?e.IN_PROGRESS_STATE:Stage.Utils.Execution.isFailedExecution(r)?e.FAILED_STATE:o.started===i?e.GOOD_STATE:e.PENDING_STATE}}]),e}();c()(u,"GOOD_STATE","good"),c()(u,"IN_PROGRESS_STATE","inProgress"),c()(u,"PENDING_STATE","pending"),c()(u,"FAILED_STATE","failed"),c()(u,"groupStates",(r={},c()(r,u.GOOD_STATE,{name:"good",icon:"checkmark",colorSUI:"green",severity:1,description:"deployments with all nodes successfully started"}),c()(r,u.IN_PROGRESS_STATE,{name:"in progress",icon:"spinner",colorSUI:"yellow",severity:2,description:"deployments in which active workflow execution is performed"}),c()(r,u.PENDING_STATE,{name:"pending",icon:"pause",colorSUI:"blue",severity:3,description:"deployments with non-started nodes"}),c()(r,u.FAILED_STATE,{name:"failed",icon:"close",colorSUI:"red",severity:4,description:"deployments with failed workflow execution"}),r)),Stage.defineCommon({name:"DeploymentStates",common:u})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"doGetUpdate",value:function(e){return this.toolbox.getManager().doGet("/deployment-updates/".concat(e))}},{key:"doGetExecutionParameters",value:function(e){return this.toolbox.getManager().doGet("/executions/".concat(e,"?_include=parameters"))}}]),e}();Stage.defineCommon({name:"DeploymentUpdatesActions",common:l})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(){o()(this,e)}return a()(e,null,[{key:"filterWorkflows",value:function(e){return _.filter(e,(function(e){return!_.isEqual(e.name,"update")}))}}]),e}();Stage.defineCommon({name:"DeploymentUtils",common:l})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(0),s=n.n(l),c=n(11);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=function(){function e(){o()(this,e)}return a()(e,null,[{key:"getEventTypeOptions",value:function(t){return p({},{iconChar:c.icons.getEventIcon(t)},{},e.eventTypeOptions[t])}},{key:"getLogLevelOptions",value:function(t){return p({},{icon:"question",color:"orange"},{},e.logLevelOptions[t])}}]),e}();s()(d,"eventType","cloudify_event"),s()(d,"logType","cloudify_log"),s()(d,"typesOptions",[{text:"",value:""},{text:"Logs",value:d.logType},{text:"Events",value:d.eventType}]),s()(d,"eventTypeOptions",{workflow_received:{text:"Workflow received"},workflow_started:{text:"Workflow started",iconClass:"blue"},workflow_initializing_policies:{text:"Workflow initializing policies"},workflow_initializing_node:{text:"Workflow initializing node"},workflow_succeeded:{text:"Workflow ended successfully",iconClass:"green"},workflow_failed:{text:"Workflow failed",iconClass:"red",rowClass:"row-error"},workflow_cancelled:{text:"Workflow cancelled",iconClass:"red",rowClass:"row-error"},workflow_stage:{text:"Workflow staged"},task_started:{text:"Task started",iconClass:"blue"},sending_task:{text:"Task sent",iconClass:"blue"},task_received:{text:"Task received",iconClass:"blue"},task_succeeded:{text:"Task ended successfully",iconClass:"green"},task_failed:{text:"Task failed",iconClass:"red",rowClass:"row-error"},task_rescheduled:{text:"Task rescheduled",iconClass:"yellow",rowClass:"row-error"},task_retried:{text:"Task retried",iconClass:"yellow",rowClass:"row-error"},policy_success:{text:"Policy end successfully started",iconClass:"green"},policy_failed:{text:"Policy failed",iconClass:"red",rowClass:"row-error"},workflow_node_event:{text:"Workflow node event"},processing_trigger:{text:"Processing trigger"},trigger_failed:{text:"Trigger failed",iconClass:"red"},trigger_succeeded:{text:"Trigger succeeded",iconClass:"green"},workflow_event:{text:"Workflow event"}}),s()(d,"logLevelOptions",{debug:{icon:"bug",color:"green",rowClass:"row-debug",text:"Debug"},info:{icon:"info",color:"blue",text:"Info"},warning:{icon:"warning sign",color:"yellow",rowClass:"row-warning",text:"Warning"},error:{icon:"remove",color:"red",rowClass:"row-error",text:"Error"},critical:{icon:"warning",color:"red",rowClass:"row-error",text:"Critical"}}),Stage.defineCommon({name:"EventUtils",common:d})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e,n){var r;return o()(this,t),(r=s()(this,u()(t).call(this,e,n))).state=t.initialState,r}return d()(t,e),a()(t,[{key:"componentDidUpdate",value:function(e){if(!e.open&&this.props.open){var n=Stage.Common.InputsUtils,r=_.mapValues(_.get(this.props.workflow,"parameters",{}),(function(e){return n.getInputFieldInitialValue(e.default,e.type)}));this.setState(g({},t.initialState,{params:r}))}}},{key:"onApprove",value:function(){return this.setState({errors:{}},this._submitExecute),!1}},{key:"onCancel",value:function(){return this.props.onHide(),!0}},{key:"_submitExecute",value:function(){var e=this,t=Stage.Common,n=t.InputsUtils,r=t.DeploymentActions,o={};if(!this.props.deployment||!this.props.workflow)return this.setState({errors:{error:"Missing workflow or deployment"}}),!1;var i={},a=n.getInputsToSend(this.props.workflow.parameters,this.state.params,i);if(n.addErrors(i,o),this.state.schedule){var l=moment(this.state.scheduledTime);l.isValid()&&_.isEqual(l.format("YYYY-MM-DD HH:mm"),this.state.scheduledTime)&&!l.isBefore(moment())||(o.scheduledTime="Please provide valid scheduled time (in the future, using format: YYYY-MM-DD HH:mm)")}if(!_.isEmpty(o))return this.setState({errors:o}),!1;this.setState({loading:!0});var s=new r(this.props.toolbox),c=this.props.deployments;_.isEmpty(c)&&(c=[this.props.deployment.id]);var u=_.map(c,(function(t){var n=e.state.schedule?moment(e.state.scheduledTime).format("YYYYMMDDHHmmZ"):void 0;return s.doExecute({id:t},e.props.workflow,a,e.state.force,e.state.dryRun,e.state.queue,n).then((function(){e.setState({loading:!1,errors:{}}),e.props.onHide(),e.props.toolbox.getEventBus().trigger("executions:refresh"),e.props.toolbox.getEventBus().trigger("deployments:refresh")}))}));return Promise.all(u).catch((function(t){e.setState({loading:!1,errors:{error:t.message}})}))}},{key:"handleYamlFileChange",value:function(e){var t=this;if(e){var n=Stage.Common,r=n.FileActions,o=n.InputsUtils,i=new r(this.props.toolbox);this.setState({fileLoading:!0}),i.doGetYamlFileContent(e).then((function(e){var n=o.getUpdatedInputs(t.props.workflow.parameters,t.state.params,e);t.setState({errors:{},params:n,fileLoading:!1})})).catch((function(e){var n="Loading values from YAML file failed: ".concat(_.isString(e)?e:e.message);t.setState({errors:{yamlFile:n},fileLoading:!1})}))}}},{key:"handleInputChange",value:function(e,t){this.setState({params:g({},this.state.params,{},Stage.Basic.Form.fieldNameValue(t))})}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.ApproveButton,r=t.CancelButton,o=t.Divider,i=t.Form,a=t.Header,l=t.Icon,s=t.Modal,c=t.Message,u=t.TimePicker,p=Stage.Common,d=p.InputsHeader,f=p.InputsUtils,h=p.YamlFileButton,m=g({name:"",parameters:[]},this.props.workflow),y=g({id:""},this.props.deployment),v=_.isEmpty(this.props.deployments)?y.id:_.size(this.props.deployments)>1?"multiple deployments":this.props.deployments[0];return React.createElement(s,{open:this.props.open,onClose:function(){return e.props.onHide()},closeOnEscape:!1,className:"executeWorkflowModal"},React.createElement(s.Header,null,React.createElement(l,{name:"road"})," Execute workflow ",m.name," on ",v),React.createElement(s.Content,null,React.createElement(i,{loading:this.state.loading,errors:this.state.errors,scrollToError:!0,onErrorsDismiss:function(){return e.setState({errors:{}})}},!_.isEmpty(m.parameters)&&React.createElement(h,{onChange:this.handleYamlFileChange.bind(this),dataType:"execution parameters",fileLoading:this.state.fileLoading}),React.createElement(d,{header:"Parameters",compact:!0}),_.isEmpty(m.parameters)&&React.createElement(c,{content:"No parameters available for the execution"}),f.getInputFields(m.parameters,this.handleInputChange.bind(this),this.state.params,this.state.errors),React.createElement(i.Divider,null,React.createElement(a,{size:"tiny"},"Actions")),React.createElement(i.Field,null,React.createElement(i.Checkbox,{name:"force",toggle:!0,label:"Force",help:'Execute the workflow even if there is an ongoing execution for the given deployment. You cannot use this option with "Queue".',checked:this.state.force,onChange:function(t,n){return e.setState({force:n.checked,queue:!1,errors:{}})}})),React.createElement(i.Field,null,React.createElement(i.Checkbox,{name:"dryRun",toggle:!0,label:"Dry run",help:'If set, no actual operations will be performed. Executed tasks will be logged without side effects. You cannot use this option with "Queue".',checked:this.state.dryRun,onChange:function(t,n){return e.setState({dryRun:n.checked,queue:!1,errors:{}})}})),React.createElement(i.Field,null,React.createElement(i.Checkbox,{name:"queue",toggle:!0,label:"Queue",help:'If set, executions that can`t currently run will be queued and run automatically when possible. You cannot use this option with "Force" and "Dry run".',checked:this.state.queue,onChange:function(t,n){return e.setState({queue:n.checked,force:!1,dryRun:!1,schedule:!1,scheduledTime:"",errors:{}})}})),React.createElement(i.Field,{error:!!this.state.errors.scheduledTime},React.createElement(i.Checkbox,{name:"schedule",toggle:!0,label:"Schedule",help:'If set, workflow will be executed at specific time (local timezone) provided below. You cannot use this option with "Queue".',checked:this.state.schedule,onChange:function(t,n){return e.setState({schedule:n.checked,queue:!1,errors:{}})}}),this.state.schedule&&React.createElement(o,{hidden:!0}),this.state.schedule&&React.createElement(u,{name:"scheduledTime",value:this.state.scheduledTime,defaultValue:"",minDate:moment(),maxDate:moment().add(1,"Y"),onChange:function(t,n){return e.setState({scheduledTime:n.value,queue:!1,errors:{}})}})))),React.createElement(s.Actions,null,React.createElement(r,{onClick:this.onCancel.bind(this),disabled:this.state.loading}),React.createElement(n,{onClick:this.onApprove.bind(this),disabled:this.state.loading,content:"Execute",icon:"rocket",color:"green"})))}}]),t}(React.Component);h()(y,"initialState",{errors:{},loading:!1,dryRun:!1,fileLoading:!1,force:!1,queue:!1,schedule:!1,scheduledTime:"",params:{}}),h()(y,"propTypes",{toolbox:PropTypes.object.isRequired,open:PropTypes.bool.isRequired,deployment:PropTypes.object.isRequired,deployments:PropTypes.array,workflow:PropTypes.object.isRequired,onHide:PropTypes.func.isRequired}),h()(y,"defaultProps",{deployments:[]}),Stage.defineCommon({name:"ExecuteDeploymentModal",common:y})},function(e,t,n){"use strict";n.r(t);var r=n(9),o=n.n(r),i=n(12),a=n.n(i),l=n(1),s=n.n(l),c=n(2),u=n.n(c),p=function(){function e(t){s()(this,e),this.toolbox=t}var t;return u()(e,[{key:"doGetExecutions",value:function(e){return this.toolbox.getManager().doGet("/executions?_include=id,status,ended_at",{deployment_id:e})}},{key:"doGetStatus",value:function(e){return this.toolbox.getManager().doGet("/executions?_include=id,status",{id:e})}},{key:"doAct",value:function(e,t){return this.toolbox.getManager().doPost("/executions/".concat(e.id),null,{deployment_id:e.deployment_id,action:t})}},{key:"waitUntilFinished",value:(t=a()(o.a.mark((function e(t,n){var r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doGetStatus(t);case 2:if(r=e.sent,i=_.filter(r.items,Stage.Utils.Execution.isActiveExecution),_.isEmpty(i)){e.next=10;break}return e.next=7,new Promise((function(e){return setTimeout(e,n)}));case 7:return e.next=9,this.waitUntilFinished(t,n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}();Stage.defineCommon({name:"ExecutionActions",common:p})},function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,i=Object.create(o.prototype),a=new P(r||[]);return i._invoke=function(e,t,n){var r=u;return function(o,i){if(r===d)throw new Error("Generator is already running");if(r===f){if("throw"===o)throw i;return x()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var l=C(a,n);if(l){if(l===h)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===u)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var s=c(e,t,n);if("normal"===s.type){if(r=n.done?f:p,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=f,n.method="throw",n.arg=s.arg)}}}(e,n,a),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var u="suspendedStart",p="suspendedYield",d="executing",f="completed",h={};function m(){}function g(){}function y(){}var v={};v[i]=function(){return this};var b=Object.getPrototypeOf,E=b&&b(b(F([])));E&&E!==n&&r.call(E,i)&&(v=E);var R=y.prototype=m.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function _(e){var t;this._invoke=function(n,o){function i(){return new Promise((function(t,i){!function t(n,o,i,a){var l=c(e[n],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==typeof u&&r.call(u,"__await")?Promise.resolve(u.__await).then((function(e){t("next",e,i,a)}),(function(e){t("throw",e,i,a)})):Promise.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return t("throw",e,i,a)}))}a(l.arg)}(n,o,t,i)}))}return t=t?t.then(i,i):i()}}function C(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method))return h;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var o=c(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,h;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function F(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:x}}function x(){return{value:t,done:!0}}return g.prototype=R.constructor=y,y.constructor=g,y[l]=g.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(R),e},e.awrap=function(e){return{__await:e}},w(_.prototype),_.prototype[a]=function(){return this},e.AsyncIterator=_,e.async=function(t,n,r,o){var i=new _(s(t,n,r,o));return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(R),R[l]="Generator",R[i]=function(){return this},R.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=F,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return l.type="throw",l.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:F(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),h}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"doGetTextFileContent",value:function(e){return this.toolbox.getInternal().doUpload("/file/text",null,{file:e},"post",!1)}},{key:"doGetYamlFileContent",value:function(e){return this.toolbox.getInternal().doUpload("/file/yaml",null,{file:e},"post")}}]),e}();Stage.defineCommon({name:"FileActions",common:l})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=n(6),g=n.n(m),y=function(e){function t(){return o()(this,t),s()(this,u()(t).apply(this,arguments))}return d()(t,e),a()(t,[{key:"render",value:function(){var e=Stage.Basic,t=e.Segment,n=e.Icon,r=e.Popup,o=0===this.props.value,i=this.props.state,a=o?"grey":i.colorSUI;return React.createElement(r,{header:_.capitalize(i.name),content:this.props.description,trigger:React.createElement(t.Group,{className:this.props.className,disabled:o,onClick:this.props.onClick},React.createElement(t,{color:a,disabled:o,inverted:!0},React.createElement(n,{name:i.icon})),React.createElement(t,{color:a,disabled:o,tertiary:!0,inverted:!0},this.props.value))})}}]),t}(React.Component);h()(y,"propTypes",{value:g.a.number,onClick:g.a.func,state:g.a.shape({name:g.a.string.isRequired,colorSUI:g.a.string.isRequired,icon:g.a.string.isRequired}).isRequired,className:g.a.string.isRequired,description:g.a.object.isRequired}),h()(y,"defaultProps",{value:0,onClick:function(){}}),Stage.defineCommon({name:"GroupState",common:y})},function(e,t,n){"use strict";var r=n(33);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e,n){return o()(this,t),s()(this,u()(t).call(this,e,n))}return d()(t,e),a()(t,[{key:"shouldComponentUpdate",value:function(e){return!_.isEqual(this.props,e)}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.Form,r=t.Header,o=t.List,i=t.PopupHelp,a=function(){return React.createElement(r,{size:"tiny"},e.props.header,React.createElement(r.Subheader,null,"See values typing details: ",React.createElement(i,{flowing:!0,header:"Value type",content:React.createElement("div",null,"Values are casted to types, e.g.:",React.createElement(o,{bulleted:!0},React.createElement(o.Item,null,React.createElement("strong",null,"[1, 2]")," will be casted to an array"),React.createElement(o.Item,null,React.createElement("strong",null,"524")," will be casted to a number")),"Surround value with ",React.createElement("strong",null,'"')," to explicitly declare it as a string, e.g.:",React.createElement(o,{bulleted:!0},React.createElement(o.Item,null,React.createElement("strong",null,'"{"a":"b"}"')," will be send as string not an object"),React.createElement(o.Item,null,React.createElement("strong",null,'"true"')," will be send as string not a boolean value")),"Use ",React.createElement("strong",null,'""')," for an empty string.")})))};return this.props.dividing?React.createElement(n.Divider,{style:this.props.compact?{marginTop:0}:{}},React.createElement(a,null)):React.createElement(a,null)}}]),t}(React.Component);h()(m,"propTypes",{compact:PropTypes.bool,dividing:PropTypes.bool,header:PropTypes.string}),h()(m,"defaultProps",{compact:!1,dividing:!0,header:"Deployment inputs"}),Stage.defineCommon({name:"InputsHeader",common:m})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(0),s=n.n(l);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var u=function(){function e(){o()(this,e)}return a()(e,null,[{key:"getEnhancedStringValue",value:function(t){var n=Stage.Utils.Json,r=n.getStringValue(t);if(""===r)return e.EMPTY_STRING;var o=n.toType(t),i=n.getTypedValue(r);return o!==n.toType(i)&&(r='"'.concat(r,'"')),r}},{key:"getInputFieldInitialValue",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=Stage.Utils.Json;if(_.isNil(t))switch(n){case"list":return e.DEFAULT_INITIAL_VALUE_FOR_LIST;case"dict":return e.DEFAULT_INITIAL_VALUE_FOR_DICT;case"boolean":case"integer":case"float":case"string":default:return _.isUndefined(r)?e.DEFAULT_INITIAL_VALUE:e.getTemplateForDataType(r,!0)}else switch(n){case"boolean":case"integer":case"float":return t;case"list":case"dict":return o.getStringValue(t);case"string":default:return e.getEnhancedStringValue(t)}}},{key:"getTemplateForDataType",value:function(e,t){var n=e.properties,r=[];_.map(n,(function(e,t){var n='"'.concat(t,'":');_.isUndefined(e.default)?n+=function(e){switch(e){case"boolean":return"true";case"integer":return"0";case"float":return"0.0";case"string":return'"..."';case"dict":return"{}";case"list":return"[]";case"regex":return'"regexp"';default:return'""'}}(e.type):_.isString(e.default)?n+='"'.concat(e.default,'"'):n+=Stage.Utils.Json.getStringValue(e.default);r.push(n)}));var o="{".concat(_.join(r,","),"}");if(!t)try{o=JSON.parse(o)}catch(e){o="{}"}return o}},{key:"getRevertToDefaultIcon",value:function(t,n,r,o){var i=Stage.Basic.RevertToDefaultIcon,a=Stage.Utils.Json,l=a.getStringValue(n),s=_.startsWith(l,e.STRING_VALUE_SURROUND_CHAR)&&_.endsWith(l,e.STRING_VALUE_SURROUND_CHAR)&&_.size(l)>1?l.slice(1,-1):a.getTypedValue(n),c=r,u=e.getInputFieldInitialValue(r,a.toCloudifyType(c));return _.isNil(c)?void 0:React.createElement(i,{value:s,defaultValue:c,onClick:function(){return o(null,{name:t,value:u})}})}},{key:"getHelp",value:function(t,n,r,o,i){var a=Stage.Basic,l=a.Header,s=a.List,c=a.ParameterValue,u=function(e){var t=e.show,n=e.name,r=e.value;return t&&React.createElement(React.Fragment,null,React.createElement(l,{as:"h4"},n),React.createElement("div",null,r))},p=_.isUndefined(o)?_.isUndefined(i)?null:e.getTemplateForDataType(i):o;return React.createElement("div",null,React.createElement(u,{name:"Description",show:!_.isEmpty(t),value:t}),React.createElement(u,{name:"Type",show:!_.isEmpty(n),value:n}),React.createElement(u,{name:"Constraints",show:!_.isEmpty(r),value:React.createElement(s,{bulleted:!0},_.map(r,(function(e){var t=_.first(_.keys(e));return React.createElement(s.Item,{key:t},_.capitalize(_.lowerCase(t)),": ",String(e[t]))})))}),React.createElement(u,{name:_.isUndefined(o)?"Example":"Default Value",show:!_.isUndefined(o)||!_.isUndefined(i),value:React.createElement(c,{value:p})}))}},{key:"getFormInputField",value:function(t,n,r,o,i,a,l,s,c){var u=Stage.Basic.Form,p=e.getHelp(o,l,s,r,c);switch(l){case"boolean":return React.createElement(u.Field,{key:t,help:p,required:_.isNil(r)},e.getInputField(t,n,r,i,a,l,s));case"integer":return React.createElement(u.Field,{key:t,error:a,help:p,required:_.isNil(r),label:t},e.getInputField(t,n,r,i,a,l,s));case"string":default:return React.createElement(u.Field,{key:t,error:a,help:p,required:_.isNil(r),label:t},e.getInputField(t,n,r,i,a,l,s))}}},{key:"getInputField",value:function(t,n,r,o,i,a,l){var s,c,u=Stage.Basic.Form;if(!_.isEmpty(l)){var p=function(e,t){var n=_.findIndex(e,t);return n>=0?e[n][t]:null},d=p(l,"valid_values");if(!_.isNull(d)){var f=_.map(d,(function(e){return{name:e,text:e,value:e}}));return React.createElement("div",{style:{position:"relative"}},React.createElement(u.Dropdown,{name:t,value:n,fluid:!0,selection:!0,error:!!i,options:f,onChange:o}),React.createElement("div",{style:{position:"absolute",top:10,right:30}},e.getRevertToDefaultIcon(t,n,r,o)))}var h=p(l,"in_range"),m=p(l,"greater_than"),g=p(l,"greater_or_equal"),y=p(l,"less_than"),v=p(l,"less_or_equal");s=_.max([h?h[0]:null,m,g]),c=_.min([h?h[1]:null,y,v])}switch(a){case"boolean":var b=!1===n||!0===n,E=b?n:void 0;return React.createElement(React.Fragment,null,React.createElement(u.Checkbox,{name:t,toggle:!0,label:t,checked:E,indeterminate:!b,onChange:o}),"   ",e.getRevertToDefaultIcon(t,n,r,o));case"integer":case"float":return React.createElement(u.Input,{name:t,value:n,fluid:!0,error:!!i,type:"number",step:"integer"===a?1:"any",min:s,max:c,icon:e.getRevertToDefaultIcon(t,n,r,o),onChange:o});case"dict":case"list":return React.createElement("div",{style:{position:"relative"}},React.createElement(u.Json,{name:t,value:n,onChange:o,error:!!i}),React.createElement("div",{style:{position:"absolute",top:10,right:10}},e.getRevertToDefaultIcon(t,n,r,o)));case"string":case"regex":return _.includes(n,"\n")?React.createElement("div",{style:{position:"relative"}},React.createElement(u.TextArea,{name:t,value:n,onChange:o}),React.createElement("div",{style:{position:"absolute",top:10,right:10}},e.getRevertToDefaultIcon(t,n,r,o))):React.createElement(u.Input,{name:t,value:n,fluid:!0,error:!!i,icon:e.getRevertToDefaultIcon(t,n,r,o),onChange:o});default:return React.createElement("div",{style:{position:"relative"}},React.createElement(u.Json,{name:t,value:n,onChange:o,error:!!i}),React.createElement("div",{style:{position:"absolute",top:10,right:10}},e.getRevertToDefaultIcon(t,n,r,o)))}}},{key:"getInputFields",value:function(t,n,r,o,i){var a=_.sortBy(_.map(t,(function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:t},e)})),[function(e){return!_.isNil(e.default)},"name"]);return _.map(a,(function(t){var a=!_.isEmpty(i)&&t.type?i[t.type]:void 0,l=_.isNil(r[t.name])?e.getInputFieldInitialValue(t.default,t.type,a):r[t.name];return e.getFormInputField(t.name,l,t.default,t.description,n,o[t.name],t.type,t.constraints,a)}))}},{key:"getInputsInitialValuesFrom",value:function(t){var n={};return _.forEach(t.inputs,(function(r,o){var i=!_.isEmpty(t.data_types)&&r.type?t.data_types[r.type]:void 0;n[o]=e.getInputFieldInitialValue(r.default,r.type,i)})),n}},{key:"validateInputTypes",value:function(e,t){var n=[],r=!0;if(_.forEach(e,(function(e,o){var i=e.type,a=t[o];if(!_.isUndefined(i)&&!_.isUndefined(a)){var l=Stage.Utils.Json.toCloudifyType(a);"boolean"!==i&&"integer"!==i||i===l||(n.push(o),r=!1)}})),!r)throw new Error("The following fields have invalid types: ".concat(_.join(n,", "),"."))}},{key:"getUpdatedInputs",value:function(t,n,r){var o={};return e.validateInputTypes(t,r),_.forEach(t,(function(t,i){var a=r[i],l=n[i];_.isNil(a)?o[i]=l:o[i]=e.getInputFieldInitialValue(a,t.type)})),o}},{key:"getPlanForUpdate",value:function(e,t){var n=_.cloneDeep(e);return _.forEach(n,(function(e,r){_.isUndefined(t[r])||_.isUndefined(n[r].default)||(n[r].default=t[r])})),n}},{key:"getInputsToSend",value:function(t,n,r){var o=Stage.Utils.Json,i={};return _.forEach(t,(function(t,a){var l=o.getStringValue(n[a]),s=o.getTypedValue(n[a]);_.isEmpty(l)&&_.isNil(t.default)?r[a]=!0:_.startsWith(l,e.STRING_VALUE_SURROUND_CHAR)&&_.endsWith(l,e.STRING_VALUE_SURROUND_CHAR)&&_.size(l)>1&&(s=l.slice(1,-1)),_.isEqual(s,t.default)||(i[a]=s)})),i}},{key:"addErrors",value:function(e,t){_.forEach(_.keys(e),(function(e){return t[e]="Please provide ".concat(e)}))}},{key:"getErrorObject",value:function(e){var t=e.match(/Property type validation failed in '(.[^']+)'/),n=e.match(/Value of input (.[^ ]+) is missing/),r=e.match(/of input (.[^ ]+) violates constraint/),o="error";return t?o=t[1]:n?o=n[1]:r&&(o=r[1]),s()({},o,e)}}]),e}();s()(u,"DEFAULT_INITIAL_VALUE_FOR_LIST","[]"),s()(u,"DEFAULT_INITIAL_VALUE_FOR_DICT","{}"),s()(u,"DEFAULT_INITIAL_VALUE",""),s()(u,"STRING_VALUE_SURROUND_CHAR",'"'),s()(u,"EMPTY_STRING",'""'),Stage.defineCommon({name:"InputsUtils",common:u})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var g=function(e){function t(e,n){var r;return o()(this,t),(r=s()(this,u()(t).call(this,e,n))).state={errorModalOpen:!1,open:!1},r}return d()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.CancelButton,r=t.Button,o=t.CopyToClipboardButton,i=t.ExecutionStatus,a=t.HighlightText,l=t.Icon,s=t.Table,c=t.Modal,u=t.Popup,p=Stage.Utils,d=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({workflow_id:"",status:""},this.props.execution),f=!!d.scheduled_for,g=f?5:4;return _.isEmpty(d.status)?null:React.createElement(React.Fragment,null,React.createElement(u,{wide:"very",on:"hover",hoverable:!0,open:this.state.open,onOpen:function(){return e.setState({open:!0})},onClose:function(){return e.setState({open:!1})},onClick:function(t){t.stopPropagation(),e.setState({open:!1})}},React.createElement(u.Trigger,null,React.createElement("div",{style:{display:"inline-block"}},React.createElement(i,{execution:d,allowShowingPopup:!1,showLabel:this.props.showLabel,showWorkflowId:this.props.showLabel,labelProps:{attached:this.props.labelAttached?"top left":void 0},iconProps:{attached:this.props.showLabel?void 0:"top left",size:"large"}}))),React.createElement(u.Header,null,"Last Execution"),React.createElement(u.Content,null,React.createElement(s,{compact:!0,celled:!0},React.createElement(s.Header,null,React.createElement(s.Row,{textAlign:"center"},React.createElement(s.HeaderCell,null,"Workflow"),React.createElement(s.HeaderCell,null,"Status"),React.createElement(s.HeaderCell,null,"Created"),f&&React.createElement(s.HeaderCell,null,"Scheduled"),React.createElement(s.HeaderCell,null,"Ended"))),React.createElement(s.Body,null,React.createElement(s.Row,{textAlign:"center"},React.createElement(s.Cell,null,d.workflow_id),React.createElement(s.Cell,null,d.status_display||d.status),React.createElement(s.Cell,null,Stage.Utils.Time.formatTimestamp(d.created_at)),f&&React.createElement(s.Cell,null,Stage.Utils.Time.formatTimestamp(d.scheduled_for)),React.createElement(s.Cell,null,Stage.Utils.Time.formatTimestamp(d.ended_at)))),React.createElement(s.Footer,{fullWidth:!0},React.createElement(s.Row,{textAlign:"center"},React.createElement(s.HeaderCell,{colSpan:g},p.Execution.isFailedExecution(d)&&React.createElement(r,{icon:!0,labelPosition:"left",color:"red",onClick:function(){return e.setState({errorModalOpen:!0})}},React.createElement(l,{name:"remove"}),"Show Error"),React.createElement(r,{icon:!0,labelPosition:"left",color:"grey",onClick:this.props.onShowLogs},React.createElement(l,{name:"file text"}),"Show Logs"),p.Execution.isUpdateExecution(d)&&React.createElement(r,{icon:!0,labelPosition:"left",color:"blue",onClick:function(){return e.props.onShowUpdateDetails(_.get(d,"parameters.update_id"))}},React.createElement(l,{name:"magnify"}),"Show Update Details"))),React.createElement(s.Row,{textAlign:"center"},React.createElement(s.HeaderCell,{colSpan:g},(p.Execution.isCancelledExecution(d)||p.Execution.isFailedExecution(d))&&React.createElement(r,{icon:!0,labelPosition:"left",color:"green",onClick:function(){return e.props.onActOnExecution(d,p.Execution.FORCE_RESUME_ACTION)}},React.createElement(l,{name:"play"}),"Resume"),(p.Execution.isActiveExecution(d)||p.Execution.isWaitingExecution(d))&&React.createElement(r,{icon:!0,labelPosition:"left",color:"yellow",onClick:function(){return e.props.onActOnExecution(d,p.Execution.CANCEL_ACTION)}},React.createElement(l,{name:"cancel"}),"Cancel"),(p.Execution.isActiveExecution(d)||p.Execution.isWaitingExecution(d))&&React.createElement(r,{icon:!0,labelPosition:"left",color:"orange",onClick:function(){return e.props.onActOnExecution(d,p.Execution.FORCE_CANCEL_ACTION)}},React.createElement(l,{name:"cancel"}),"Force Cancel"),React.createElement(r,{icon:!0,labelPosition:"left",color:"red",onClick:function(){return e.props.onActOnExecution(d,p.Execution.KILL_CANCEL_ACTION)}},React.createElement(l,{name:"stop"}),"Kill Cancel"))))))),p.Execution.isFailedExecution(d)&&React.createElement(c,{open:this.state.errorModalOpen,onClose:function(){return e.setState({errorModalOpen:!1})}},React.createElement(c.Header,null,"Error message from '",d.workflow_id,"' worfklow execution on '",d.deployment_id,"' deployment"),React.createElement(c.Content,null,React.createElement(a,null,d.error)),React.createElement(c.Actions,null,React.createElement(o,{content:"Copy Error",text:d.error}),React.createElement(n,{onClick:function(t){t.stopPropagation(),e.setState({errorModalOpen:!1})},content:"Close"}))))}}]),t}(React.Component);h()(g,"propTypes",{execution:PropTypes.object,onShowLogs:PropTypes.func,onShowUpdateDetails:PropTypes.func,onActOnExecution:PropTypes.func,showLabel:PropTypes.bool,labelAttached:PropTypes.bool}),h()(g,"defaultProps",{execution:{workflow_id:"",status:""},onShowLogs:_.noop,onShowUpdateDetails:_.noop,onActOnExecution:_.noop,showLabel:!1,labelAttached:!0}),Stage.defineCommon({name:"LastExecutionStatusIcon",common:g})},function(e,t){Stage.defineCommon({name:"createMarkerIcon",common:function(e){return new L.Icon({iconUrl:Stage.Utils.Url.widgetResourceUrl("common","/images/marker-icon-".concat(e,".png"),!1),shadowUrl:Stage.Utils.Url.widgetResourceUrl("common","/images/marker-shadow.png",!1),iconAnchor:[12,41],popupAnchor:[1,-34]})}})},function(e,t){Stage.defineCommon({name:"NodeInstancesConsts",common:{groupStates:[{name:"uninitialized",icon:"cancel",colorSUI:"blue",colorHTML:"#2185d0",states:["uninitialized"]},{name:"in progress",icon:"spinner",colorSUI:"yellow",colorHTML:"#fbbd08",states:["initializing","creating","created","configuring","configured","starting","stopping","stopped","deleting"]},{name:"started",icon:"checkmark",colorSUI:"green",colorHTML:"#21ba45",states:["started"]},{name:"deleted",icon:"trash",colorSUI:"black",colorHTML:"#1b1c1d",states:["deleted"]}]}})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"doDelete",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.toolbox.getManager().doDelete("/plugins/".concat(e.id),null,{force:t})}},{key:"doUpload",value:function(e,t,n,r,o){var i={visibility:e};_.isEmpty(t)||(i.wagonUrl=t),_.isEmpty(n)||(i.yamlUrl=n);var a={};return r&&(a.wagon_file=r),o&&(a.yaml_file=o),this.toolbox.getInternal().doUpload("/plugins/upload",i,_.isEmpty(a)?null:a,"post")}},{key:"doDownload",value:function(e){var t="/plugins/".concat(e.id,"/archive"),n="".concat(e.package_name,"_").concat(e.package_version,".zip");return this.toolbox.getManager().doDownload(t,n)}},{key:"doSetVisibility",value:function(e,t){return this.toolbox.getManager().doPatch("/plugins/".concat(e,"/set-visibility"),null,{visibility:t})}}]),e}();Stage.defineCommon({name:"PluginActions",common:l})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e,n){var r;return o()(this,t),(r=s()(this,u()(t).call(this,e,n))).state=t.initialState,r}return d()(t,e),a()(t,[{key:"onApprove",value:function(){return this._submitRole(),!1}},{key:"onCancel",value:function(){return this.props.onHide(),!0}},{key:"componentDidUpdate",value:function(e){!e.open&&this.props.open&&this.setState(g({},t.initialState,{role:this.props.resource.role}))}},{key:"_submitRole",value:function(){var e=this,t={};if(_.isEmpty(this.state.role)&&(t.role="Please provide a role"),!_.isEmpty(t))return this.setState({errors:t}),!1;this.setState({loading:!0}),this.props.onSetRole(this.props.resource.name,this.state.role).then((function(){e.setState({errors:{},loading:!1}),e.props.toolbox.refresh(),e.props.onHide()})).catch((function(t){e.setState({errors:{error:t.message},loading:!1})}))}},{key:"_handleInputChange",value:function(e,t){this.setState(Stage.Basic.Form.fieldNameValue(t))}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.Modal,r=t.Icon,o=t.Form,i=t.ApproveButton,a=t.CancelButton,l=g({name:""},this.props.resource);return React.createElement(n,{open:this.props.open,onClose:function(){return e.props.onHide()},className:"roleModal"},React.createElement(n.Header,null,React.createElement(r,{name:"male"})," Set role for ",l.name),React.createElement(n.Content,null,React.createElement(o,{loading:this.state.loading,errors:this.state.errors,onErrorsDismiss:function(){return e.setState({errors:{}})}},React.createElement(o.Field,{error:this.state.errors.role},React.createElement(o.Dropdown,{selection:!0,name:"role",placeholder:"Role",options:this.props.roles,value:this.state.role,onChange:this._handleInputChange.bind(this)})))),React.createElement(n.Actions,null,React.createElement(a,{onClick:this.onCancel.bind(this),disabled:this.state.loading}),React.createElement(i,{onClick:this.onApprove.bind(this),disabled:this.state.loading,icon:"male",color:"green"})))}}]),t}(React.Component);h()(y,"initialState",{loading:!1,role:"",errors:{}}),Stage.defineCommon({name:"RoleModal",common:y})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e,n){return o()(this,t),s()(this,u()(t).call(this,e,n))}return d()(t,e),a()(t,[{key:"_handleInputChange",value:function(e,t){this.props.onUpdate(t.name,t.value)}},{key:"render",value:function(){var e=this,t=Stage.Basic.Form,n=_.reverse(_.map(_.filter(this.props.toolbox.getManager()._data.roles,{type:"tenant_role"}),(function(e){return{text:e.name,value:e.name}})));return React.createElement("span",null,_.map(this.props.resources,(function(r,o){return React.createElement(t.Field,{key:o,label:"Choose a role for ".concat(e.props.resourceName," ").concat(o,":")},React.createElement(t.Dropdown,{placeholder:"Choose a role",selection:!0,options:n,name:o,value:r,onChange:e._handleInputChange.bind(e)}))})))}}]),t}(React.Component);h()(m,"propTypes",{onUpdate:PropTypes.func.isRequired,resources:PropTypes.object.isRequired,resourceName:PropTypes.string.isRequired,toolbox:PropTypes.object.isRequired}),Stage.defineCommon({name:"RolesPicker",common:m})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e,n){return o()(this,t),s()(this,u()(t).call(this,e,n))}return d()(t,e),a()(t,[{key:"render",value:function(){var e="";return _.forEach(_.omit(this.props.groupRoles,this.props.directRole),(function(t,n){e+="".concat(n," (").concat(t.join(", "),"), ")})),e=e.slice(0,-2),_.isEmpty(this.props.groupRoles)?this.props.directRole&&React.createElement("span",null,this.props.directRole):_.has(this.props.groupRoles,this.props.directRole)?_.isEmpty(e)?React.createElement("span",null,this.props.directRole," (",this.props.groupRoles[this.props.directRole].join(", "),")"):React.createElement("span",null,this.props.directRole," (",this.props.groupRoles[this.props.directRole].join(", "),"),"," ",e):this.props.directRole?React.createElement("span",null,this.props.directRole,", ",e):React.createElement("span",null,e)}}]),t}(React.Component);h()(m,"propTypes",{groupRoles:PropTypes.object,directRole:PropTypes.string}),Stage.defineCommon({name:"RolesPresenter",common:m})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(){o()(this,e)}return a()(e,null,[{key:"getTenantRoles",value:function(e){return _.filter(e,{type:"tenant_role"})}},{key:"getDefaultRoleName",value:function(e){return _.reverse(this.getTenantRoles(e))[0].name}},{key:"getSystemRole",value:function(e){return e?Stage.Common.Consts.sysAdminRole:Stage.Common.Consts.defaultUserRole}}]),e}();Stage.defineCommon({name:"RolesUtil",common:l})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"doGet",value:function(e){return this.toolbox.getManager().doGet("/secrets/".concat(e))}},{key:"doDelete",value:function(e){return this.toolbox.getManager().doDelete("/secrets/".concat(e))}},{key:"doCreate",value:function(e,t,n,r){return this.toolbox.getManager().doPut("/secrets/".concat(e),null,{value:t,visibility:n,is_hidden_value:r})}},{key:"doUpdate",value:function(e,t){return this.toolbox.getManager().doPatch("/secrets/".concat(e),null,{value:t})}},{key:"doSetIsHiddenValue",value:function(e,t){return this.toolbox.getManager().doPatch("/secrets/".concat(e),null,{is_hidden_value:t})}},{key:"doSetVisibility",value:function(e,t){return this.toolbox.getManager().doPatch("/secrets/".concat(e,"/set-visibility"),null,{visibility:t})}}]),e}();Stage.defineCommon({name:"SecretActions",common:l})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e,n){var r;return o()(this,t),(r=s()(this,u()(t).call(this,e,n))).state=t.initialState(e),r}return d()(t,e),a()(t,[{key:"componentDidUpdate",value:function(e){var n=this;!e.open&&this.props.open&&(this.setState({loading:!0}),new Stage.Common.BlueprintActions(this.props.toolbox).doGetBlueprints().then((function(e){n.setState(g({},t.initialState(n.props),{blueprints:e}))})).catch((function(e){n.setState({loading:!1,error:e.message})})).then((function(){n._selectBlueprint({},{value:n.props.deployment.blueprint_id})})))}},{key:"onUpdate",value:function(){var e=this;return this.setState({errors:{},loading:!0,showPreview:!1},(function(){return e._submitUpdate(!1)})),!1}},{key:"onPreview",value:function(){var e=this;return this.setState({errors:{},loading:!0,showPreview:!1},(function(){return e._submitUpdate(!0)})),!0}},{key:"onCancel",value:function(){return this.props.onHide(),!0}},{key:"_submitUpdate",value:function(e){var t=this,n=Stage.Common.InputsUtils,r={};_.isEmpty(this.state.blueprint.id)&&(r.blueprintName="Please select blueprint");var o={},i=n.getPlanForUpdate(this.state.blueprint.plan.inputs,this.props.deployment.inputs),a=n.getInputsToSend(i,this.state.deploymentInputs,o);if(n.addErrors(o,r),!_.isEmpty(r))return this.setState({errors:r,loading:!1}),!1;new Stage.Common.DeploymentActions(this.props.toolbox).doUpdate(this.props.deployment.id,this.state.blueprint.id,a,this.state.installWorkflow,this.state.uninstallWorkflow,this.state.installWorkflowFirst,this.state.ignoreFailure,this.state.automaticReinstall,this.state.reinstallList,this.state.force,e).then((function(n){e?t.setState({errors:{},loading:!1,showPreview:!0,previewData:n}):(t.setState({errors:{},loading:!1}),t.props.toolbox.refresh(),t.props.onHide(),t.props.toolbox.getEventBus().trigger("nodes:refresh"),t.props.toolbox.getEventBus().trigger("inputs:refresh"),t.props.toolbox.getEventBus().trigger("outputs:refresh"),t.props.toolbox.getEventBus().trigger("executions:refresh"))})).catch((function(e){var r=n.getErrorObject(e.message);t.setState({loading:!1,errors:r})}))}},{key:"_handleInputChange",value:function(e,t){var n=Stage.Basic.Form.fieldNameValue(t);this.setState(n)}},{key:"_handleDeploymentInputChange",value:function(e,t){var n=Stage.Basic.Form.fieldNameValue(t);this.setState({deploymentInputs:g({},this.state.deploymentInputs,{},n)})}},{key:"_handleYamlFileChange",value:function(e){var t=this;if(e){var n=Stage.Common,r=n.FileActions,o=n.InputsUtils,i=new r(this.props.toolbox);this.setState({fileLoading:!0}),i.doGetYamlFileContent(e).then((function(e){var n=o.getUpdatedInputs(t.state.blueprint.plan.inputs,t.state.deploymentInputs,e);t.setState({errors:{},deploymentInputs:n,fileLoading:!1})})).catch((function(e){var n="Loading values from YAML file failed: ".concat(_.isString(e)?e:e.message);t.setState({errors:{yamlFile:n},fileLoading:!1})}))}}},{key:"_selectBlueprint",value:function(e,t){var n=this;_.isEmpty(t.value)?this.setState({blueprint:Stage.Common.DeployBlueprintModal.EMPTY_BLUEPRINT,errors:{}}):(this.setState({loading:!0}),new Stage.Common.BlueprintActions(this.props.toolbox).doGetFullBlueprintData({id:t.value}).then((function(e){var t={},r=n.props.deployment.inputs;_.forEach(e.plan.inputs,(function(n,o){t[o]=Stage.Common.InputsUtils.getInputFieldInitialValue(r[o],n.type,e.plan.data_types)})),n.setState({deploymentInputs:t,blueprint:e,errors:{},loading:!1})})).catch((function(e){n.setState({blueprint:Stage.Common.DeployBlueprintModal.EMPTY_BLUEPRINT,loading:!1,errors:{error:e.message}})})))}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.ApproveButton,r=t.CancelButton,o=t.Form,i=t.Header,a=t.Icon,l=t.Message,s=t.Modal,c=t.NodeInstancesFilter,u=Stage.Common,p=u.DataTypesButton,d=u.InputsHeader,f=u.InputsUtils,h=u.YamlFileButton,m=u.UpdateDetailsModal,y=g({items:[]},this.state.blueprints),v=_.map(y.items,(function(e){return{text:e.id,value:e.id}})),b=this.state.showPreview?{skip_install:!this.state.installWorkflow,skip_uninstall:!this.state.uninstallWorkflow,skip_reinstall:!this.state.automaticReinstall,reinstall_list:this.state.reinstallList}:{};return React.createElement(s,{open:this.props.open,onClose:function(){return e.props.onHide()},closeOnEscape:!1,className:"updateDeploymentModal"},React.createElement(s.Header,null,React.createElement(a,{name:"edit"})," Update deployment ",this.props.deployment.id),React.createElement(s.Content,null,React.createElement(o,{loading:this.state.loading,errors:this.state.errors,scrollToError:!0,onErrorsDismiss:function(){return e.setState({errors:{}})}},React.createElement(o.Field,{error:this.state.errors.blueprintName,label:"Blueprint",required:!0},React.createElement(o.Dropdown,{search:!0,selection:!0,value:this.state.blueprint.id,placeholder:"Select Blueprint",name:"blueprintName",options:v,onChange:this._selectBlueprint.bind(this)})),this.state.blueprint.id&&React.createElement(React.Fragment,null,!_.isEmpty(this.state.blueprint.plan.inputs)&&React.createElement(h,{onChange:this._handleYamlFileChange.bind(this),dataType:"deployment's inputs",fileLoading:this.state.fileLoading}),!_.isEmpty(this.state.blueprint.plan.data_types)&&React.createElement(p,{types:this.state.blueprint.plan.data_types}),React.createElement(d,null),_.isEmpty(this.state.blueprint.plan.inputs)&&React.createElement(l,{content:"No inputs available for the selected blueprint"})),f.getInputFields(this.state.blueprint.plan.inputs,this._handleDeploymentInputChange.bind(this),this.state.deploymentInputs,this.state.errors,this.state.blueprint.plan.data_types),React.createElement(o.Divider,null,React.createElement(i,{size:"tiny"},"Actions")),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Run install workflow",toggle:!0,name:"installWorkflow",help:"Run install lifecycle operations",checked:this.state.installWorkflow,onChange:this._handleInputChange.bind(this)})),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Run uninstall workflow",toggle:!0,name:"uninstallWorkflow",help:"Run uninstall lifecycle operations",checked:this.state.uninstallWorkflow,onChange:this._handleInputChange.bind(this)})),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Run install workflow first",help:"Run install workflow first and then uninstall workflow. Default: first uninstall and then install",toggle:!0,name:"installWorkflowFirst",checked:this.state.installWorkflowFirst,onChange:this._handleInputChange.bind(this)})),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Ignore failures in uninstall workflow",toggle:!0,name:"ignoreFailure",help:"Supply the parameter `ignore_failure` with the value `true` to the uninstall workflow",checked:this.state.ignoreFailure,onChange:this._handleInputChange.bind(this)})),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Run automatic reinstall",name:"automaticReinstall",toggle:!0,help:'Automatically reinstall node instances that their properties has been modified, as part of a deployment update. If not set, then node instances that were explicitly given to "Reinstall node instances list" will still be reinstalled',checked:this.state.automaticReinstall,onChange:this._handleInputChange.bind(this)})),React.createElement(c,{name:"reinstallList",deploymentId:this.props.deployment.id,label:"Reinstall node instances list",value:this.state.reinstallList,placeholder:"Choose node instances to reinstall",upward:!0,onChange:this._handleInputChange.bind(this),help:'Node instances ids to be reinstalled as part of deployment update. They will be reinstalled even if "Run automatic reinstall" is not set'}),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Force update",name:"force",toggle:!0,help:"Force running update in case a previous update on this deployment has failed to finished successfully",checked:this.state.force,onChange:this._handleInputChange.bind(this)}))),React.createElement(m,{open:this.state.showPreview,isPreview:!0,deploymentUpdate:this.state.previewData,executionParameters:b,onClose:function(){return e.setState({showPreview:!1})},onUpdate:this.onUpdate.bind(this),toolbox:this.props.toolbox})),React.createElement(s.Actions,null,React.createElement(r,{onClick:this.onCancel.bind(this),disabled:this.state.loading}),React.createElement(n,{onClick:this.onPreview.bind(this),disabled:this.state.loading,content:"Preview",icon:"zoom",color:"blue"}),React.createElement(n,{onClick:this.onUpdate.bind(this),disabled:this.state.loading,content:"Update",icon:"edit",color:"green"})))}}]),t}(React.Component);h()(y,"initialState",(function(e){return{loading:!1,errors:{},blueprints:[],yamlFile:null,fileLoading:!1,blueprint:Stage.Common.DeployBlueprintModal.EMPTY_BLUEPRINT,deploymentInputs:g({},e.deployment.inputs),installWorkflow:!0,uninstallWorkflow:!0,installWorkflowFirst:!1,ignoreFailure:!1,automaticReinstall:!0,reinstallList:[],showPreview:!1,previewData:{},force:!1}})),h()(y,"propTypes",{toolbox:PropTypes.object.isRequired,open:PropTypes.bool.isRequired,deployment:PropTypes.object.isRequired,onHide:PropTypes.func.isRequired}),Stage.defineCommon({name:"UpdateDeploymentModal",common:y})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return F}));var r=n(10),o=n.n(r),i=n(0),a=n.n(i),l=n(8),s=n.n(l),c=n(1),u=n.n(c),p=n(2),d=n.n(p),f=n(3),h=n.n(f),m=n(4),g=n.n(m),y=n(5),v=n.n(y),b=n(13);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e){var t=Stage.Basic.Header,n=e.oldBlueprint!==e.newBlueprint;return React.createElement(React.Fragment,null,React.createElement(t,null,"Blueprint"),n?React.createElement("span",null,"Changed from ",React.createElement("strong",null,e.oldBlueprint)," into ",React.createElement("strong",null,e.newBlueprint),"."):React.createElement("span",null,"Not changed."))}var C=function(e){function t(e){var n;return u()(this,t),(n=h()(this,g()(t).call(this,e))).state={showOnlyChanged:!1},n}return v()(t,e),d()(t,[{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.Form,r=t.Header,o=t.Icon,i=t.List,a=t.ParameterValue,l=t.ParameterValueDescription,s=t.Popup,c=t.PopupHelp,u=t.Table,p=Stage.Utils.Json,d=Array.sort(_.keys(this.props.newInputs)),f=_.chain(d).filter((function(t){return!_.isEqual(p.getStringValue(e.props.newInputs[t]||""),p.getStringValue(e.props.oldInputs[t]||""))})).uniq().value(),h=!_.isEqual(this.props.oldInputs,this.props.newInputs),m=function(e){var t=e.stringA,n=e.stringB,r=Object(b.diffChars)(String(t),String(n));return React.createElement("div",null,_.map(r,(function(e,t){var n=e.added?{color:"green"}:e.removed?{color:"red",textDecoration:"line-through"}:null;return React.createElement("span",{key:"part_".concat(t),style:n},e.value)})))};return React.createElement(React.Fragment,null,React.createElement(r,null,h&&React.createElement(n.Checkbox,{name:"showOnlyChanged",toggle:!0,label:"Show only changed",help:"Show only inputs which have different values",className:"rightFloated",checked:this.state.showOnlyChanged,onChange:function(){return e.setState({showOnlyChanged:!e.state.showOnlyChanged})}}),"Inputs",h&&React.createElement(r.Subheader,null,"See details: ",React.createElement(c,{content:React.createElement("div",null,React.createElement("div",null,"To show only changed inputs use ",React.createElement("strong",null,"Show only changed")," toggle."),React.createElement("br",null),React.createElement("div",null,"To see difference between old and new inputs hover over ",React.createElement(o,{name:"asterisk",color:"red",size:"tiny",className:"superscripted"})," character on the right side of changed input to open popup with change details."),React.createElement("br",null),React.createElement("div",null,"Inside popup you will see text in:",React.createElement(i,{bulleted:!0},React.createElement(i.Item,null,React.createElement("span",{style:{color:"green"}},"green")," - added characters"),React.createElement(i.Item,null,React.createElement("span",{style:{color:"red"}},"red")," - removed characters"),React.createElement(i.Item,null,React.createElement("span",{style:{color:"black"}},"black")," - unchanged characters"))))}))),h?React.createElement(u,{striped:!0},React.createElement(u.Header,null,React.createElement(u.Row,null,React.createElement(u.HeaderCell,{width:4},"Input"),React.createElement(u.HeaderCell,{width:6},"Old ",React.createElement(l,null)),React.createElement(u.HeaderCell,{width:6},"New ",React.createElement(l,null)))),React.createElement(u.Body,null,_.map(this.state.showOnlyChanged?f:d,(function(t){var n=_.get(e.props.oldInputs,t,""),r=p.getStringValue(n),i=_.get(e.props.newInputs,t,""),l=p.getStringValue(i),c=!_.isEqual(r,l);return React.createElement(u.Row,{key:t},React.createElement(u.Cell,null,t),React.createElement(u.Cell,null,React.createElement(a,{value:n,showCopyButton:!1})),React.createElement(u.Cell,null,React.createElement(a,{value:i,showCopyButton:!1}),c&&React.createElement(s,null,React.createElement(s.Trigger,null,React.createElement(o,{name:"asterisk",color:"red",size:"tiny",className:"superscripted"})),React.createElement(s.Content,null,React.createElement(m,{stringA:r,stringB:l})))))})))):React.createElement("span",null,"No inputs changed."))}}]),t}(React.Component);function S(e){var t=Stage.Basic,n=t.Card,r=t.Icon,o=t.Label,i=t.List;return React.createElement(n,{key:e.name,color:e.color},React.createElement(n.Content,null,React.createElement(n.Header,null,React.createElement(r,{name:e.icon,color:e.color}),_.capitalize(_.lowerCase(e.name)),e.action&&React.createElement(o,{className:"right floated"},e.action,": ",e.workflowSkipped?"No":"Yes")),React.createElement(n.Description,null,_.isEmpty(e.instances)?React.createElement("span",null,"No node instances"):React.createElement(i,{bulleted:!0},_.map(e.instances,(function(e){return React.createElement(i.Item,{key:e},e)}))))))}function k(e){var t=Stage.Basic,n=t.Card,r=t.Header,o=t.PopupHelp,i=!_.isEmpty(_.filter(e.types,(function(e){return _.size(e.instances)>0})));return React.createElement(React.Fragment,null,React.createElement(r,null,"Node Instances",i&&React.createElement(r.Subheader,null,"See details: ",React.createElement(o,{content:React.createElement("div",null,"Four different categories present added, removed, modified, explicitly reinstalled node instances.",React.createElement("br",null),"Bulleted list contain modified node instance ID and node ID in round brackets.",React.createElement("br",null),"In upper right corner of the card you can see if install/uninstall/reinstall workflows are executed.")}))),i?React.createElement(n.Group,{itemsPerRow:2},_.map(e.types,(function(e){return React.createElement(S,s()({key:e.name},e))}))):React.createElement("span",null,"No node instances changed."))}function P(e){var t=Stage.Basic,n=t.Header,r=t.Table,o=!_.isEmpty(e.steps);return React.createElement(React.Fragment,null,React.createElement(n,null,"Steps",o&&React.createElement(n.Subheader,null,"Action steps taken during update.")),o?React.createElement(r,{striped:!0,definition:!0},React.createElement(r.Header,null,React.createElement(r.Row,null,React.createElement(r.HeaderCell,{collapsing:!0}),React.createElement(r.HeaderCell,null,"Action"),React.createElement(r.HeaderCell,null,"Entity Type"),React.createElement(r.HeaderCell,null,"Entity ID"))),React.createElement(r.Body,null,_.map(e.steps,(function(e,t){return React.createElement(r.Row,{key:e.id},React.createElement(r.Cell,null,t+1),React.createElement(r.Cell,null,e.action),React.createElement(r.Cell,null,e.entity_type),React.createElement(r.Cell,null,e.entity_id))})))):React.createElement("span",null,"No action steps."))}var F=function(e){function t(e,n){var r;return u()(this,t),(r=h()(this,g()(t).call(this,e,n))).state=R({},t.initialState),r}return v()(t,e),d()(t,[{key:"shouldComponentUpdate",value:function(e,t){return!_.isEqual(this.props,e)||!_.isEqual(this.state,t)}},{key:"componentDidUpdate",value:function(e){var n=this;if(_.isEmpty(this.props.deploymentUpdateId)||e.open||!this.props.open)e.open&&!this.props.open&&this.setState(R({},t.initialState));else{this.setState({loading:!0});var r=new Stage.Common.DeploymentUpdatesActions(this.props.toolbox);r.doGetUpdate(this.props.deploymentUpdateId).then((function(e){_.isEmpty(n.props.executionParameters)&&!_.isEmpty(e.execution_id)?r.doGetExecutionParameters(e.execution_id).then((function(t){var r=t.parameters;return n.setState({loading:!1,error:null,deploymentUpdate:e,executionParameters:r})})).catch((function(e){return n.setState({loading:!1,error:e.message,deploymentUpdate:t.EMPTY_DEPLOYMENT_UPDATE})})):n.setState({loading:!1,error:null,deploymentUpdate:e})})).catch((function(e){n.setState({loading:!1,error:e.message,deploymentUpdate:t.EMPTY_DEPLOYMENT_UPDATE})}))}}},{key:"getInstances",value:function(e,t){var n=_.get(e,"deployment_update_node_instances.".concat(t,"_and_related.affected"),[]);return _.map(n,(function(e){return e.id}))}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.ApproveButton,r=t.CancelButton,i=t.Form,a=t.Icon,l=t.Modal,s=_.isEmpty(this.props.deploymentUpdateId)?this.props.deploymentUpdate:this.state.deploymentUpdate,c=_.isEmpty(this.props.executionParameters)?this.state.executionParameters:this.props.executionParameters;return React.createElement("div",null,React.createElement(l,{open:this.props.open,onClose:function(){return e.props.onClose()},className:"updateDetailsModal"},React.createElement(l.Header,null,React.createElement(a,{name:"zoom"})," Deployment update details",this.props.isPreview?" preview":s.id?" - ".concat(s.id):""),React.createElement(l.Content,{scrolling:!0},React.createElement(i,{loading:this.state.loading,errors:this.state.errors,onErrorsDismiss:function(){return e.setState({errors:{}})}},React.createElement(w,{oldBlueprint:s.old_blueprint_id,newBlueprint:s.new_blueprint_id}),React.createElement(C,{oldInputs:s.old_inputs,newInputs:s.new_inputs}),React.createElement(k,{types:[{name:"add",icon:"plus",color:"green",action:"Install",workflowSkipped:c.skip_install,instances:this.getInstances(s,"added")},{name:"remove",icon:"minus",color:"red",action:"Uninstall",workflowSkipped:c.skip_uninstall,instances:this.getInstances(s,"removed")},{name:"modify",icon:"edit",color:"teal",action:"Reinstall",workflowSkipped:c.skip_reinstall,instances:_.uniq([].concat(o()(this.getInstances(s,"extended")),o()(this.getInstances(s,"reduced"))))},{name:"explicit_reinstall",icon:"sync",color:"blue",instances:c.reinstall_list}]}),React.createElement(P,{steps:s.steps}))),React.createElement(l.Actions,null,React.createElement(r,{onClick:this.props.onClose,content:"Close"}),this.props.isPreview&&React.createElement(n,{onClick:this.props.onUpdate,content:"Update",icon:"edit",color:"green"}))))}}]),t}(React.Component);a()(F,"EMPTY_DEPLOYMENT_UPDATE",{old_inputs:{},new_inputs:{},old_blueprint_id:"",new_blueprint_id:"",steps:[]}),a()(F,"EMPTY_EXECUTION_PARAMETERS",{skip_install:!1,skip_uninstall:!1,skip_reinstall:!1,reinstall_list:[]}),a()(F,"initialState",{loading:!1,error:null,deploymentUpdate:R({},F.EMPTY_DEPLOYMENT_UPDATE),executionParameters:R({},F.EMPTY_EXECUTION_PARAMETERS)}),a()(F,"propTypes",{toolbox:PropTypes.object.isRequired,open:PropTypes.bool.isRequired,isPreview:PropTypes.bool,deploymentUpdateId:PropTypes.string,deploymentUpdate:PropTypes.object,executionParameters:PropTypes.object,onClose:PropTypes.func,onUpdate:PropTypes.func}),a()(F,"defaultProps",{isPreview:!1,deploymentUpdateId:"",deploymentUpdate:{},executionParameters:{},onClose:_.noop,onUpdate:_.noop}),Stage.defineCommon({name:"UpdateDetailsModal",common:F})},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e){var n;return o()(this,t),(n=s()(this,u()(t).call(this,e))).state=t.initialState,n.blueprintFileRef=React.createRef(),n.imageFileRef=React.createRef(),n.actions=new Stage.Common.BlueprintActions(e.toolbox),n}return d()(t,e),a()(t,[{key:"componentDidMount",value:function(){var e=this;this.blueprintFileRef.current&&this.blueprintFileRef.current.reset(),this.imageFileRef.current&&this.imageFileRef.current.reset(),this.setState(t.initialState),(!_.isEmpty(this.props.blueprintUrl)&&Stage.Utils.Url.isUrl(this.props.blueprintUrl)||!_.isNil(this.props.blueprintFile))&&(this.setState({loading:!0}),this.actions.doListYamlFiles(this.props.blueprintUrl,this.props.blueprintFile,!1).then((function(t){e.setState({yamlFiles:t,loading:!1})})).catch((function(t){e.setState({yamlFiles:[],loading:!1}),e.props.onChange({errors:{error:t}})})))}},{key:"_handleInputChange",value:function(e,n){this.props.onChange(g({},t.NO_ERRORS,{},Stage.Basic.Form.fieldNameValue(n)))}},{key:"_onBlueprintUrlBlur",value:function(){var e=this;!_.isEmpty(this.props.blueprintUrl)&&Stage.Utils.Url.isUrl(this.props.blueprintUrl)?(this.setState({loading:!0},(function(){return e.props.onChange({blueprintFile:null})})),this.blueprintFileRef.current&&this.blueprintFileRef.current.reset(),this.actions.doListYamlFiles(this.props.blueprintUrl,null,!0).then((function(n){e.setState({yamlFiles:n,loading:!1},(function(){var r=n.shift(),o=_.includes(n,t.DEFAULT_BLUEPRINT_YAML_FILE)?t.DEFAULT_BLUEPRINT_YAML_FILE:n[0];e.props.onChange(g({},t.NO_ERRORS,{blueprintName:r,blueprintFileName:o}))}))})).catch((function(t){e.setState({loading:!1},(function(){return e.props.onChange({errors:{error:t.message},blueprintName:"",blueprintFileName:""})}))}))):this.setState({yamlFiles:[]},this.resetErrors)}},{key:"_onBlueprintUrlFocus",value:function(){this.props.blueprintFile&&(this.blueprintFileRef.current&&this.blueprintFileRef.current.reset(),this._onBlueprintFileReset())}},{key:"_onBlueprintFileChange",value:function(e){var n=this;e?(this.setState({loading:!0}),this.actions.doListYamlFiles(null,e,!0).then((function(r){var o=r.shift(),i=_.includes(r,t.DEFAULT_BLUEPRINT_YAML_FILE)?t.DEFAULT_BLUEPRINT_YAML_FILE:r[0];n.setState({yamlFiles:r,loading:!1},(function(){n.props.onChange(g({},t.NO_ERRORS,{blueprintFile:e,blueprintUrl:e.name,blueprintName:o,blueprintFileName:i}))}))})).catch((function(e){n.setState({loading:!1},(function(){return n.props.onChange({errors:{error:e.message},blueprintName:"",blueprintFileName:""})}))}))):this.setState({yamlFiles:[]},this.resetErrors)}},{key:"_onBlueprintFileReset",value:function(){var e=this;this.setState({yamlFiles:[]},(function(){return e.props.onChange(g({},t.NO_ERRORS,{blueprintFile:null,blueprintUrl:"",blueprintName:"",blueprintFileName:""}))}))}},{key:"_onBlueprintImageUrlFocus",value:function(){this.props.imageFile&&(this.imageFileRef.current&&this.imageFileRef.current.reset(),this._onBlueprintImageReset())}},{key:"_onBlueprintImageChange",value:function(e){e&&this.props.onChange(g({},t.NO_ERRORS,{imageUrl:e.name,imageFile:e}))}},{key:"_onBlueprintImageReset",value:function(){this.props.onChange(g({},t.NO_ERRORS,{imageUrl:"",imageFile:null}))}},{key:"resetErrors",value:function(){this.props.onChange(t.NO_ERRORS)}},{key:"render",value:function(){var e=Stage.Basic,t=e.Form,n=e.Label,r=_.map(this.state.yamlFiles,(function(e){return{text:e,value:e}}));return React.createElement(t,{loading:this.state.loading||this.props.loading,errors:this.props.showErrorsSummary?this.props.errors:null,onErrorsDismiss:this.resetErrors.bind(this)},React.createElement(t.Field,{label:"Blueprint package",required:!0,error:this.props.errors.blueprintUrl,help:"You can provide single YAML file or blueprint archive. Supported types are: yml, yaml, zip, tar, tar.gz and tar.bz2. The archive package must contain exactly one directory that includes at least one YAML file."},React.createElement(t.UrlOrFile,{name:"blueprint",value:this.props.blueprintUrl,placeholder:"Provide the blueprint's URL or click browse to select a file",onChangeUrl:this._handleInputChange.bind(this),onFocusUrl:this._onBlueprintUrlFocus.bind(this),onBlurUrl:this._onBlueprintUrlBlur.bind(this),onChangeFile:this._onBlueprintFileChange.bind(this),onResetFile:this._onBlueprintFileReset.bind(this),label:React.createElement(n,null,this.props.blueprintFile?"File":"URL"),fileInputRef:this.blueprintFileRef})),React.createElement(t.Field,{label:"Blueprint name",required:!0,error:this.props.errors.blueprintName,help:"The package is uploaded to the Manager as a blueprint with the name you specify here."},React.createElement(t.Input,{name:"blueprintName",value:this.props.blueprintName,onChange:this._handleInputChange.bind(this)})),React.createElement(t.Field,{label:"Blueprint YAML file",required:!0,error:this.props.errors.blueprintFileName,help:"If you choose archive as blueprint package, you must specify the blueprint YAML file for your environment, because the archive can contain more than one YAML file."},React.createElement(t.Dropdown,{name:"blueprintFileName",search:!0,selection:!0,options:r,value:this.props.blueprintFileName,onChange:this._handleInputChange.bind(this)})),React.createElement(t.Field,{label:"Blueprint icon",error:this.props.errors.imageUrl,help:"(Optional) The blueprint icon file is shown with the blueprint in the local blueprint widget."},React.createElement(t.UrlOrFile,{name:"image",value:this.props.imageUrl,placeholder:"Provide the image file URL or click browse to select a file",onChangeUrl:this._handleInputChange.bind(this),onFocusUrl:this._onBlueprintImageUrlFocus.bind(this),onBlurUrl:_.noop,onChangeFile:this._onBlueprintImageChange.bind(this),onResetFile:this._onBlueprintImageReset.bind(this),label:React.createElement(n,null,this.props.imageFile?"File":"URL"),fileInputRef:this.imageFileRef})))}}]),t}(React.Component);h()(y,"propTypes",{blueprintUrl:PropTypes.string,blueprintFile:PropTypes.object,blueprintName:PropTypes.string,blueprintFileName:PropTypes.string,imageUrl:PropTypes.string,imageFile:PropTypes.object,errors:PropTypes.object,loading:PropTypes.bool,showErrorsSummary:PropTypes.bool,onChange:PropTypes.func.isRequired,toolbox:PropTypes.object.isRequired}),h()(y,"defaultProps",{blueprintUrl:"",blueprintFile:null,blueprintName:"",blueprintFileName:"",imageUrl:"",imageFile:null,errors:{},loading:!1,showErrorsSummary:!0}),h()(y,"initialState",{loading:!1,yamlFiles:[]}),h()(y,"DEFAULT_BLUEPRINT_YAML_FILE","blueprint.yaml"),h()(y,"NO_ERRORS",{errors:{}}),Stage.defineCommon({name:"UploadBlueprintForm",common:y})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e){var n;return o()(this,t),(n=s()(this,u()(t).call(this,e))).state=t.initialState,n.actions=new Stage.Common.BlueprintActions(e.toolbox),n}return d()(t,e),a()(t,[{key:"componentDidUpdate",value:function(e){e.open&&!this.props.open&&this.setState(t.initialState)}},{key:"shouldComponentUpdate",value:function(e,t){return!_.isEqual(this.props.open,e.open)||!_.isEqual(this.state,t)}},{key:"uploadBlueprint",value:function(){var e=this,t=this.state.blueprintFile?"":this.state.blueprintUrl,n=this.state.imageFile?"":this.state.imageUrl,r={};if(this.state.blueprintFile||(_.isEmpty(t)?r.blueprintUrl="Please select blueprint package":Stage.Utils.Url.isUrl(t)||(r.blueprintUrl="Please provide valid URL for blueprint package")),_.isEmpty(this.state.blueprintName)&&(r.blueprintName="Please provide blueprint name"),_.isEmpty(this.state.blueprintFileName)&&(r.blueprintFileName="Please provide blueprint YAML file"),_.isEmpty(n)||Stage.Utils.Url.isUrl(t)||(r.imageUrl="Please provide valid URL for blueprint icon"),!_.isEmpty(r))return this.setState({errors:r}),!1;this.setState({loading:!0}),this.actions.doUpload(this.state.blueprintName,this.state.blueprintFileName,t,this.state.blueprintFile,n,this.state.imageFile,this.state.visibility).then((function(){e.setState({errors:{},loading:!1},e.props.onHide),e.props.toolbox.refresh()})).catch((function(t){e.setState({errors:{error:t.message},loading:!1})}))}},{key:"onFormFieldChange",value:function(e){this.setState(e)}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.ApproveButton,r=t.CancelButton,o=t.Icon,i=t.Modal,a=t.VisibilityField,l=Stage.Common.UploadBlueprintForm;return React.createElement("div",null,React.createElement(i,{open:this.props.open,onClose:this.props.onHide,className:"uploadBlueprintModal"},React.createElement(i.Header,null,React.createElement(o,{name:"upload"})," Upload blueprint",React.createElement(a,{visibility:this.state.visibility,className:"rightFloated",onVisibilityChange:function(t){return e.setState({visibility:t})}})),React.createElement(i.Content,null,React.createElement(l,{blueprintUrl:this.state.blueprintUrl,blueprintFile:this.state.blueprintFile,blueprintName:this.state.blueprintName,blueprintFileName:this.state.blueprintFileName,imageUrl:this.state.imageUrl,imageFile:this.state.imageFile,errors:this.state.errors,loading:this.state.loading,onChange:this.onFormFieldChange.bind(this),toolbox:this.props.toolbox})),React.createElement(i.Actions,null,React.createElement(r,{onClick:this.props.onHide,disabled:this.state.loading}),React.createElement(n,{onClick:this.uploadBlueprint.bind(this),disabled:this.state.loading,content:"Upload",icon:"upload",color:"green"}))))}}]),t}(React.Component);h()(m,"propTypes",{open:PropTypes.bool.isRequired,onHide:PropTypes.func.isRequired,toolbox:PropTypes.object.isRequired}),h()(m,"initialState",{loading:!1,visibility:Stage.Common.Consts.defaultVisibility,blueprintUrl:"",blueprintFile:null,blueprintName:"",blueprintFileName:"",imageUrl:"",imageFile:null,errors:{}}),Stage.defineCommon({name:"UploadBlueprintModal",common:m})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e){var n;return o()(this,t),(n=s()(this,u()(t).call(this,e))).wagonFileRef=React.createRef(),n.yamlFileRef=React.createRef(),n}return d()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.wagonFileRef.current&&this.wagonFileRef.current.reset(),this.yamlFileRef.current&&this.yamlFileRef.current.reset(),this.resetErrors()}},{key:"resetErrors",value:function(){this.props.onChange(t.NO_ERRORS)}},{key:"_handleInputChange",value:function(e,n){this.props.onChange(g({},t.NO_ERRORS,{},Stage.Basic.Form.fieldNameValue(n)))}},{key:"_onWagonUrlFocus",value:function(){this.props.wagonFile&&(this.wagonFileRef.current&&this.wagonFileRef.current.reset(),this._onWagonFileReset())}},{key:"_onWagonFileChange",value:function(e){this.props.onChange(g({},t.NO_ERRORS,{wagonFile:e||null,wagonUrl:e?e.name:""}))}},{key:"_onWagonFileReset",value:function(){this.props.onChange(g({},t.NO_ERRORS,{wagonFile:null,wagonUrl:""}))}},{key:"_onYamlUrlFocus",value:function(){this.props.yamlFile&&(this.yamlFileRef.current&&this.yamlFileRef.current.reset(),this._onYamlFileReset())}},{key:"_onYamlFileChange",value:function(e){this.props.onChange(g({},t.NO_ERRORS,{yamlFile:e||null,yamlUrl:e?e.name:""}))}},{key:"_onYamlFileReset",value:function(){this.props.onChange(g({},t.NO_ERRORS,{yamlFile:null,yamlUrl:""}))}},{key:"render",value:function(){var e=Stage.Basic,t=e.Container,n=e.Form,r=e.Label,o=[React.createElement(n.Field,{label:"Wagon file",required:this.props.addRequiredMarks,key:"wagon",error:this.props.errors.wagonUrl},React.createElement(n.UrlOrFile,{name:"wagon",value:this.props.wagonUrl,placeholder:this.props.wagonPlaceholder,onChangeUrl:this._handleInputChange.bind(this),onFocusUrl:this._onWagonUrlFocus.bind(this),onBlurUrl:_.noop,onChangeFile:this._onWagonFileChange.bind(this),onResetFile:this._onWagonFileReset.bind(this),label:React.createElement(r,null,this.props.wagonFile?"File":"URL"),fileInputRef:this.wagonFileRef})),React.createElement(n.Field,{label:"YAML file",required:this.props.addRequiredMarks,key:"yaml",error:this.props.errors.yamlUrl},React.createElement(n.UrlOrFile,{name:"yaml",value:this.props.yamlUrl,placeholder:this.props.yamlPlaceholder,onChangeUrl:this._handleInputChange.bind(this),onFocusUrl:this._onYamlUrlFocus.bind(this),onBlurUrl:_.noop,onChangeFile:this._onYamlFileChange.bind(this),onResetFile:this._onYamlFileReset.bind(this),label:React.createElement(r,null,this.props.yamlFile?"File":"URL"),fileInputRef:this.yamlFileRef}))];return this.props.wrapInForm?React.createElement(n,{errors:this.props.errors,onErrorsDismiss:this.resetErrors.bind(this),loading:this.props.loading},o):React.createElement(t,{fluid:!0},o)}}]),t}(React.Component);h()(y,"propTypes",{wagonUrl:PropTypes.string,wagonFile:PropTypes.object,wagonPlaceholder:PropTypes.string,yamlUrl:PropTypes.string,yamlFile:PropTypes.object,yamlPlaceholder:PropTypes.string,errors:PropTypes.object,loading:PropTypes.bool,onChange:PropTypes.func.isRequired,wrapInForm:PropTypes.bool,addRequiredMarks:PropTypes.bool}),h()(y,"defaultProps",{wagonUrl:"",wagonFile:null,wagonPlaceholder:"Provide the plugin's wagon file URL or click browse to select a file",yamlUrl:"",yamlFile:null,yamlPlaceholder:"Provide the plugin's YAML file URL or click browse to select a file",errors:{},loading:!1,wrapInForm:!0,addRequiredMarks:!0}),h()(y,"NO_ERRORS",{errors:{}}),Stage.defineCommon({name:"UploadPluginForm",common:y})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var g=function(e){function t(e){var n;return o()(this,t),(n=s()(this,u()(t).call(this,e))).state=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.initialState),n}return d()(t,e),a()(t,[{key:"componentDidUpdate",value:function(e){!e.open&&this.props.open&&this.setState(t.initialState)}},{key:"shouldComponentUpdate",value:function(e,t){return!_.isEqual(this.props.open,e.open)||!_.isEqual(this.state,t)}},{key:"uploadPlugin",value:function(){var e=this,t=this.state.wagonFile?"":this.state.wagonUrl,n=this.state.yamlFile?"":this.state.yamlUrl,r={};if(this.state.wagonFile||(_.isEmpty(t)?r.wagonUrl="Please select wagon file or provide URL to wagon file":Stage.Utils.Url.isUrl(t)||(r.wagonUrl="Please provide valid URL for wagon file")),this.state.yamlFile||(_.isEmpty(n)?r.yamlUrl="Please select YAML file or provide URL to YAML file":Stage.Utils.Url.isUrl(n)||(r.yamlUrl="Please provide valid URL for YAML file")),!_.isEmpty(r))return this.setState({errors:r}),!1;this.setState({loading:!0}),new Stage.Common.PluginActions(this.props.toolbox).doUpload(this.state.visibility,t,n,this.state.wagonFile,this.state.yamlFile).then((function(){e.setState({errors:{},loading:!1},e.props.onHide),e.props.toolbox.refresh()})).catch((function(t){e.setState({errors:{error:t.message},loading:!1})}))}},{key:"onFormFieldChange",value:function(e){this.setState(e)}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.ApproveButton,r=t.CancelButton,o=t.Icon,i=t.Modal,a=t.VisibilityField,l=Stage.Common.UploadPluginForm;return React.createElement(i,{open:this.props.open,onClose:this.props.onHide},React.createElement(i.Header,null,React.createElement(o,{name:"upload"})," Upload plugin",React.createElement(a,{visibility:this.state.visibility,className:"rightFloated",onVisibilityChange:function(t){return e.setState({visibility:t})}})),React.createElement(i.Content,null,React.createElement(l,{wagonUrl:this.state.wagonUrl,wagonFile:this.state.wagonFile,yamlUrl:this.state.yamlUrl,yamlFile:this.state.yamlFile,errors:this.state.errors,loading:this.state.loading,onChange:this.onFormFieldChange.bind(this)})),React.createElement(i.Actions,null,React.createElement(r,{onClick:this.props.onHide,disabled:this.state.loading}),React.createElement(n,{onClick:this.uploadPlugin.bind(this),disabled:this.state.loading,content:"Upload",icon:"upload",color:"green"})))}}]),t}(React.Component);h()(g,"propTypes",{open:PropTypes.bool.isRequired,onHide:PropTypes.func.isRequired,toolbox:PropTypes.object.isRequired}),h()(g,"initialState",{loading:!1,wagonUrl:"",wagonFile:null,yamlUrl:"",yamlFile:null,errors:{},visibility:Stage.Common.Consts.defaultVisibility}),Stage.defineCommon({name:"UploadPluginModal",common:g})},function(e,t,n){"use strict";n.r(t);var r=n(8),o=n.n(r),i=n(1),a=n.n(i),l=n(2),s=n.n(l),c=n(3),u=n.n(c),p=n(4),d=n.n(p),f=n(5),h=n.n(f),m=n(0),g=n.n(m),y=function(e){function t(){return a()(this,t),u()(this,d()(t).apply(this,arguments))}return h()(t,e),s()(t,[{key:"render",value:function(){var e=Stage.Basic.Menu,t=this.props,n=t.onClick,r=t.workflows;return _.map(r,(function(t){return React.createElement(e.Item,{name:t.name,content:_.capitalize(_.lowerCase(t.name)),key:t.name,onClick:function(){return n(t)}})}))}}]),t}(React.Component);g()(y,"propTypes",{workflows:PropTypes.array.isRequired,onClick:PropTypes.func}),g()(y,"defaultProps",{onClick:_.noop});var v=function(e){function t(e){var n;return a()(this,t),(n=u()(this,d()(t).call(this,e))).state={activeGroup:""},n}return h()(t,e),s()(t,[{key:"onGroupClick",value:function(e,t){e.stopPropagation();var n=t.index,r=this.state.activeGroup;this.setState({activeGroup:r===n?"":n})}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.Accordion,r=t.Menu,o=this.props,i=o.workflowsGroups,a=o.onClick,l=this.state.activeGroup;return React.createElement(n,{as:r,vertical:!0,style:{boxShadow:"none"}},_.map(i,(function(t){return React.createElement(r.Item,{key:t.name},React.createElement(n.Title,{active:l===t.name,index:t.name,content:_.capitalize(_.lowerCase(t.name)),onClick:e.onGroupClick.bind(e)}),React.createElement(n.Content,{active:l===t.name},React.createElement(r.Menu,null,React.createElement(y,{workflows:t.workflows,onClick:a}))))})))}}]),t}(React.Component);g()(v,"propTypes",{workflowsGroups:PropTypes.arrayOf(PropTypes.shape({name:PropTypes.string,workflows:PropTypes.array})).isRequired,onClick:PropTypes.func}),g()(v,"defaultProps",{onClick:_.noop});var b=function(e){function t(){return a()(this,t),u()(this,d()(t).apply(this,arguments))}return h()(t,e),s()(t,[{key:"render",value:function(){var e=Stage.Basic,t=e.Menu,n=e.Popup,r=e.PopupMenu,i=this.props.workflows,a=_.chain(i).groupBy("plugin").map((function(e,t){return{name:t,workflows:e}})).sortBy("name").value(),l=1===_.size(a);return this.props.showInPopup?React.createElement(r,o()({className:"workflowAction",position:"bottom center",offset:0},this.props.popupMenuProps),!!this.props.trigger&&React.createElement(n.Trigger,null,this.props.trigger),l?React.createElement(t,{vertical:!0},React.createElement(y,{workflows:i,onClick:this.props.onClick})):React.createElement(v,{workflowsGroups:a,onClick:this.props.onClick})):l?React.createElement(y,{workflows:i,onClick:this.props.onClick}):React.createElement(v,{workflowsGroups:a,onClick:this.props.onClick})}}]),t}(React.Component);g()(b,"propTypes",{workflows:PropTypes.array.isRequired,onClick:PropTypes.func,popupMenuProps:PropTypes.object,showInPopup:PropTypes.bool,trigger:PropTypes.element}),g()(b,"defaultProps",{onClick:_.noop,showInPopup:!0,popupMenuProps:{},trigger:null}),Stage.defineCommon({name:"WorkflowsMenu",common:b})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e,n){return o()(this,t),s()(this,u()(t).call(this,e,n))}return d()(t,e),a()(t,[{key:"render",value:function(){var e=Stage.Basic.Form;return React.createElement(e.File,{name:"yamlFile",showInput:!1,showReset:!1,openButtonParams:{className:"rightFloated",content:"Load Values",labelPosition:"left"},onChange:this.props.onChange,help:"You can provide YAML file with ".concat(this.props.dataType," to automatically fill in the form."),loading:this.props.fileLoading,disabled:this.props.fileLoading})}}]),t}(React.Component);h()(m,"propTypes",{dataType:PropTypes.string,fileLoading:PropTypes.bool,onChange:PropTypes.func}),h()(m,"defaultProps",{dataType:"values",fileLoading:!1,onChange:_.noop}),Stage.defineCommon({name:"YamlFileButton",common:m})}]);
\ No newline at end of file
+var r;r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){"use strict";t.__esModule=!0,t.canonicalize=t.convertChangesToXML=t.convertChangesToDMP=t.merge=t.parsePatch=t.applyPatches=t.applyPatch=t.createPatch=t.createTwoFilesPatch=t.structuredPatch=t.diffArrays=t.diffJson=t.diffCss=t.diffSentences=t.diffTrimmedLines=t.diffLines=t.diffWordsWithSpace=t.diffWords=t.diffChars=t.Diff=void 0;var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=n(2),l=n(3),s=n(5),c=n(6),u=n(7),p=n(8),d=n(9),f=n(10),h=n(11),m=n(13),g=n(14),y=n(16),v=n(17);t.Diff=i.default,t.diffChars=a.diffChars,t.diffWords=l.diffWords,t.diffWordsWithSpace=l.diffWordsWithSpace,t.diffLines=s.diffLines,t.diffTrimmedLines=s.diffTrimmedLines,t.diffSentences=c.diffSentences,t.diffCss=u.diffCss,t.diffJson=p.diffJson,t.diffArrays=d.diffArrays,t.structuredPatch=g.structuredPatch,t.createTwoFilesPatch=g.createTwoFilesPatch,t.createPatch=g.createPatch,t.applyPatch=f.applyPatch,t.applyPatches=f.applyPatches,t.parsePatch=h.parsePatch,t.merge=m.merge,t.convertChangesToDMP=y.convertChangesToDMP,t.convertChangesToXML=v.convertChangesToXML,t.canonicalize=p.canonicalize},function(e,t){"use strict";function n(){}function r(e,t,n,r,o){for(var i=0,a=t.length,l=0,s=0;i<a;i++){var c=t[i];if(c.removed){if(c.value=e.join(r.slice(s,s+c.count)),s+=c.count,i&&t[i-1].added){var u=t[i-1];t[i-1]=t[i],t[i]=u}}else{if(!c.added&&o){var p=n.slice(l,l+c.count);p=p.map((function(e,t){var n=r[s+t];return n.length>e.length?n:e})),c.value=e.join(p)}else c.value=e.join(n.slice(l,l+c.count));l+=c.count,c.added||(s+=c.count)}}var d=t[a-1];return a>1&&"string"==typeof d.value&&(d.added||d.removed)&&e.equals("",d.value)&&(t[a-2].value+=d.value,t.pop()),t}function o(e){return{newPos:e.newPos,components:e.components.slice(0)}}t.__esModule=!0,t.default=n,n.prototype={diff:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.callback;"function"==typeof n&&(i=n,n={}),this.options=n;var a=this;function l(e){return i?(setTimeout((function(){i(void 0,e)}),0),!0):e}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e));var s=(t=this.removeEmpty(this.tokenize(t))).length,c=e.length,u=1,p=s+c,d=[{newPos:-1,components:[]}],f=this.extractCommon(d[0],t,e,0);if(d[0].newPos+1>=s&&f+1>=c)return l([{value:this.join(t),count:t.length}]);function h(){for(var n=-1*u;n<=u;n+=2){var i=void 0,p=d[n-1],f=d[n+1],h=(f?f.newPos:0)-n;p&&(d[n-1]=void 0);var m=p&&p.newPos+1<s,g=f&&0<=h&&h<c;if(m||g){if(!m||g&&p.newPos<f.newPos?(i=o(f),a.pushComponent(i.components,void 0,!0)):((i=p).newPos++,a.pushComponent(i.components,!0,void 0)),h=a.extractCommon(i,t,e,n),i.newPos+1>=s&&h+1>=c)return l(r(a,i.components,t,e,a.useLongestToken));d[n]=i}else d[n]=void 0}u++}if(i)!function e(){setTimeout((function(){if(u>p)return i();h()||e()}),0)}();else for(;u<=p;){var m=h();if(m)return m}},pushComponent:function(e,t,n){var r=e[e.length-1];r&&r.added===t&&r.removed===n?e[e.length-1]={count:r.count+1,added:t,removed:n}:e.push({count:1,added:t,removed:n})},extractCommon:function(e,t,n,r){for(var o=t.length,i=n.length,a=e.newPos,l=a-r,s=0;a+1<o&&l+1<i&&this.equals(t[a+1],n[l+1]);)a++,l++,s++;return s&&e.components.push({count:s}),e.newPos=a,l},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}}},function(e,t,n){"use strict";t.__esModule=!0,t.characterDiff=void 0,t.diffChars=function(e,t,n){return a.diff(e,t,n)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=t.characterDiff=new i.default},function(e,t,n){"use strict";t.__esModule=!0,t.wordDiff=void 0,t.diffWords=function(e,t,n){return n=(0,a.generateOptions)(n,{ignoreWhitespace:!0}),c.diff(e,t,n)},t.diffWordsWithSpace=function(e,t,n){return c.diff(e,t,n)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=n(4),l=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,s=/\S/,c=t.wordDiff=new i.default;c.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!s.test(e)&&!s.test(t)},c.tokenize=function(e){for(var t=e.split(/(\s+|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&l.test(t[n])&&l.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t}},function(e,t){"use strict";t.__esModule=!0,t.generateOptions=function(e,t){if("function"==typeof e)t.callback=e;else if(e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}},function(e,t,n){"use strict";t.__esModule=!0,t.lineDiff=void 0,t.diffLines=function(e,t,n){return l.diff(e,t,n)},t.diffTrimmedLines=function(e,t,n){var r=(0,a.generateOptions)(n,{ignoreWhitespace:!0});return l.diff(e,t,r)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=n(4),l=t.lineDiff=new i.default;l.tokenize=function(e){var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var o=n[r];r%2&&!this.options.newlineIsToken?t[t.length-1]+=o:(this.options.ignoreWhitespace&&(o=o.trim()),t.push(o))}return t}},function(e,t,n){"use strict";t.__esModule=!0,t.sentenceDiff=void 0,t.diffSentences=function(e,t,n){return a.diff(e,t,n)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=t.sentenceDiff=new i.default;a.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)}},function(e,t,n){"use strict";t.__esModule=!0,t.cssDiff=void 0,t.diffCss=function(e,t,n){return a.diff(e,t,n)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=t.cssDiff=new i.default;a.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)}},function(e,t,n){"use strict";t.__esModule=!0,t.jsonDiff=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.diffJson=function(e,t,n){return c.diff(e,t,n)},t.canonicalize=u;var o,i=n(1),a=(o=i)&&o.__esModule?o:{default:o},l=n(5),s=Object.prototype.toString,c=t.jsonDiff=new a.default;function u(e,t,n,o,i){t=t||[],n=n||[],o&&(e=o(i,e));var a=void 0;for(a=0;a<t.length;a+=1)if(t[a]===e)return n[a];var l=void 0;if("[object Array]"===s.call(e)){for(t.push(e),l=new Array(e.length),n.push(l),a=0;a<e.length;a+=1)l[a]=u(e[a],t,n,o,i);return t.pop(),n.pop(),l}if(e&&e.toJSON&&(e=e.toJSON()),"object"===(void 0===e?"undefined":r(e))&&null!==e){t.push(e),l={},n.push(l);var c=[],p=void 0;for(p in e)e.hasOwnProperty(p)&&c.push(p);for(c.sort(),a=0;a<c.length;a+=1)l[p=c[a]]=u(e[p],t,n,o,p);t.pop(),n.pop()}else l=e;return l}c.useLongestToken=!0,c.tokenize=l.lineDiff.tokenize,c.castInput=function(e){var t=this.options,n=t.undefinedReplacement,r=t.stringifyReplacer,o=void 0===r?function(e,t){return void 0===t?n:t}:r;return"string"==typeof e?e:JSON.stringify(u(e,null,null,o),o,"  ")},c.equals=function(e,t){return a.default.prototype.equals.call(c,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))}},function(e,t,n){"use strict";t.__esModule=!0,t.arrayDiff=void 0,t.diffArrays=function(e,t,n){return a.diff(e,t,n)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=t.arrayDiff=new i.default;a.tokenize=function(e){return e.slice()},a.join=a.removeEmpty=function(e){return e}},function(e,t,n){"use strict";t.__esModule=!0,t.applyPatch=l,t.applyPatches=function(e,t){"string"==typeof e&&(e=(0,o.parsePatch)(e));var n=0;!function r(){var o=e[n++];if(!o)return t.complete();t.loadFile(o,(function(e,n){if(e)return t.complete(e);var i=l(n,o,t);t.patched(o,i,(function(e){if(e)return t.complete(e);r()}))}))}()};var r,o=n(11),i=n(12),a=(r=i)&&r.__esModule?r:{default:r};function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof t&&(t=(0,o.parsePatch)(t)),Array.isArray(t)){if(t.length>1)throw new Error("applyPatch only works with a single input.");t=t[0]}var r=e.split(/\r\n|[\n\v\f\r\x85]/),i=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],l=t.hunks,s=n.compareLine||function(e,t,n,r){return t===r},c=0,u=n.fuzzFactor||0,p=0,d=0,f=void 0,h=void 0;function m(e,t){for(var n=0;n<e.lines.length;n++){var o=e.lines[n],i=o.length>0?o[0]:" ",a=o.length>0?o.substr(1):o;if(" "===i||"-"===i){if(!s(t+1,r[t],i,a)&&++c>u)return!1;t++}}return!0}for(var g=0;g<l.length;g++){for(var y=l[g],v=r.length-y.oldLines,b=0,E=d+y.oldStart-1,R=(0,a.default)(E,p,v);void 0!==b;b=R())if(m(y,E+b)){y.offset=d+=b;break}if(void 0===b)return!1;p=y.offset+y.oldStart+y.oldLines}for(var w=0,_=0;_<l.length;_++){var C=l[_],S=C.oldStart+C.offset+w-1;w+=C.newLines-C.oldLines,S<0&&(S=0);for(var k=0;k<C.lines.length;k++){var P=C.lines[k],x=P.length>0?P[0]:" ",T=P.length>0?P.substr(1):P,O=C.linedelimiters[k];if(" "===x)S++;else if("-"===x)r.splice(S,1),i.splice(S,1);else if("+"===x)r.splice(S,0,T),i.splice(S,0,O),S++;else if("\\"===x){var F=C.lines[k-1]?C.lines[k-1][0]:null;"+"===F?f=!0:"-"===F&&(h=!0)}}}if(f)for(;!r[r.length-1];)r.pop(),i.pop();else h&&(r.push(""),i.push("\n"));for(var I=0;I<r.length-1;I++)r[I]=r[I]+i[I];return r.join("")}},function(e,t){"use strict";t.__esModule=!0,t.parsePatch=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.split(/\r\n|[\n\v\f\r\x85]/),r=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=[],i=0;function a(){var e={};for(o.push(e);i<n.length;){var r=n[i];if(/^(\-\-\-|\+\+\+|@@)\s/.test(r))break;var a=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(r);a&&(e.index=a[1]),i++}for(l(e),l(e),e.hunks=[];i<n.length;){var c=n[i];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(c))break;if(/^@@/.test(c))e.hunks.push(s());else{if(c&&t.strict)throw new Error("Unknown line "+(i+1)+" "+JSON.stringify(c));i++}}}function l(e){var t=/^(---|\+\+\+)\s+(.*)$/.exec(n[i]);if(t){var r="---"===t[1]?"old":"new",o=t[2].split("\t",2),a=o[0].replace(/\\\\/g,"\\");/^".*"$/.test(a)&&(a=a.substr(1,a.length-2)),e[r+"FileName"]=a,e[r+"Header"]=(o[1]||"").trim(),i++}}function s(){for(var e=i,o=n[i++].split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),a={oldStart:+o[1],oldLines:+o[2]||1,newStart:+o[3],newLines:+o[4]||1,lines:[],linedelimiters:[]},l=0,s=0;i<n.length&&!(0===n[i].indexOf("--- ")&&i+2<n.length&&0===n[i+1].indexOf("+++ ")&&0===n[i+2].indexOf("@@"));i++){var c=0==n[i].length&&i!=n.length-1?" ":n[i][0];if("+"!==c&&"-"!==c&&" "!==c&&"\\"!==c)break;a.lines.push(n[i]),a.linedelimiters.push(r[i]||"\n"),"+"===c?l++:"-"===c?s++:" "===c&&(l++,s++)}if(l||1!==a.newLines||(a.newLines=0),s||1!==a.oldLines||(a.oldLines=0),t.strict){if(l!==a.newLines)throw new Error("Added line count did not match for hunk at line "+(e+1));if(s!==a.oldLines)throw new Error("Removed line count did not match for hunk at line "+(e+1))}return a}for(;i<n.length;)a();return o}},function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t,n){var r=!0,o=!1,i=!1,a=1;return function l(){if(r&&!i){if(o?a++:r=!1,e+a<=n)return a;i=!0}if(!o)return i||(r=!0),t<=e-a?-a++:(o=!0,l())}}},function(e,t,n){"use strict";t.__esModule=!0,t.calcLineCount=l,t.merge=function(e,t,n){e=s(e,n),t=s(t,n);var r={};(e.index||t.index)&&(r.index=e.index||t.index),(e.newFileName||t.newFileName)&&(c(e)?c(t)?(r.oldFileName=u(r,e.oldFileName,t.oldFileName),r.newFileName=u(r,e.newFileName,t.newFileName),r.oldHeader=u(r,e.oldHeader,t.oldHeader),r.newHeader=u(r,e.newHeader,t.newHeader)):(r.oldFileName=e.oldFileName,r.newFileName=e.newFileName,r.oldHeader=e.oldHeader,r.newHeader=e.newHeader):(r.oldFileName=t.oldFileName||e.oldFileName,r.newFileName=t.newFileName||e.newFileName,r.oldHeader=t.oldHeader||e.oldHeader,r.newHeader=t.newHeader||e.newHeader)),r.hunks=[];for(var o=0,i=0,a=0,l=0;o<e.hunks.length||i<t.hunks.length;){var h=e.hunks[o]||{oldStart:1/0},m=t.hunks[i]||{oldStart:1/0};if(p(h,m))r.hunks.push(d(h,a)),o++,l+=h.newLines-h.oldLines;else if(p(m,h))r.hunks.push(d(m,l)),i++,a+=m.newLines-m.oldLines;else{var g={oldStart:Math.min(h.oldStart,m.oldStart),oldLines:0,newStart:Math.min(h.newStart+a,m.oldStart+l),newLines:0,lines:[]};f(g,h.oldStart,h.lines,m.oldStart,m.lines),i++,o++,r.hunks.push(g)}}return r};var r=n(14),o=n(11),i=n(15);function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function l(e){var t=function e(t){var n=0,r=0;return t.forEach((function(t){if("string"!=typeof t){var o=e(t.mine),i=e(t.theirs);void 0!==n&&(o.oldLines===i.oldLines?n+=o.oldLines:n=void 0),void 0!==r&&(o.newLines===i.newLines?r+=o.newLines:r=void 0)}else void 0===r||"+"!==t[0]&&" "!==t[0]||r++,void 0===n||"-"!==t[0]&&" "!==t[0]||n++})),{oldLines:n,newLines:r}}(e.lines),n=t.oldLines,r=t.newLines;void 0!==n?e.oldLines=n:delete e.oldLines,void 0!==r?e.newLines=r:delete e.newLines}function s(e,t){if("string"==typeof e){if(/^@@/m.test(e)||/^Index:/m.test(e))return(0,o.parsePatch)(e)[0];if(!t)throw new Error("Must provide a base reference or pass in a patch");return((0,r.structuredPatch)(void 0,void 0,t,e))}return e}function c(e){return e.newFileName&&e.newFileName!==e.oldFileName}function u(e,t,n){return t===n?t:(e.conflict=!0,{mine:t,theirs:n})}function p(e,t){return e.oldStart<t.oldStart&&e.oldStart+e.oldLines<t.oldStart}function d(e,t){return{oldStart:e.oldStart,oldLines:e.oldLines,newStart:e.newStart+t,newLines:e.newLines,lines:e.lines}}function f(e,t,n,r,o){var i={offset:t,lines:n,index:0},s={offset:r,lines:o,index:0};for(y(e,i,s),y(e,s,i);i.index<i.lines.length&&s.index<s.lines.length;){var c=i.lines[i.index],u=s.lines[s.index];if("-"!==c[0]&&"+"!==c[0]||"-"!==u[0]&&"+"!==u[0])if("+"===c[0]&&" "===u[0]){var p;(p=e.lines).push.apply(p,a(b(i)))}else if("+"===u[0]&&" "===c[0]){var d;(d=e.lines).push.apply(d,a(b(s)))}else"-"===c[0]&&" "===u[0]?m(e,i,s):"-"===u[0]&&" "===c[0]?m(e,s,i,!0):c===u?(e.lines.push(c),i.index++,s.index++):g(e,b(i),b(s));else h(e,i,s)}v(e,i),v(e,s),l(e)}function h(e,t,n){var r=b(t),o=b(n);if(E(r)&&E(o)){var l,s;if((0,i.arrayStartsWith)(r,o)&&R(n,r,r.length-o.length))return void(l=e.lines).push.apply(l,a(r));if((0,i.arrayStartsWith)(o,r)&&R(t,o,o.length-r.length))return void(s=e.lines).push.apply(s,a(o))}else if((0,i.arrayEqual)(r,o)){var c;return void(c=e.lines).push.apply(c,a(r))}g(e,r,o)}function m(e,t,n,r){var o,i=b(t),l=function(e,t){for(var n=[],r=[],o=0,i=!1,a=!1;o<t.length&&e.index<e.lines.length;){var l=e.lines[e.index],s=t[o];if("+"===s[0])break;if(i=i||" "!==l[0],r.push(s),o++,"+"===l[0])for(a=!0;"+"===l[0];)n.push(l),l=e.lines[++e.index];s.substr(1)===l.substr(1)?(n.push(l),e.index++):a=!0}if("+"===(t[o]||"")[0]&&i&&(a=!0),a)return n;for(;o<t.length;)r.push(t[o++]);return{merged:r,changes:n}}(n,i);l.merged?(o=e.lines).push.apply(o,a(l.merged)):g(e,r?l:i,r?i:l)}function g(e,t,n){e.conflict=!0,e.lines.push({conflict:!0,mine:t,theirs:n})}function y(e,t,n){for(;t.offset<n.offset&&t.index<t.lines.length;){var r=t.lines[t.index++];e.lines.push(r),t.offset++}}function v(e,t){for(;t.index<t.lines.length;){var n=t.lines[t.index++];e.lines.push(n)}}function b(e){for(var t=[],n=e.lines[e.index][0];e.index<e.lines.length;){var r=e.lines[e.index];if("-"===n&&"+"===r[0]&&(n="+"),n!==r[0])break;t.push(r),e.index++}return t}function E(e){return e.reduce((function(e,t){return e&&"-"===t[0]}),!0)}function R(e,t,n){for(var r=0;r<n;r++){var o=t[t.length-n+r].substr(1);if(e.lines[e.index+r]!==" "+o)return!1}return e.index+=n,!0}},function(e,t,n){"use strict";t.__esModule=!0,t.structuredPatch=i,t.createTwoFilesPatch=a,t.createPatch=function(e,t,n,r,o,i){return a(e,e,t,n,r,o,i)};var r=n(5);function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t,n,i,a,l,s){s||(s={}),void 0===s.context&&(s.context=4);var c=(0,r.diffLines)(n,i,s);function u(e){return e.map((function(e){return" "+e}))}c.push({value:"",lines:[]});for(var p=[],d=0,f=0,h=[],m=1,g=1,y=function(e){var t=c[e],r=t.lines||t.value.replace(/\n$/,"").split("\n");if(t.lines=r,t.added||t.removed){var a;if(!d){var l=c[e-1];d=m,f=g,l&&(h=s.context>0?u(l.lines.slice(-s.context)):[],d-=h.length,f-=h.length)}(a=h).push.apply(a,o(r.map((function(e){return(t.added?"+":"-")+e})))),t.added?g+=r.length:m+=r.length}else{if(d)if(r.length<=2*s.context&&e<c.length-2){var y;(y=h).push.apply(y,o(u(r)))}else{var v,b=Math.min(r.length,s.context);(v=h).push.apply(v,o(u(r.slice(0,b))));var E={oldStart:d,oldLines:m-d+b,newStart:f,newLines:g-f+b,lines:h};if(e>=c.length-2&&r.length<=s.context){var R=/\n$/.test(n),w=/\n$/.test(i);0!=r.length||R?R&&w||h.push("\\ No newline at end of file"):h.splice(E.oldLines,0,"\\ No newline at end of file")}p.push(E),d=0,f=0,h=[]}m+=r.length,g+=r.length}},v=0;v<c.length;v++)y(v);return{oldFileName:e,newFileName:t,oldHeader:a,newHeader:l,hunks:p}}function a(e,t,n,r,o,a,l){var s=i(e,t,n,r,o,a,l),c=[];e==t&&c.push("Index: "+e),c.push("==================================================================="),c.push("--- "+s.oldFileName+(void 0===s.oldHeader?"":"\t"+s.oldHeader)),c.push("+++ "+s.newFileName+(void 0===s.newHeader?"":"\t"+s.newHeader));for(var u=0;u<s.hunks.length;u++){var p=s.hunks[u];c.push("@@ -"+p.oldStart+","+p.oldLines+" +"+p.newStart+","+p.newLines+" @@"),c.push.apply(c,p.lines)}return c.join("\n")+"\n"}},function(e,t){"use strict";function n(e,t){if(t.length>e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}t.__esModule=!0,t.arrayEqual=function(e,t){return e.length===t.length&&n(e,t)},t.arrayStartsWith=n},function(e,t){"use strict";t.__esModule=!0,t.convertChangesToDMP=function(e){for(var t=[],n=void 0,r=void 0,o=0;o<e.length;o++)n=e[o],r=n.added?1:n.removed?-1:0,t.push([r,n.value]);return t}},function(e,t){"use strict";t.__esModule=!0,t.convertChangesToXML=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.added?t.push("<ins>"):r.removed&&t.push("<del>"),t.push((o=r.value,void 0,o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"))),r.added?t.push("</ins>"):r.removed&&t.push("</del>")}var o;return t.join("")}}])},e.exports=r()},function(e,t,n){n(17),n(18),n(19),n(22),n(23),n(24),n(26),n(27),n(28),n(29),n(42),n(43),n(44),n(45),n(46),n(49),n(50),n(51),n(52),n(53),n(54),n(55),n(56),n(57),n(58),n(59),n(60),n(61),n(62),n(63),n(64),n(65),n(66),n(67),e.exports=n(68)},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"doGetBlueprints",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.toolbox.getManager().doGet("/blueprints?_include=id",e)}},{key:"doGetFullBlueprintData",value:function(e){return this.toolbox.getManager().doGet("/blueprints/".concat(e.id))}},{key:"doDelete",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.toolbox.getManager().doDelete("/blueprints/".concat(e),{force:n}).then((function(){return t.doDeleteImage(e)}))}},{key:"doDeploy",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l={blueprint_id:e.id,inputs:n,visibility:r,skip_plugins_validation:o,runtime_only_evaluation:a};return i&&(l.site_name=i),this.toolbox.getManager().doPut("/deployments/".concat(t),null,l)}},{key:"doUpload",value:function(e,t,n,r,o,i,a){var l,s=this,c={visibility:a};if(_.isEmpty(t)||(c.application_file_name=t),_.isEmpty(n)||(c.blueprint_archive_url=n),r){var u=_.endsWith(r.name,".yaml")||_.endsWith(r.name,".yml");l=this.toolbox.getManager().doUpload("/blueprints/".concat(e),c,r,void 0,void 0,u)}else l=this.toolbox.getManager().doPut("/blueprints/".concat(e),c);return l.then((function(){return s.doUploadImage(e,o,i)}))}},{key:"doSetVisibility",value:function(e,t){return this.toolbox.getManager().doPatch("/blueprints/".concat(e,"/set-visibility"),null,{visibility:t})}},{key:"doListYamlFiles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?this.toolbox.getInternal().doUpload("/source/list/yaml",{includeFilename:n},{archive:t}):this.toolbox.getInternal().doPut("/source/list/yaml",{url:e,includeFilename:n})}},{key:"doUploadImage",value:function(e,t,n){if(_.isEmpty(t)&&!n)return Promise.resolve();var r={imageUrl:t};return n?this.toolbox.getInternal().doUpload("/ba/image/".concat(e),r,n,"post"):this.toolbox.getInternal().doPost("/ba/image/".concat(e),r)}},{key:"doDeleteImage",value:function(e){return this.toolbox.getInternal().doDelete("/ba/image/".concat(e))}}]),e}();Stage.defineCommon({name:"BlueprintActions",common:l})},function(e,t){Stage.defineCommon({name:"Consts",common:{defaultVisibility:"tenant",sysAdminRole:"sys_admin",defaultUserRole:"default",adminUsername:"admin",licenseEdition:{premium:"Premium",spire:"Spire"},leaflet:{mapOptions:{minZoom:2,maxZoom:18,maxBounds:[[-90,-180],[90,180]],maxBoundsViscosity:.75},initialZoom:2.5,urlTemplate:"/maps/{z}/{x}/{y}/{r}"}}})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(6),d=n.n(p),f=n(5),h=n.n(f),m=n(0),g=n.n(m);function y(e){var t=e.name,n=e.description,r=e.version,o=e.derivedFrom,i=e.properties,a=Stage.Basic,l=a.Header,s=a.ParameterValue,c=a.Segment,u=a.Table,p=function(e){var t=e.show,n=e.name,r=e.value;return t&&React.createElement(React.Fragment,null,React.createElement(l,{as:"h4"},_.capitalize(n)),r)},d=Stage.Common.InputsUtils.getTemplateForDataType({properties:i});return React.createElement("div",null,React.createElement(l,{as:"h3",attached:"top"},t),React.createElement(c,{attached:!0},React.createElement(p,{name:"Description",show:!!n,value:n}),React.createElement(p,{name:"Version",show:!!r,value:r}),React.createElement(p,{name:"Derived From",show:!!o,value:o}),React.createElement(p,{name:"Properties",show:!!i,value:React.createElement(u,{celled:!0},React.createElement(u.Header,null,React.createElement(u.Row,null,React.createElement(u.HeaderCell,null,"Name"),React.createElement(u.HeaderCell,null,"Type"),React.createElement(u.HeaderCell,null,"Description"),React.createElement(u.HeaderCell,null,"Default Value"),React.createElement(u.HeaderCell,null,"Required"))),React.createElement(u.Body,null,_.map(i,(function(e,t){return React.createElement(u.Row,{key:t,name:t},React.createElement(u.Cell,null,t),React.createElement(u.Cell,null,e.type),React.createElement(u.Cell,null,e.description),React.createElement(u.Cell,null,React.createElement(s,{value:e.default,showCopyButton:!1})),React.createElement(u.Cell,null,e.required?"Yes":"No"))}))))}),React.createElement(p,{name:"Example",show:!!i,value:React.createElement(s,{value:d})})))}var v=function(e){function t(e){var n;return o()(this,t),(n=s()(this,u()(t).call(this,e))).state={open:!1},n.onOpen=n.onOpen.bind(d()(n)),n.onClose=n.onClose.bind(d()(n)),n}return h()(t,e),a()(t,[{key:"shouldComponentUpdate",value:function(e,t){return!_.isEqual(this.props,e)||!_.isEqual(this.state,t)}},{key:"onOpen",value:function(){this.setState({open:!0})}},{key:"onClose",value:function(){this.setState({open:!1})}},{key:"render",value:function(){var e=Stage.Basic,t=e.Button,n=e.CancelButton,r=e.Modal;return React.createElement("div",null,React.createElement(t,{icon:"code",content:"Show Data Types",onClick:this.onOpen,className:"rightFloated",labelPosition:"left"}),React.createElement(r,{open:this.state.open,onClose:this.onClose},React.createElement(r.Header,null,"Data Types"),React.createElement(r.Content,null,_.map(this.props.types,(function(e,t){return React.createElement(y,{key:t,name:t,description:e.description,derivedFrom:e.derived_from,version:e.version,properties:e.properties})}))),React.createElement(r.Actions,null,React.createElement(n,{onClick:this.onClose,content:"Close"}))))}}]),t}(React.Component);g()(v,"propTypes",{types:PropTypes.objectOf(PropTypes.shape({derived_from:PropTypes.string,version:PropTypes.string,properties:PropTypes.objectOf(PropTypes.shape({description:PropTypes.string,type:PropTypes.string,default:PropTypes.any,required:PropTypes.bool})).isRequired}).isRequired).isRequired}),Stage.defineCommon({name:"DataTypesButton",common:v})},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e,n){return o()(this,t),s()(this,u()(t).call(this,e,n))}return d()(t,e),a()(t,[{key:"render",value:function(){var e=Stage.Basic,t=e.Confirm,n=e.Form,r=e.Segment;return React.createElement(t,{className:this.props.className,header:"Are you sure you want to remove ".concat(this.props.resourceName,"?"),content:React.createElement(r,{basic:!0},React.createElement(n.Field,null,React.createElement(n.Checkbox,{name:"force",toggle:!0,label:"Force",checked:this.props.force,onChange:this.props.onForceChange}))),open:this.props.open,onConfirm:this.props.onConfirm,onCancel:this.props.onCancel})}}]),t}(React.Component);h()(m,"propTypes",{resourceName:PropTypes.string.isRequired,onConfirm:PropTypes.func.isRequired,onCancel:PropTypes.func.isRequired,open:PropTypes.bool.isRequired,className:PropTypes.string,force:PropTypes.bool,onForceChange:PropTypes.func}),h()(m,"defaultProps",{className:"",force:!1,onForceChange:_.noop}),Stage.defineCommon({name:"DeleteConfirm",common:m})},function(e,t,n){"use strict";n.r(t);var r,o,i,a=n(1),l=n.n(a),s=n(2),c=n.n(s),u=n(3),p=n.n(u),d=n(4),f=n.n(d),h=n(6),m=n.n(h),g=n(5),y=n.n(g),v=n(0),b=n.n(v);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=Object.freeze({validateData:"validateData",deployBlueprint:"deployBlueprint",waitForDeployment:"waitForDeployment",installDeployment:"installDeployment"}),C=Object.freeze({deploy:"deploy",deployAndInstall:"deployAndInstall"}),S=Object.freeze((i={},b()(i,C.deploy,(r={},b()(r,w.validateData,"1/2: Validating data..."),b()(r,w.deployBlueprint,"2/2: Deploying blueprint..."),r)),b()(i,C.deployAndInstall,(o={},b()(o,w.validateData,"1/4: Validating data..."),b()(o,w.deployBlueprint,"2/4: Deploying blueprint..."),b()(o,w.waitForDeployment,"3/4: Creating deployment environment... "),b()(o,w.installDeployment,"4/4: Installing deployment..."),o)),i)),k=function(e){function t(e){var n;return l()(this,t),(n=p()(this,f()(t).call(this,e))).state=t.initialState,n.selectBlueprint=n.selectBlueprint.bind(m()(n)),n.handleDeploymentInputChange=n.handleDeploymentInputChange.bind(m()(n)),n.handleInputChange=n.handleInputChange.bind(m()(n)),n.handleYamlFileChange=n.handleYamlFileChange.bind(m()(n)),n.onCancel=n.onCancel.bind(m()(n)),n.onDeploy=n.onDeploy.bind(m()(n)),n.onDeployAndInstall=n.onDeployAndInstall.bind(m()(n)),n.hideInstallModal=n.hideInstallModal.bind(m()(n)),n.showInstallModal=n.showInstallModal.bind(m()(n)),n}return y()(t,e),c()(t,[{key:"componentDidUpdate",value:function(e){var n=this,r=this.props,o=r.blueprintId,i=r.open;!e.open&&i&&this.setState(t.initialState,(function(){return n.selectBlueprint(o)}))}},{key:"setLoadingMessage",value:function(e,t){this.setState({loadingMessage:S[e][t]})}},{key:"onCancel",value:function(){return(0,this.props.onHide)(),!0}},{key:"onDeploy",value:function(){var e=this,t=this.props,n=t.onHide,r=t.toolbox;return this.setState({loading:!0,errors:{}}),this.setLoadingMessage(C.deploy,w.validateData),this.validateInputs().then((function(t){return e.setLoadingMessage(C.deploy,w.deployBlueprint),e.deployBlueprint(t)})).then((function(){e.setState({loading:!1,errors:{}}),r.getEventBus().trigger("deployments:refresh"),n()})).catch((function(t){e.setState({loading:!1,errors:t})}))}},{key:"onDeployAndInstall",value:function(e,t,n,r,o){var i=this,a=this.props,l=a.onHide,s=a.toolbox;this.setState({loading:!0,errors:{}});var c=null;return this.setLoadingMessage(C.deployAndInstall,w.validateData),this.validateInputs().then((function(e){return i.setLoadingMessage(C.deployAndInstall,w.deployBlueprint),i.deployBlueprint(e)})).then((function(e){return c=e.id,i.setLoadingMessage(C.deployAndInstall,w.waitForDeployment),i.waitForDeploymentIsCreated(c)})).then((function(){return i.setLoadingMessage(C.deployAndInstall,w.installDeployment),i.installDeployment(c,e,t,n,r,o)})).then((function(){return i.setState({loading:!1,errors:{}}),s.getEventBus().trigger("deployments:refresh"),s.getEventBus().trigger("executions:refresh"),l()})).catch((function(e){i.setState({loading:!1,errors:e})}))}},{key:"showInstallModal",value:function(){var e=this;return this.setState({loading:!0,errors:{}}),this.validateInputs().then((function(){return e.setState({loading:!1,showInstallModal:!0})})).catch((function(t){e.setState({loading:!1,errors:t})}))}},{key:"hideInstallModal",value:function(){this.setState({showInstallModal:!1})}},{key:"isBlueprintSelectable",value:function(){var e=this.props.blueprintId;return _.isEmpty(e)}},{key:"selectBlueprint",value:function(e){var n=this;if(_.isEmpty(e))this.setState({blueprint:t.EMPTY_BLUEPRINT,errors:{}});else{this.setState({loading:!0,loadingMessage:"Loading inputs..."});var r=this.props.toolbox,o=Stage.Common,i=o.BlueprintActions,a=o.InputsUtils;new i(r).doGetFullBlueprintData({id:e}).then((function(e){var t=a.getInputsInitialValuesFrom(e.plan);n.setState({deploymentInputs:t,blueprint:e,errors:{},loading:!1})})).catch((function(e){n.setState({blueprint:t.EMPTY_BLUEPRINT,loading:!1,errors:{error:e.message}})}))}}},{key:"validateInputs",value:function(){var e=this;return new Promise((function(t,n){var r=Stage.Common.InputsUtils,o=e.state,i=o.blueprint,a=o.deploymentName,l=o.deploymentInputs,s={};_.isEmpty(i.id)&&(s.blueprintName="Please select blueprint from the list"),_.isEmpty(a)&&(s.deploymentName="Please provide deployment name");var c={},u=r.getInputsToSend(i.plan.inputs,l,c);r.addErrors(c,s),_.isEmpty(s)?t(u):n(s)}))}},{key:"deployBlueprint",value:function(e){var t=Stage.Common,n=t.BlueprintActions,r=t.InputsUtils,o=this.props.toolbox,i=this.state,a=i.blueprint,l=i.deploymentName,s=i.runtimeOnlyEvaluation,c=i.siteName,u=i.skipPluginsValidation,p=i.visibility;return new n(o).doDeploy(a,l,e,p,u,c,s).catch((function(e){return Promise.reject(r.getErrorObject(e.message))}))}},{key:"waitForDeploymentIsCreated",value:function(e){return new(0,Stage.Common.DeploymentActions)(this.props.toolbox).waitUntilCreated(e).catch((function(t){return Promise.reject("Deployment ".concat(e," environment creation failed. ").concat(t))}))}},{key:"installDeployment",value:function(e,t,n,r,o,i){return new(0,Stage.Common.DeploymentActions)(this.props.toolbox).doExecute({id:e},{name:"install"},t,n,r,o,i).catch((function(t){return Promise.reject({errors:"Deployment ".concat(e," installation failed: ").concat(t.message)})}))}},{key:"handleYamlFileChange",value:function(e){var t=this;if(e){var n=Stage.Common,r=n.FileActions,o=n.InputsUtils,i=this.state,a=i.blueprint,l=i.deploymentInputs,s=new r(this.props.toolbox);this.setState({fileLoading:!0}),s.doGetYamlFileContent(e).then((function(e){var n=o.getUpdatedInputs(a.plan.inputs,l,e);t.setState({errors:{},deploymentInputs:n,fileLoading:!1})})).catch((function(e){var n="Loading values from YAML file failed: ".concat(_.isString(e)?e:e.message);t.setState({errors:{yamlFile:n},fileLoading:!1})}))}}},{key:"handleInputChange",value:function(e,t){var n=Stage.Basic.Form.fieldNameValue(t);this.setState(n)}},{key:"handleDeploymentInputChange",value:function(e,t){var n=this.state.deploymentInputs,r=Stage.Basic.Form.fieldNameValue(t);this.setState({deploymentInputs:R({},n,{},r)})}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.ApproveButton,r=t.CancelButton,o=t.Form,i=t.Icon,a=t.LoadingOverlay,l=t.Message,s=t.Modal,c=t.VisibilityField,u=Stage.Common,p=u.DataTypesButton,d=u.InputsHeader,f=u.InputsUtils,h=u.YamlFileButton,m=u.DynamicDropdown,g=u.ExecuteDeploymentModal,y=this.props,v=y.onHide,b=y.open,E=y.toolbox,w=this.state,C=w.blueprint,S=w.deploymentInputs,k=w.deploymentName,P=w.errors,x=w.fileLoading,T=w.loading,O=w.loadingMessage,F=w.runtimeOnlyEvaluation,I=w.showInstallModal,U=w.skipPluginsValidation,D=w.siteName,L=w.visibility,N=R({},C.plan.workflows.install,{name:"install"});return React.createElement(s,{open:b,onClose:function(){return v()},closeOnEscape:!1,className:"deployBlueprintModal"},React.createElement(s.Header,null,React.createElement(i,{name:"rocket"})," Deploy blueprint ",C.id,React.createElement(c,{visibility:L,className:"rightFloated",onVisibilityChange:function(t){return e.setState({visibility:t})}})),React.createElement(s.Content,null,React.createElement(o,{errors:P,scrollToError:!0,onErrorsDismiss:function(){return e.setState({errors:{}})}},T&&React.createElement(a,{message:O}),React.createElement(o.Field,{error:P.deploymentName,label:"Deployment name",required:!0,help:"Specify a name for this deployment instance."},React.createElement(o.Input,{name:"deploymentName",value:k,onChange:this.handleInputChange})),React.createElement(o.Field,{error:P.siteName,label:"Site name",help:"(Optional) Specify a site to which this deployment will be assigned."},React.createElement(m,{value:D,onChange:function(t){return e.setState({siteName:t})},name:"siteName",fetchUrl:"/sites?_include=name",valueProp:"name",toolbox:E})),this.isBlueprintSelectable()&&React.createElement(o.Field,{error:P.blueprintName,label:"Blueprint",required:!0,help:"Select the blueprint based on which this deployment will be created."},React.createElement(m,{value:C.id,name:"blueprintName",fetchUrl:"/blueprints?_include=id",onChange:this.selectBlueprint,toolbox:E,prefetch:!0})),C.id&&React.createElement(React.Fragment,null,!_.isEmpty(C.plan.inputs)&&React.createElement(h,{onChange:this.handleYamlFileChange,dataType:"deployment's inputs",fileLoading:x}),!_.isEmpty(C.plan.data_types)&&React.createElement(p,{types:C.plan.data_types}),React.createElement(d,null),_.isEmpty(C.plan.inputs)&&React.createElement(l,{content:"No inputs available for the blueprint"})),f.getInputFields(C.plan.inputs,this.handleDeploymentInputChange,S,P,C.plan.data_types),React.createElement(o.Field,{className:"skipPluginsValidationCheckbox"},React.createElement(o.Checkbox,{toggle:!0,label:"Skip plugins validation",name:"skipPluginsValidation",checked:U,onChange:this.handleInputChange})),U&&React.createElement(l,null,"The recommended path is uploading plugins as wagons to Cloudify. This option is designed for plugin development and advanced users only."),React.createElement(o.Field,{help:"If set, then get_property and get_input intrinsic functions will be evaluated on demand at runtime. If not set, then evaluation will be done at deployment creation time."},React.createElement(o.Checkbox,{toggle:!0,label:"Runtime only evaluation",name:"runtimeOnlyEvaluation",checked:F,onChange:this.handleInputChange}))),React.createElement(g,{open:I,workflow:N,onExecute:this.onDeployAndInstall,onHide:this.hideInstallModal,toolbox:E})),React.createElement(s.Actions,null,React.createElement(r,{onClick:this.onCancel,disabled:T}),React.createElement(n,{onClick:this.onDeploy,disabled:T,content:"Deploy",icon:"rocket",className:"green"}),React.createElement(n,{onClick:this.showInstallModal,disabled:T,content:"Deploy & Install",icon:"cogs",className:"green"})))}}]),t}(React.Component);b()(k,"EMPTY_BLUEPRINT",{id:"",plan:{inputs:{},workflows:{install:{}}}}),b()(k,"initialState",{blueprint:k.EMPTY_BLUEPRINT,deploymentInputs:[],deploymentName:"",errors:{},fileLoading:!1,loading:!1,loadingMessage:"",runtimeOnlyEvaluation:!1,showInstallModal:!1,siteName:"",skipPluginsValidation:!1,visibility:Stage.Common.Consts.defaultVisibility,workflow:{},yamlFile:null}),k.propTypes={open:PropTypes.bool.isRequired,toolbox:PropTypes.shape({getEventBus:PropTypes.func.isRequired}).isRequired,blueprintId:PropTypes.string,onHide:PropTypes.func},k.defaultProps={blueprintId:"",onHide:_.noop},Stage.defineCommon({name:"DeployBlueprintModal",common:k})},function(e,t,n){"use strict";n.r(t);var r=n(10),o=n.n(r),i=n(11),a=n.n(i),l=n(1),s=n.n(l),c=n(2),u=n.n(c),p=function(){function e(t){s()(this,e),this.toolbox=t}var t;return u()(e,[{key:"doGet",value:function(e){return this.toolbox.getManager().doGet("/deployments/".concat(e.id))}},{key:"doGetDeployments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.toolbox.getManager().doGet("/deployments?_include=id",e)}},{key:"doDelete",value:function(e){return this.toolbox.getManager().doDelete("/deployments/".concat(e.id))}},{key:"doForceDelete",value:function(e){return this.toolbox.getManager().doDelete("/deployments/".concat(e.id),{ignore_live_nodes:"true"})}},{key:"doCancel",value:function(e,t){return this.toolbox.getManager().doPost("/executions/".concat(e.id),null,{deployment_id:e.deployment_id,action:t})}},{key:"doExecute",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;return this.toolbox.getManager().doPost("/executions",null,{deployment_id:e.id,workflow_id:t.name,dry_run:o,force:r,queue:i,scheduled_time:a,parameters:n})}},{key:"doUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],c=arguments.length>9&&void 0!==arguments[9]&&arguments[9],u=arguments.length>10&&void 0!==arguments[10]&&arguments[10],p={};return _.isEmpty(t)||(p.blueprint_id=t),p.skip_install=!r,p.skip_uninstall=!o,p.install_first=i,p.ignore_failure=a,p.skip_reinstall=!l,p.reinstall_list=s,p.force=c,p.preview=u,_.isEmpty(n)||(p.inputs=n),this.toolbox.getManager().doPut("/deployment-updates/".concat(e,"/update/initiate"),null,p)}},{key:"doSetVisibility",value:function(e,t){return this.toolbox.getManager().doPatch("/deployments/".concat(e,"/set-visibility"),null,{visibility:t})}},{key:"doSetSite",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={detach_site:n};return t&&(r.site_name=t),this.toolbox.getManager().doPost("/deployments/".concat(e,"/set-site"),null,r)}},{key:"doGetSites",value:function(){return this.toolbox.getManager().doGet("/sites?_include=name&_sort=name")}},{key:"waitUntilCreated",value:(t=a()(o.a.mark((function e(t){var n,r,i,a,l,s,c,u=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=u.length>1&&void 0!==u[1]?u[1]:60,r=u.length>2&&void 0!==u[2]?u[2]:1e3,i=Stage.Common.ExecutionActions,a=new i(this.toolbox),l=!1,s=0;case 6:if(!(s<n)||l){e.next=12;break}return e.next=9,new Promise((function(e){setTimeout(e,r)})).then((function(){return a.doGetExecutions(t)})).then((function(e){var t=e.items;l=!_.isEmpty(t)&&_.isUndefined(_.find(t,{ended_at:null}))}));case 9:s+=1,e.next=6;break;case 12:if(!l){e.next=14;break}return e.abrupt("return",Promise.resolve());case 14:return c=Math.floor(n*r/1e3),e.abrupt("return",Promise.reject("Timeout exceeded. Deployment was not created after ".concat(c," seconds.")));case 16:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();Stage.defineCommon({name:"DeploymentActions",common:p})},function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,i=Object.create(o.prototype),a=new P(r||[]);return i._invoke=function(e,t,n){var r=u;return function(o,i){if(r===d)throw new Error("Generator is already running");if(r===f){if("throw"===o)throw i;return T()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var l=C(a,n);if(l){if(l===h)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===u)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var s=c(e,t,n);if("normal"===s.type){if(r=n.done?f:p,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=f,n.method="throw",n.arg=s.arg)}}}(e,n,a),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var u="suspendedStart",p="suspendedYield",d="executing",f="completed",h={};function m(){}function g(){}function y(){}var v={};v[i]=function(){return this};var b=Object.getPrototypeOf,E=b&&b(b(x([])));E&&E!==n&&r.call(E,i)&&(v=E);var R=y.prototype=m.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function _(e){var t;this._invoke=function(n,o){function i(){return new Promise((function(t,i){!function t(n,o,i,a){var l=c(e[n],e,o);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==typeof u&&r.call(u,"__await")?Promise.resolve(u.__await).then((function(e){t("next",e,i,a)}),(function(e){t("throw",e,i,a)})):Promise.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return t("throw",e,i,a)}))}a(l.arg)}(n,o,t,i)}))}return t=t?t.then(i,i):i()}}function C(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method))return h;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var o=c(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,h;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function x(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:T}}function T(){return{value:t,done:!0}}return g.prototype=R.constructor=y,y.constructor=g,y[l]=g.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(R),e},e.awrap=function(e){return{__await:e}},w(_.prototype),_.prototype[a]=function(){return this},e.AsyncIterator=_,e.async=function(t,n,r,o){var i=new _(s(t,n,r,o));return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(R),R[l]="Generator",R[i]=function(){return this},R.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=x,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return l.type="throw",l.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:x(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),h}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){"use strict";n.r(t);var r,o=n(1),i=n.n(o),a=n(2),l=n.n(a),s=n(0),c=n.n(s),u=function(){function e(){i()(this,e)}return l()(e,null,[{key:"getDeploymentState",value:function(t,n,r){var o=n[t].states,i=n[t].count;return Stage.Utils.Execution.isActiveExecution(r)?e.IN_PROGRESS_STATE:Stage.Utils.Execution.isFailedExecution(r)?e.FAILED_STATE:o.started===i?e.GOOD_STATE:e.PENDING_STATE}}]),e}();c()(u,"GOOD_STATE","good"),c()(u,"IN_PROGRESS_STATE","inProgress"),c()(u,"PENDING_STATE","pending"),c()(u,"FAILED_STATE","failed"),c()(u,"groupStates",(r={},c()(r,u.GOOD_STATE,{name:"good",icon:"checkmark",colorSUI:"green",severity:1,description:"deployments with all nodes successfully started"}),c()(r,u.IN_PROGRESS_STATE,{name:"in progress",icon:"spinner",colorSUI:"yellow",severity:2,description:"deployments in which active workflow execution is performed"}),c()(r,u.PENDING_STATE,{name:"pending",icon:"pause",colorSUI:"blue",severity:3,description:"deployments with non-started nodes"}),c()(r,u.FAILED_STATE,{name:"failed",icon:"close",colorSUI:"red",severity:4,description:"deployments with failed workflow execution"}),r)),Stage.defineCommon({name:"DeploymentStates",common:u})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"doGetUpdate",value:function(e){return this.toolbox.getManager().doGet("/deployment-updates/".concat(e))}},{key:"doGetExecutionParameters",value:function(e){return this.toolbox.getManager().doGet("/executions/".concat(e,"?_include=parameters"))}}]),e}();Stage.defineCommon({name:"DeploymentUpdatesActions",common:l})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(){o()(this,e)}return a()(e,null,[{key:"filterWorkflows",value:function(e){return _.filter(e,(function(e){return!_.isEqual(e.name,"update")}))}}]),e}();Stage.defineCommon({name:"DeploymentUtils",common:l})},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),i=n(9),a=n.n(i),l=n(8),s=n.n(l),c=n(13),u=n.n(c),p=(n(38),0);function d(e){var t=e.multiple,n=e.placeholder,r=e.fetchUrl,i=e.fetchAll,l=e.value,c=e.onChange,d=e.toolbox,f=e.filter,h=e.valueProp,m=e.textFormatter,g=e.pageSize,y=e.name,v=e.prefetch,b=e.className,E=e.refreshEvent,R=React,w=R.useState,C=R.useEffect,S=w((function(){return"dynamicDropdown".concat(p+=1)})),k=s()(S,1)[0],P=w([]),x=s()(P,2),T=x[0],O=x[1],F=w(!0),I=s()(F,2),U=I[0],D=I[1],L=w(-1),N=s()(L,2),j=N[0],M=N[1],A=w(""),B=s()(A,2),H=B[0],q=B[1],V=w(!1),Y=s()(V,2),W=Y[0],G=Y[1],z=w(!1),J=s()(z,2),$=J[0],Z=J[1];function X(){if(Z(!0),G(null),i)d.getManager().doGetFull(r).then((function(e){D(!1),O(e.items),Z(!1)}));else{var e=j+1;d.getManager().doGet(r,{_sort:h,_size:g,_offset:e*g}).then((function(t){D(t.metadata.pagination.total>(e+1)*g),O([].concat(a()(T),a()(t.items))),Z(!1)})),M(e)}}C((function(){v&&X()}),[]),C((function(){function e(){O([]),D(!0),M(-1)}if(E)return d.getEventBus().on(E,e),function(){d.getEventBus().off(E,e)}}),[]),C((function(){_.isEmpty(l)?O(_.reject(T,"implicit")):_.castArray(l).forEach((function(e){var t;_.find(T,o()({},h,e))||O([(t={},o()(t,h,e),o()(t,"implicit",!0),t)].concat(a()(T)))}))}),[l]),C((function(){W&&X()}),[W]);var Q=_(T).filter((function(e){return _(f).mapValues((function(e){return d.getContext().getValue(e)})).map((function(t,n){return _.isEmpty(t)||_.isEmpty(e[n])||_.includes(t,e[n])})).every(Boolean)})).uniqBy(h).value();var K,ee=Stage.Basic,te=ee.Form,ne=ee.Loading;return React.createElement(te.Dropdown,{className:"dynamic ".concat(b),search:!0,selection:!0,selectOnBlur:!1,placeholder:n,fluid:!0,value:function(e){if(!e)return t?[]:"";var n=_.castArray(e);if(!U){var r=_(Q).map(h).intersection(n).value();r.length!==n.length&&(c(r),n=r)}return t?n:n[0]}(l),id:k,name:y,onChange:function(e,t){return c(_.isEmpty(t.value)?null:t.value)},onSearchChange:function(e,t){return q(t.searchQuery)},multiple:t,options:(K=Q.map((function(e){return{text:(m||function(e){return e[h]})(e),value:e[h]}})),U&&K.push({disabled:!0,icon:React.createElement(u.a,{active:!$,containment:document.querySelector("#".concat(k," .menu")),partialVisibility:!0,onChange:G},React.createElement(ne,{message:""})),key:"loader",text:H}),K)})}d.propTypes={multiple:PropTypes.bool,placeholder:PropTypes.string,fetchUrl:PropTypes.string.isRequired,fetchAll:PropTypes.bool,value:PropTypes.oneOfType([PropTypes.string,PropTypes.array]),onChange:PropTypes.func.isRequired,toolbox:PropTypes.shape({}).isRequired,filter:PropTypes.shape({}),valueProp:PropTypes.string,textFormatter:PropTypes.func,pageSize:PropTypes.number,name:PropTypes.string,prefetch:PropTypes.bool,className:PropTypes.string,refreshEvent:PropTypes.string},d.defaultProps={value:null,fetchAll:!1,filter:{},valueProp:"id",textFormatter:null,pageSize:10,placeholder:null,name:null,prefetch:!1,multiple:!1,className:"",refreshEvent:null},Stage.defineCommon({name:"DynamicDropdown",common:d})},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t){e.exports=React},function(e,t){e.exports=ReactDOM},function(e,t,n){var r=n(39);"string"==typeof r&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};n(41)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(40)(!1)).push([e.i,".dropdown.dynamic .menu .item.disabled {\n    padding: 0 !important;\n    background: white !important;\n}\n\n.dropdown.dynamic .menu .item.disabled .ui.segment {\n    margin: 3px 0 9px 0;\n}\n\n.dropdown.dynamic .menu .item.disabled .text {\n    display: none;\n}\n",""])},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=(a=r,l=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),"/*# ".concat(s," */")),i=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot).concat(e," */")}));return[n].concat(i).concat([o]).join("\n")}var a,l,s;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];null!=i&&(r[i]=!0)}for(var a=0;a<e.length;a++){var l=e[a];null!=l[0]&&r[l[0]]||(n&&!l[2]?l[2]=n:n&&(l[2]="(".concat(l[2],") and (").concat(n,")")),t.push(l))}},t}},function(e,t,n){"use strict";var r,o={},i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}();function l(e,t){for(var n=[],r={},o=0;o<e.length;o++){var i=e[o],a=t.base?i[0]+t.base:i[0],l={css:i[1],media:i[2],sourceMap:i[3]};r[a]?r[a].parts.push(l):n.push(r[a]={id:a,parts:[l]})}return n}function s(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=o[r.id],a=0;if(i){for(i.refs++;a<i.parts.length;a++)i.parts[a](r.parts[a]);for(;a<r.parts.length;a++)i.parts.push(g(r.parts[a],t))}else{for(var l=[];a<r.parts.length;a++)l.push(g(r.parts[a],t));o[r.id]={id:r.id,refs:1,parts:l}}}}function c(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var r=n.nc;r&&(e.attributes.nonce=r)}if(Object.keys(e.attributes).forEach((function(n){t.setAttribute(n,e.attributes[n])})),"function"==typeof e.insert)e.insert(t);else{var o=a(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var u,p=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=p(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function f(e,t,n){var r=n.css,o=n.media,i=n.sourceMap;if(o&&e.setAttribute("media",o),i&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var h=null,m=0;function g(e,t){var n,r,o;if(t.singleton){var i=m++;n=h||(h=c(t)),r=d.bind(null,n,i,!1),o=d.bind(null,n,i,!0)}else n=c(t),r=f.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=i());var n=l(e,t);return s(n,t),function(e){for(var r=[],i=0;i<n.length;i++){var a=n[i],c=o[a.id];c&&(c.refs--,r.push(c))}e&&s(l(e,t),t);for(var u=0;u<r.length;u++){var p=r[u];if(0===p.refs){for(var d=0;d<p.parts.length;d++)p.parts[d]();delete o[p.id]}}}}},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(0),s=n.n(l),c=n(14);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=function(){function e(){o()(this,e)}return a()(e,null,[{key:"getEventTypeOptions",value:function(t){return p({},{iconChar:c.icons.getEventIcon(t)},{},e.eventTypeOptions[t])}},{key:"getLogLevelOptions",value:function(t){return p({},{icon:"question",color:"orange"},{},e.logLevelOptions[t])}}]),e}();s()(d,"eventType","cloudify_event"),s()(d,"logType","cloudify_log"),s()(d,"typesOptions",[{text:"",value:""},{text:"Logs",value:d.logType},{text:"Events",value:d.eventType}]),s()(d,"eventTypeOptions",{workflow_received:{text:"Workflow received"},workflow_started:{text:"Workflow started",iconClass:"blue"},workflow_initializing_policies:{text:"Workflow initializing policies"},workflow_initializing_node:{text:"Workflow initializing node"},workflow_succeeded:{text:"Workflow ended successfully",iconClass:"green"},workflow_failed:{text:"Workflow failed",iconClass:"red",rowClass:"row-error"},workflow_cancelled:{text:"Workflow cancelled",iconClass:"red",rowClass:"row-error"},workflow_stage:{text:"Workflow staged"},task_started:{text:"Task started",iconClass:"blue"},sending_task:{text:"Task sent",iconClass:"blue"},task_received:{text:"Task received",iconClass:"blue"},task_succeeded:{text:"Task ended successfully",iconClass:"green"},task_failed:{text:"Task failed",iconClass:"red",rowClass:"row-error"},task_rescheduled:{text:"Task rescheduled",iconClass:"yellow",rowClass:"row-error"},task_retried:{text:"Task retried",iconClass:"yellow",rowClass:"row-error"},policy_success:{text:"Policy end successfully started",iconClass:"green"},policy_failed:{text:"Policy failed",iconClass:"red",rowClass:"row-error"},workflow_node_event:{text:"Workflow node event"},processing_trigger:{text:"Processing trigger"},trigger_failed:{text:"Trigger failed",iconClass:"red"},trigger_succeeded:{text:"Trigger succeeded",iconClass:"green"},workflow_event:{text:"Workflow event"}}),s()(d,"logLevelOptions",{debug:{icon:"bug",color:"green",rowClass:"row-debug",text:"Debug"},info:{icon:"info",color:"blue",text:"Info"},warning:{icon:"warning sign",color:"yellow",rowClass:"row-warning",text:"Warning"},error:{icon:"remove",color:"red",rowClass:"row-error",text:"Error"},critical:{icon:"warning",color:"red",rowClass:"row-error",text:"Critical"}}),Stage.defineCommon({name:"EventUtils",common:d})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e,n){var r;return o()(this,t),(r=s()(this,u()(t).call(this,e,n))).state=t.initialState,r}return d()(t,e),a()(t,[{key:"componentDidUpdate",value:function(e){if(!e.open&&this.props.open){var n=Stage.Common.InputsUtils,r=_.mapValues(_.get(this.props.workflow,"parameters",{}),(function(e){return n.getInputFieldInitialValue(e.default,e.type)}));this.setState(g({},t.initialState,{params:r}))}}},{key:"onApprove",value:function(){return this.setState({errors:{}},this._submitExecute),!1}},{key:"onCancel",value:function(){return this.props.onHide(),!0}},{key:"_submitExecute",value:function(){var e=this,t=Stage.Common,n=t.InputsUtils,r=t.DeploymentActions,o={};if(!this.props.deployment||!this.props.workflow)return this.setState({errors:{error:"Missing workflow or deployment"}}),!1;var i={},a=n.getInputsToSend(this.props.workflow.parameters,this.state.params,i);if(n.addErrors(i,o),this.state.schedule){var l=moment(this.state.scheduledTime);l.isValid()&&_.isEqual(l.format("YYYY-MM-DD HH:mm"),this.state.scheduledTime)&&!l.isBefore(moment())||(o.scheduledTime="Please provide valid scheduled time (in the future, using format: YYYY-MM-DD HH:mm)")}if(!_.isEmpty(o))return this.setState({errors:o}),!1;if(_.isFunction(this.props.onExecute)&&this.props.onExecute!==_.noop){var s=this.state.schedule?moment(this.state.scheduledTime).format("YYYYMMDDHHmmZ"):void 0;return this.props.onExecute(a,this.state.force,this.state.dryRun,this.state.queue,s),this.props.onHide(),!0}this.setState({loading:!0});var c=new r(this.props.toolbox),u=this.props.deployments;_.isEmpty(u)&&(u=[this.props.deployment.id]);var p=_.map(u,(function(t){var n=e.state.schedule?moment(e.state.scheduledTime).format("YYYYMMDDHHmmZ"):void 0;return c.doExecute({id:t},e.props.workflow,a,e.state.force,e.state.dryRun,e.state.queue,n).then((function(){e.setState({loading:!1,errors:{}}),e.props.onHide(),e.props.toolbox.getEventBus().trigger("executions:refresh"),e.props.toolbox.getEventBus().trigger("deployments:refresh")}))}));return Promise.all(p).catch((function(t){e.setState({loading:!1,errors:{error:t.message}})}))}},{key:"handleYamlFileChange",value:function(e){var t=this;if(e){var n=Stage.Common,r=n.FileActions,o=n.InputsUtils,i=new r(this.props.toolbox);this.setState({fileLoading:!0}),i.doGetYamlFileContent(e).then((function(e){var n=o.getUpdatedInputs(t.props.workflow.parameters,t.state.params,e);t.setState({errors:{},params:n,fileLoading:!1})})).catch((function(e){var n="Loading values from YAML file failed: ".concat(_.isString(e)?e:e.message);t.setState({errors:{yamlFile:n},fileLoading:!1})}))}}},{key:"handleInputChange",value:function(e,t){this.setState({params:g({},this.state.params,{},Stage.Basic.Form.fieldNameValue(t))})}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.ApproveButton,r=t.CancelButton,o=t.Divider,i=t.Form,a=t.Header,l=t.Icon,s=t.Modal,c=t.Message,u=t.TimePicker,p=Stage.Common,d=p.InputsHeader,f=p.InputsUtils,h=p.YamlFileButton,m=g({name:"",parameters:[]},this.props.workflow),y=g({id:""},this.props.deployment),v=_.isEmpty(this.props.deployments)?y.id:_.size(this.props.deployments)>1?"multiple deployments":this.props.deployments[0];return React.createElement(s,{open:this.props.open,onClose:function(){return e.props.onHide()},closeOnEscape:!1,className:"executeWorkflowModal"},React.createElement(s.Header,null,React.createElement(l,{name:"road"})," Execute workflow ",m.name,v&&" on ".concat(v)),React.createElement(s.Content,null,React.createElement(i,{loading:this.state.loading,errors:this.state.errors,scrollToError:!0,onErrorsDismiss:function(){return e.setState({errors:{}})}},!_.isEmpty(m.parameters)&&React.createElement(h,{onChange:this.handleYamlFileChange.bind(this),dataType:"execution parameters",fileLoading:this.state.fileLoading}),React.createElement(d,{header:"Parameters",compact:!0}),_.isEmpty(m.parameters)&&React.createElement(c,{content:"No parameters available for the execution"}),f.getInputFields(m.parameters,this.handleInputChange.bind(this),this.state.params,this.state.errors),React.createElement(i.Divider,null,React.createElement(a,{size:"tiny"},"Actions")),React.createElement(i.Field,null,React.createElement(i.Checkbox,{name:"force",toggle:!0,label:"Force",help:'Execute the workflow even if there is an ongoing execution for the given deployment. You cannot use this option with "Queue".',checked:this.state.force,onChange:function(t,n){return e.setState({force:n.checked,queue:!1,errors:{}})}})),React.createElement(i.Field,null,React.createElement(i.Checkbox,{name:"dryRun",toggle:!0,label:"Dry run",help:'If set, no actual operations will be performed. Executed tasks will be logged without side effects. You cannot use this option with "Queue".',checked:this.state.dryRun,onChange:function(t,n){return e.setState({dryRun:n.checked,queue:!1,errors:{}})}})),React.createElement(i.Field,null,React.createElement(i.Checkbox,{name:"queue",toggle:!0,label:"Queue",help:'If set, executions that can`t currently run will be queued and run automatically when possible. You cannot use this option with "Force" and "Dry run".',checked:this.state.queue,onChange:function(t,n){return e.setState({queue:n.checked,force:!1,dryRun:!1,schedule:!1,scheduledTime:"",errors:{}})}})),React.createElement(i.Field,{error:!!this.state.errors.scheduledTime},React.createElement(i.Checkbox,{name:"schedule",toggle:!0,label:"Schedule",help:'If set, workflow will be executed at specific time (local timezone) provided below. You cannot use this option with "Queue".',checked:this.state.schedule,onChange:function(t,n){return e.setState({schedule:n.checked,queue:!1,errors:{}})}}),this.state.schedule&&React.createElement(o,{hidden:!0}),this.state.schedule&&React.createElement(u,{name:"scheduledTime",value:this.state.scheduledTime,defaultValue:"",minDate:moment(),maxDate:moment().add(1,"Y"),onChange:function(t,n){return e.setState({scheduledTime:n.value,queue:!1,errors:{}})}})))),React.createElement(s.Actions,null,React.createElement(r,{onClick:this.onCancel.bind(this),disabled:this.state.loading}),React.createElement(n,{onClick:this.onApprove.bind(this),disabled:this.state.loading,content:"Execute",icon:"rocket",color:"green"})))}}]),t}(React.Component);h()(y,"initialState",{errors:{},loading:!1,dryRun:!1,fileLoading:!1,force:!1,queue:!1,schedule:!1,scheduledTime:"",params:{}}),h()(y,"propTypes",{toolbox:PropTypes.object.isRequired,open:PropTypes.bool.isRequired,deployment:PropTypes.object,deployments:PropTypes.array,workflow:PropTypes.object.isRequired,onExecute:PropTypes.func,onHide:PropTypes.func.isRequired}),h()(y,"defaultProps",{deployment:{},deployments:[],onExecute:_.noop}),Stage.defineCommon({name:"ExecuteDeploymentModal",common:y})},function(e,t,n){"use strict";n.r(t);var r=n(10),o=n.n(r),i=n(11),a=n.n(i),l=n(1),s=n.n(l),c=n(2),u=n.n(c),p=function(){function e(t){s()(this,e),this.toolbox=t}var t;return u()(e,[{key:"doGetExecutions",value:function(e){return this.toolbox.getManager().doGet("/executions?_include=id,status,ended_at",{deployment_id:e})}},{key:"doGetStatus",value:function(e){return this.toolbox.getManager().doGet("/executions?_include=id,status",{id:e})}},{key:"doAct",value:function(e,t){return this.toolbox.getManager().doPost("/executions/".concat(e.id),null,{deployment_id:e.deployment_id,action:t})}},{key:"waitUntilFinished",value:(t=a()(o.a.mark((function e(t,n){var r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doGetStatus(t);case 2:if(r=e.sent,i=_.filter(r.items,Stage.Utils.Execution.isActiveExecution),_.isEmpty(i)){e.next=10;break}return e.next=7,new Promise((function(e){return setTimeout(e,n)}));case 7:return e.next=9,this.waitUntilFinished(t,n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}();Stage.defineCommon({name:"ExecutionActions",common:p})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"doGetTextFileContent",value:function(e){return this.toolbox.getInternal().doUpload("/file/text",null,{file:e},"post",!1)}},{key:"doGetYamlFileContent",value:function(e){return this.toolbox.getInternal().doUpload("/file/yaml",null,{file:e},"post")}}]),e}();Stage.defineCommon({name:"FileActions",common:l})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=n(7),g=n.n(m),y=function(e){function t(){return o()(this,t),s()(this,u()(t).apply(this,arguments))}return d()(t,e),a()(t,[{key:"render",value:function(){var e=Stage.Basic,t=e.Segment,n=e.Icon,r=e.Popup,o=0===this.props.value,i=this.props.state,a=o?"grey":i.colorSUI;return React.createElement(r,{header:_.capitalize(i.name),content:this.props.description,trigger:React.createElement(t.Group,{className:this.props.className,disabled:o,onClick:this.props.onClick},React.createElement(t,{color:a,disabled:o,inverted:!0},React.createElement(n,{name:i.icon})),React.createElement(t,{color:a,disabled:o,tertiary:!0,inverted:!0},this.props.value))})}}]),t}(React.Component);h()(y,"propTypes",{value:g.a.number,onClick:g.a.func,state:g.a.shape({name:g.a.string.isRequired,colorSUI:g.a.string.isRequired,icon:g.a.string.isRequired}).isRequired,className:g.a.string.isRequired,description:g.a.object.isRequired}),h()(y,"defaultProps",{value:0,onClick:function(){}}),Stage.defineCommon({name:"GroupState",common:y})},function(e,t,n){"use strict";var r=n(48);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e,n){return o()(this,t),s()(this,u()(t).call(this,e,n))}return d()(t,e),a()(t,[{key:"shouldComponentUpdate",value:function(e){return!_.isEqual(this.props,e)}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.Form,r=t.Header,o=t.List,i=t.PopupHelp,a=function(){return React.createElement(r,{size:"tiny"},e.props.header,React.createElement(r.Subheader,null,"See values typing details: ",React.createElement(i,{flowing:!0,header:"Value type",content:React.createElement("div",null,"Values are casted to types, e.g.:",React.createElement(o,{bulleted:!0},React.createElement(o.Item,null,React.createElement("strong",null,"[1, 2]")," will be casted to an array"),React.createElement(o.Item,null,React.createElement("strong",null,"524")," will be casted to a number")),"Surround value with ",React.createElement("strong",null,'"')," to explicitly declare it as a string, e.g.:",React.createElement(o,{bulleted:!0},React.createElement(o.Item,null,React.createElement("strong",null,'"{"a":"b"}"')," will be send as string not an object"),React.createElement(o.Item,null,React.createElement("strong",null,'"true"')," will be send as string not a boolean value")),"Use ",React.createElement("strong",null,'""')," for an empty string.")})))};return this.props.dividing?React.createElement(n.Divider,{style:this.props.compact?{marginTop:0}:{}},React.createElement(a,null)):React.createElement(a,null)}}]),t}(React.Component);h()(m,"propTypes",{compact:PropTypes.bool,dividing:PropTypes.bool,header:PropTypes.string}),h()(m,"defaultProps",{compact:!1,dividing:!0,header:"Deployment inputs"}),Stage.defineCommon({name:"InputsHeader",common:m})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(0),s=n.n(l);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var u=function(){function e(){o()(this,e)}return a()(e,null,[{key:"getEnhancedStringValue",value:function(t){var n=Stage.Utils.Json,r=n.getStringValue(t);if(""===r)return e.EMPTY_STRING;var o=n.toType(t),i=n.getTypedValue(r);return o!==n.toType(i)&&(r='"'.concat(r,'"')),r}},{key:"getInputFieldInitialValue",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=Stage.Utils.Json;if(_.isNil(t))switch(n){case"list":return e.DEFAULT_INITIAL_VALUE_FOR_LIST;case"dict":return e.DEFAULT_INITIAL_VALUE_FOR_DICT;case"boolean":case"integer":case"float":case"string":default:return _.isUndefined(r)?e.DEFAULT_INITIAL_VALUE:e.getTemplateForDataType(r,!0)}else switch(n){case"boolean":case"integer":case"float":return t;case"list":case"dict":return o.getStringValue(t);case"string":default:return e.getEnhancedStringValue(t)}}},{key:"getTemplateForDataType",value:function(e,t){var n=e.properties,r=[];_.map(n,(function(e,t){var n='"'.concat(t,'":');_.isUndefined(e.default)?n+=function(e){switch(e){case"boolean":return"true";case"integer":return"0";case"float":return"0.0";case"string":return'"..."';case"dict":return"{}";case"list":return"[]";case"regex":return'"regexp"';default:return'""'}}(e.type):_.isString(e.default)?n+='"'.concat(e.default,'"'):n+=Stage.Utils.Json.getStringValue(e.default);r.push(n)}));var o="{".concat(_.join(r,","),"}");if(!t)try{o=JSON.parse(o)}catch(e){o="{}"}return o}},{key:"getRevertToDefaultIcon",value:function(t,n,r,o){var i=Stage.Basic.RevertToDefaultIcon,a=Stage.Utils.Json,l=a.getStringValue(n),s=_.startsWith(l,e.STRING_VALUE_SURROUND_CHAR)&&_.endsWith(l,e.STRING_VALUE_SURROUND_CHAR)&&_.size(l)>1?l.slice(1,-1):a.getTypedValue(n),c=r,u=e.getInputFieldInitialValue(r,a.toCloudifyType(c));return _.isNil(c)?void 0:React.createElement(i,{value:s,defaultValue:c,onClick:function(){return o(null,{name:t,value:u})}})}},{key:"getHelp",value:function(t,n,r,o,i){var a=Stage.Basic,l=a.Header,s=a.List,c=a.ParameterValue,u=function(e){var t=e.show,n=e.name,r=e.value;return t&&React.createElement(React.Fragment,null,React.createElement(l,{as:"h4"},n),React.createElement("div",null,r))},p=_.isUndefined(o)?_.isUndefined(i)?null:e.getTemplateForDataType(i):o;return React.createElement("div",null,React.createElement(u,{name:"Description",show:!_.isEmpty(t),value:t}),React.createElement(u,{name:"Type",show:!_.isEmpty(n),value:n}),React.createElement(u,{name:"Constraints",show:!_.isEmpty(r),value:React.createElement(s,{bulleted:!0},_.map(r,(function(e){var t=_.first(_.keys(e));return React.createElement(s.Item,{key:t},_.capitalize(_.lowerCase(t)),": ",String(e[t]))})))}),React.createElement(u,{name:_.isUndefined(o)?"Example":"Default Value",show:!_.isUndefined(o)||!_.isUndefined(i),value:React.createElement(c,{value:p})}))}},{key:"getFormInputField",value:function(t,n,r,o,i,a,l,s,c){var u=Stage.Basic.Form,p=e.getHelp(o,l,s,r,c);switch(l){case"boolean":return React.createElement(u.Field,{key:t,help:p,required:_.isNil(r)},e.getInputField(t,n,r,i,a,l,s));case"integer":return React.createElement(u.Field,{key:t,error:a,help:p,required:_.isNil(r),label:t},e.getInputField(t,n,r,i,a,l,s));case"string":default:return React.createElement(u.Field,{key:t,error:a,help:p,required:_.isNil(r),label:t},e.getInputField(t,n,r,i,a,l,s))}}},{key:"getInputField",value:function(t,n,r,o,i,a,l){var s,c,u=Stage.Basic.Form;if(!_.isEmpty(l)){var p=function(e,t){var n=_.findIndex(e,t);return n>=0?e[n][t]:null},d=p(l,"valid_values");if(!_.isNull(d)){var f=_.map(d,(function(e){return{name:e,text:e,value:e}}));return React.createElement("div",{style:{position:"relative"}},React.createElement(u.Dropdown,{name:t,value:n,fluid:!0,selection:!0,error:!!i,options:f,onChange:o}),React.createElement("div",{style:{position:"absolute",top:10,right:30}},e.getRevertToDefaultIcon(t,n,r,o)))}var h=p(l,"in_range"),m=p(l,"greater_than"),g=p(l,"greater_or_equal"),y=p(l,"less_than"),v=p(l,"less_or_equal");s=_.max([h?h[0]:null,m,g]),c=_.min([h?h[1]:null,y,v])}switch(a){case"boolean":var b=!1===n||!0===n,E=b?n:void 0;return React.createElement(React.Fragment,null,React.createElement(u.Checkbox,{name:t,toggle:!0,label:t,checked:E,indeterminate:!b,onChange:o}),"   ",e.getRevertToDefaultIcon(t,n,r,o));case"integer":case"float":return React.createElement(u.Input,{name:t,value:n,fluid:!0,error:!!i,type:"number",step:"integer"===a?1:"any",min:s,max:c,icon:e.getRevertToDefaultIcon(t,n,r,o),onChange:o});case"dict":case"list":return React.createElement("div",{style:{position:"relative"}},React.createElement(u.Json,{name:t,value:n,onChange:o,error:!!i}),React.createElement("div",{style:{position:"absolute",top:10,right:10}},e.getRevertToDefaultIcon(t,n,r,o)));case"string":case"regex":return _.includes(n,"\n")?React.createElement("div",{style:{position:"relative"}},React.createElement(u.TextArea,{name:t,value:n,onChange:o}),React.createElement("div",{style:{position:"absolute",top:10,right:10}},e.getRevertToDefaultIcon(t,n,r,o))):React.createElement(u.Input,{name:t,value:n,fluid:!0,error:!!i,icon:e.getRevertToDefaultIcon(t,n,r,o),onChange:o});default:return React.createElement("div",{style:{position:"relative"}},React.createElement(u.Json,{name:t,value:n,onChange:o,error:!!i}),React.createElement("div",{style:{position:"absolute",top:10,right:10}},e.getRevertToDefaultIcon(t,n,r,o)))}}},{key:"getInputFields",value:function(t,n,r,o,i){var a=_.sortBy(_.map(t,(function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:t},e)})),[function(e){return!_.isNil(e.default)},"name"]);return _.map(a,(function(t){var a=!_.isEmpty(i)&&t.type?i[t.type]:void 0,l=_.isNil(r[t.name])?e.getInputFieldInitialValue(t.default,t.type,a):r[t.name];return e.getFormInputField(t.name,l,t.default,t.description,n,o[t.name],t.type,t.constraints,a)}))}},{key:"getInputsInitialValuesFrom",value:function(t){var n={};return _.forEach(t.inputs,(function(r,o){var i=!_.isEmpty(t.data_types)&&r.type?t.data_types[r.type]:void 0;n[o]=e.getInputFieldInitialValue(r.default,r.type,i)})),n}},{key:"validateInputTypes",value:function(e,t){var n=[],r=!0;if(_.forEach(e,(function(e,o){var i=e.type,a=t[o];if(!_.isUndefined(i)&&!_.isUndefined(a)){var l=Stage.Utils.Json.toCloudifyType(a);"boolean"!==i&&"integer"!==i||i===l||(n.push(o),r=!1)}})),!r)throw new Error("The following fields have invalid types: ".concat(_.join(n,", "),"."))}},{key:"getUpdatedInputs",value:function(t,n,r){var o={};return e.validateInputTypes(t,r),_.forEach(t,(function(t,i){var a=r[i],l=n[i];_.isNil(a)?o[i]=l:o[i]=e.getInputFieldInitialValue(a,t.type)})),o}},{key:"getPlanForUpdate",value:function(e,t){var n=_.cloneDeep(e);return _.forEach(n,(function(e,r){_.isUndefined(t[r])||_.isUndefined(n[r].default)||(n[r].default=t[r])})),n}},{key:"getInputsToSend",value:function(t,n,r){var o=Stage.Utils.Json,i={};return _.forEach(t,(function(t,a){var l=o.getStringValue(n[a]),s=o.getTypedValue(n[a]);_.isEmpty(l)&&_.isNil(t.default)?r[a]=!0:_.startsWith(l,e.STRING_VALUE_SURROUND_CHAR)&&_.endsWith(l,e.STRING_VALUE_SURROUND_CHAR)&&_.size(l)>1&&(s=l.slice(1,-1)),_.isEqual(s,t.default)||(i[a]=s)})),i}},{key:"addErrors",value:function(e,t){_.forEach(_.keys(e),(function(e){return t[e]="Please provide ".concat(e)}))}},{key:"getErrorObject",value:function(e){var t=e.match(/Property type validation failed in '(.[^']+)'/),n=e.match(/Value of input (.[^ ]+) is missing/),r=e.match(/of input (.[^ ]+) violates constraint/),o="error";return t?o=t[1]:n?o=n[1]:r&&(o=r[1]),s()({},o,e)}}]),e}();s()(u,"DEFAULT_INITIAL_VALUE_FOR_LIST","[]"),s()(u,"DEFAULT_INITIAL_VALUE_FOR_DICT","{}"),s()(u,"DEFAULT_INITIAL_VALUE",""),s()(u,"STRING_VALUE_SURROUND_CHAR",'"'),s()(u,"EMPTY_STRING",'""'),Stage.defineCommon({name:"InputsUtils",common:u})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var g=function(e){function t(e,n){var r;return o()(this,t),(r=s()(this,u()(t).call(this,e,n))).state={errorModalOpen:!1,open:!1},r}return d()(t,e),a()(t,[{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.CancelButton,r=t.Button,o=t.CopyToClipboardButton,i=t.ExecutionStatus,a=t.HighlightText,l=t.Icon,s=t.Table,c=t.Modal,u=t.Popup,p=Stage.Utils,d=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({workflow_id:"",status:""},this.props.execution),f=!!d.scheduled_for,g=f?5:4;return _.isEmpty(d.status)?null:React.createElement(React.Fragment,null,React.createElement(u,{wide:"very",on:"hover",hoverable:!0,open:this.state.open,onOpen:function(){return e.setState({open:!0})},onClose:function(){return e.setState({open:!1})},onClick:function(t){t.stopPropagation(),e.setState({open:!1})}},React.createElement(u.Trigger,null,React.createElement("div",{style:{display:"inline-block"}},React.createElement(i,{execution:d,allowShowingPopup:!1,showLabel:this.props.showLabel,showWorkflowId:this.props.showLabel,labelProps:{attached:this.props.labelAttached?"top left":void 0},iconProps:{attached:this.props.showLabel?void 0:"top left",size:"large"}}))),React.createElement(u.Header,null,"Last Execution"),React.createElement(u.Content,null,React.createElement(s,{compact:!0,celled:!0},React.createElement(s.Header,null,React.createElement(s.Row,{textAlign:"center"},React.createElement(s.HeaderCell,null,"Workflow"),React.createElement(s.HeaderCell,null,"Status"),React.createElement(s.HeaderCell,null,"Created"),f&&React.createElement(s.HeaderCell,null,"Scheduled"),React.createElement(s.HeaderCell,null,"Ended"))),React.createElement(s.Body,null,React.createElement(s.Row,{textAlign:"center"},React.createElement(s.Cell,null,d.workflow_id),React.createElement(s.Cell,null,d.status_display||d.status),React.createElement(s.Cell,null,Stage.Utils.Time.formatTimestamp(d.created_at)),f&&React.createElement(s.Cell,null,Stage.Utils.Time.formatTimestamp(d.scheduled_for)),React.createElement(s.Cell,null,Stage.Utils.Time.formatTimestamp(d.ended_at)))),React.createElement(s.Footer,{fullWidth:!0},React.createElement(s.Row,{textAlign:"center"},React.createElement(s.HeaderCell,{colSpan:g},p.Execution.isFailedExecution(d)&&React.createElement(r,{icon:!0,labelPosition:"left",color:"red",onClick:function(){return e.setState({errorModalOpen:!0})}},React.createElement(l,{name:"remove"}),"Show Error"),React.createElement(r,{icon:!0,labelPosition:"left",color:"grey",onClick:this.props.onShowLogs},React.createElement(l,{name:"file text"}),"Show Logs"),p.Execution.isUpdateExecution(d)&&React.createElement(r,{icon:!0,labelPosition:"left",color:"blue",onClick:function(){return e.props.onShowUpdateDetails(_.get(d,"parameters.update_id"))}},React.createElement(l,{name:"magnify"}),"Show Update Details"))),React.createElement(s.Row,{textAlign:"center"},React.createElement(s.HeaderCell,{colSpan:g},(p.Execution.isCancelledExecution(d)||p.Execution.isFailedExecution(d))&&React.createElement(r,{icon:!0,labelPosition:"left",color:"green",onClick:function(){return e.props.onActOnExecution(d,p.Execution.FORCE_RESUME_ACTION)}},React.createElement(l,{name:"play"}),"Resume"),(p.Execution.isActiveExecution(d)||p.Execution.isWaitingExecution(d))&&React.createElement(r,{icon:!0,labelPosition:"left",color:"yellow",onClick:function(){return e.props.onActOnExecution(d,p.Execution.CANCEL_ACTION)}},React.createElement(l,{name:"cancel"}),"Cancel"),(p.Execution.isActiveExecution(d)||p.Execution.isWaitingExecution(d))&&React.createElement(r,{icon:!0,labelPosition:"left",color:"orange",onClick:function(){return e.props.onActOnExecution(d,p.Execution.FORCE_CANCEL_ACTION)}},React.createElement(l,{name:"cancel"}),"Force Cancel"),React.createElement(r,{icon:!0,labelPosition:"left",color:"red",onClick:function(){return e.props.onActOnExecution(d,p.Execution.KILL_CANCEL_ACTION)}},React.createElement(l,{name:"stop"}),"Kill Cancel"))))))),p.Execution.isFailedExecution(d)&&React.createElement(c,{open:this.state.errorModalOpen,onClose:function(){return e.setState({errorModalOpen:!1})}},React.createElement(c.Header,null,"Error message from '",d.workflow_id,"' worfklow execution on '",d.deployment_id,"' deployment"),React.createElement(c.Content,null,React.createElement(a,null,d.error)),React.createElement(c.Actions,null,React.createElement(o,{content:"Copy Error",text:d.error}),React.createElement(n,{onClick:function(t){t.stopPropagation(),e.setState({errorModalOpen:!1})},content:"Close"}))))}}]),t}(React.Component);h()(g,"propTypes",{execution:PropTypes.object,onShowLogs:PropTypes.func,onShowUpdateDetails:PropTypes.func,onActOnExecution:PropTypes.func,showLabel:PropTypes.bool,labelAttached:PropTypes.bool}),h()(g,"defaultProps",{execution:{workflow_id:"",status:""},onShowLogs:_.noop,onShowUpdateDetails:_.noop,onActOnExecution:_.noop,showLabel:!1,labelAttached:!0}),Stage.defineCommon({name:"LastExecutionStatusIcon",common:g})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"isAvailable",value:function(){var e=Stage.Common.Consts.leaflet.urlTemplate,t=_.template(e,{interpolate:/{([\s\S]+?)}/g})({x:0,y:0,z:0,r:""}),n=(new Date).getTime();return this.toolbox.getInternal().doGet(t,{noCache:n}).then((function(){return!0})).catch((function(){return!1}))}}]),e}();Stage.defineCommon({name:"MapsActions",common:l})},function(e,t){Stage.defineCommon({name:"createMarkerIcon",common:function(e){return new L.Icon({iconUrl:Stage.Utils.Url.widgetResourceUrl("common","/images/marker-icon-".concat(e,".png"),!1),shadowUrl:Stage.Utils.Url.widgetResourceUrl("common","/images/marker-shadow.png",!1),iconAnchor:[12,41],popupAnchor:[1,-34]})}})},function(e,t){Stage.defineCommon({name:"NodeInstancesConsts",common:{groupStates:[{name:"uninitialized",icon:"cancel",colorSUI:"blue",colorHTML:"#2185d0",states:["uninitialized"]},{name:"in progress",icon:"spinner",colorSUI:"yellow",colorHTML:"#fbbd08",states:["initializing","creating","created","configuring","configured","starting","stopping","stopped","deleting"]},{name:"started",icon:"checkmark",colorSUI:"green",colorHTML:"#21ba45",states:["started"]},{name:"deleted",icon:"trash",colorSUI:"black",colorHTML:"#1b1c1d",states:["deleted"]}]}})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"doDelete",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.toolbox.getManager().doDelete("/plugins/".concat(e.id),null,{force:t})}},{key:"doUpload",value:function(e,t,n,r,o){var i={visibility:e};_.isEmpty(t)||(i.wagonUrl=t),_.isEmpty(n)||(i.yamlUrl=n);var a={};return r&&(a.wagon_file=r),o&&(a.yaml_file=o),this.toolbox.getInternal().doUpload("/plugins/upload",i,_.isEmpty(a)?null:a,"post")}},{key:"doDownload",value:function(e){var t="/plugins/".concat(e.id,"/archive"),n="".concat(e.package_name,"_").concat(e.package_version,".zip");return this.toolbox.getManager().doDownload(t,n)}},{key:"doSetVisibility",value:function(e,t){return this.toolbox.getManager().doPatch("/plugins/".concat(e,"/set-visibility"),null,{visibility:t})}}]),e}();Stage.defineCommon({name:"PluginActions",common:l})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e,n){var r;return o()(this,t),(r=s()(this,u()(t).call(this,e,n))).state=t.initialState,r}return d()(t,e),a()(t,[{key:"onApprove",value:function(){return this._submitRole(),!1}},{key:"onCancel",value:function(){return this.props.onHide(),!0}},{key:"componentDidUpdate",value:function(e){!e.open&&this.props.open&&this.setState(g({},t.initialState,{role:this.props.resource.role}))}},{key:"_submitRole",value:function(){var e=this,t={};if(_.isEmpty(this.state.role)&&(t.role="Please provide a role"),!_.isEmpty(t))return this.setState({errors:t}),!1;this.setState({loading:!0}),this.props.onSetRole(this.props.resource.name,this.state.role).then((function(){e.setState({errors:{},loading:!1}),e.props.toolbox.refresh(),e.props.onHide()})).catch((function(t){e.setState({errors:{error:t.message},loading:!1})}))}},{key:"_handleInputChange",value:function(e,t){this.setState(Stage.Basic.Form.fieldNameValue(t))}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.Modal,r=t.Icon,o=t.Form,i=t.ApproveButton,a=t.CancelButton,l=g({name:""},this.props.resource);return React.createElement(n,{open:this.props.open,onClose:function(){return e.props.onHide()},className:"roleModal"},React.createElement(n.Header,null,React.createElement(r,{name:"male"})," Set role for ",l.name),React.createElement(n.Content,null,React.createElement(o,{loading:this.state.loading,errors:this.state.errors,onErrorsDismiss:function(){return e.setState({errors:{}})}},React.createElement(o.Field,{error:this.state.errors.role},React.createElement(o.Dropdown,{selection:!0,name:"role",placeholder:"Role",options:this.props.roles,value:this.state.role,onChange:this._handleInputChange.bind(this)})))),React.createElement(n.Actions,null,React.createElement(a,{onClick:this.onCancel.bind(this),disabled:this.state.loading}),React.createElement(i,{onClick:this.onApprove.bind(this),disabled:this.state.loading,icon:"male",color:"green"})))}}]),t}(React.Component);h()(y,"initialState",{loading:!1,role:"",errors:{}}),Stage.defineCommon({name:"RoleModal",common:y})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e,n){return o()(this,t),s()(this,u()(t).call(this,e,n))}return d()(t,e),a()(t,[{key:"_handleInputChange",value:function(e,t){this.props.onUpdate(t.name,t.value)}},{key:"render",value:function(){var e=this,t=Stage.Basic.Form,n=_.reverse(_.map(_.filter(this.props.toolbox.getManager()._data.roles,{type:"tenant_role"}),(function(e){return{text:e.name,value:e.name}})));return React.createElement("span",null,_.map(this.props.resources,(function(r,o){return React.createElement(t.Field,{key:o,label:"Choose a role for ".concat(e.props.resourceName," ").concat(o,":")},React.createElement(t.Dropdown,{placeholder:"Choose a role",selection:!0,options:n,name:o,value:r,onChange:e._handleInputChange.bind(e)}))})))}}]),t}(React.Component);h()(m,"propTypes",{onUpdate:PropTypes.func.isRequired,resources:PropTypes.object.isRequired,resourceName:PropTypes.string.isRequired,toolbox:PropTypes.object.isRequired}),Stage.defineCommon({name:"RolesPicker",common:m})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e,n){return o()(this,t),s()(this,u()(t).call(this,e,n))}return d()(t,e),a()(t,[{key:"render",value:function(){var e="";return _.forEach(_.omit(this.props.groupRoles,this.props.directRole),(function(t,n){e+="".concat(n," (").concat(t.join(", "),"), ")})),e=e.slice(0,-2),_.isEmpty(this.props.groupRoles)?this.props.directRole&&React.createElement("span",null,this.props.directRole):_.has(this.props.groupRoles,this.props.directRole)?_.isEmpty(e)?React.createElement("span",null,this.props.directRole," (",this.props.groupRoles[this.props.directRole].join(", "),")"):React.createElement("span",null,this.props.directRole," (",this.props.groupRoles[this.props.directRole].join(", "),"),"," ",e):this.props.directRole?React.createElement("span",null,this.props.directRole,", ",e):React.createElement("span",null,e)}}]),t}(React.Component);h()(m,"propTypes",{groupRoles:PropTypes.object,directRole:PropTypes.string}),Stage.defineCommon({name:"RolesPresenter",common:m})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(){o()(this,e)}return a()(e,null,[{key:"getTenantRoles",value:function(e){return _.filter(e,{type:"tenant_role"})}},{key:"getDefaultRoleName",value:function(e){return _.reverse(this.getTenantRoles(e))[0].name}},{key:"getSystemRole",value:function(e){return e?Stage.Common.Consts.sysAdminRole:Stage.Common.Consts.defaultUserRole}}]),e}();Stage.defineCommon({name:"RolesUtil",common:l})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=function(){function e(t){o()(this,e),this.toolbox=t}return a()(e,[{key:"doGet",value:function(e){return this.toolbox.getManager().doGet("/secrets/".concat(e))}},{key:"doDelete",value:function(e){return this.toolbox.getManager().doDelete("/secrets/".concat(e))}},{key:"doCreate",value:function(e,t,n,r){return this.toolbox.getManager().doPut("/secrets/".concat(e),null,{value:t,visibility:n,is_hidden_value:r})}},{key:"doUpdate",value:function(e,t){return this.toolbox.getManager().doPatch("/secrets/".concat(e),null,{value:t})}},{key:"doSetIsHiddenValue",value:function(e,t){return this.toolbox.getManager().doPatch("/secrets/".concat(e),null,{is_hidden_value:t})}},{key:"doSetVisibility",value:function(e,t){return this.toolbox.getManager().doPatch("/secrets/".concat(e,"/set-visibility"),null,{visibility:t})}}]),e}();Stage.defineCommon({name:"SecretActions",common:l})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e,n){var r;return o()(this,t),(r=s()(this,u()(t).call(this,e,n))).state=t.initialState(e),r}return d()(t,e),a()(t,[{key:"componentDidUpdate",value:function(e){var n=this;!e.open&&this.props.open&&(this.setState({loading:!0}),new Stage.Common.BlueprintActions(this.props.toolbox).doGetBlueprints().then((function(e){n.setState(g({},t.initialState(n.props),{blueprints:e}))})).catch((function(e){n.setState({loading:!1,error:e.message})})).then((function(){n._selectBlueprint({},{value:n.props.deployment.blueprint_id})})))}},{key:"onUpdate",value:function(){var e=this;return this.setState({errors:{},loading:!0,showPreview:!1},(function(){return e._submitUpdate(!1)})),!1}},{key:"onPreview",value:function(){var e=this;return this.setState({errors:{},loading:!0,showPreview:!1},(function(){return e._submitUpdate(!0)})),!0}},{key:"onCancel",value:function(){return this.props.onHide(),!0}},{key:"_submitUpdate",value:function(e){var t=this,n=Stage.Common.InputsUtils,r={};_.isEmpty(this.state.blueprint.id)&&(r.blueprintName="Please select blueprint");var o={},i=n.getPlanForUpdate(this.state.blueprint.plan.inputs,this.props.deployment.inputs),a=n.getInputsToSend(i,this.state.deploymentInputs,o);if(n.addErrors(o,r),!_.isEmpty(r))return this.setState({errors:r,loading:!1}),!1;new Stage.Common.DeploymentActions(this.props.toolbox).doUpdate(this.props.deployment.id,this.state.blueprint.id,a,this.state.installWorkflow,this.state.uninstallWorkflow,this.state.installWorkflowFirst,this.state.ignoreFailure,this.state.automaticReinstall,this.state.reinstallList,this.state.force,e).then((function(n){e?t.setState({errors:{},loading:!1,showPreview:!0,previewData:n}):(t.setState({errors:{},loading:!1}),t.props.toolbox.refresh(),t.props.onHide(),t.props.toolbox.getEventBus().trigger("nodes:refresh"),t.props.toolbox.getEventBus().trigger("inputs:refresh"),t.props.toolbox.getEventBus().trigger("outputs:refresh"),t.props.toolbox.getEventBus().trigger("executions:refresh"))})).catch((function(e){var r=n.getErrorObject(e.message);t.setState({loading:!1,errors:r})}))}},{key:"_handleInputChange",value:function(e,t){var n=Stage.Basic.Form.fieldNameValue(t);this.setState(n)}},{key:"_handleDeploymentInputChange",value:function(e,t){var n=Stage.Basic.Form.fieldNameValue(t);this.setState({deploymentInputs:g({},this.state.deploymentInputs,{},n)})}},{key:"_handleYamlFileChange",value:function(e){var t=this;if(e){var n=Stage.Common,r=n.FileActions,o=n.InputsUtils,i=new r(this.props.toolbox);this.setState({fileLoading:!0}),i.doGetYamlFileContent(e).then((function(e){var n=o.getUpdatedInputs(t.state.blueprint.plan.inputs,t.state.deploymentInputs,e);t.setState({errors:{},deploymentInputs:n,fileLoading:!1})})).catch((function(e){var n="Loading values from YAML file failed: ".concat(_.isString(e)?e:e.message);t.setState({errors:{yamlFile:n},fileLoading:!1})}))}}},{key:"_selectBlueprint",value:function(e,t){var n=this;_.isEmpty(t.value)?this.setState({blueprint:Stage.Common.DeployBlueprintModal.EMPTY_BLUEPRINT,errors:{}}):(this.setState({loading:!0}),new Stage.Common.BlueprintActions(this.props.toolbox).doGetFullBlueprintData({id:t.value}).then((function(e){var t={},r=n.props.deployment.inputs;_.forEach(e.plan.inputs,(function(n,o){t[o]=Stage.Common.InputsUtils.getInputFieldInitialValue(r[o],n.type,e.plan.data_types)})),n.setState({deploymentInputs:t,blueprint:e,errors:{},loading:!1})})).catch((function(e){n.setState({blueprint:Stage.Common.DeployBlueprintModal.EMPTY_BLUEPRINT,loading:!1,errors:{error:e.message}})})))}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.ApproveButton,r=t.CancelButton,o=t.Form,i=t.Header,a=t.Icon,l=t.Message,s=t.Modal,c=t.NodeInstancesFilter,u=Stage.Common,p=u.DataTypesButton,d=u.InputsHeader,f=u.InputsUtils,h=u.YamlFileButton,m=u.UpdateDetailsModal,y=g({items:[]},this.state.blueprints),v=_.map(y.items,(function(e){return{text:e.id,value:e.id}})),b=this.state.showPreview?{skip_install:!this.state.installWorkflow,skip_uninstall:!this.state.uninstallWorkflow,skip_reinstall:!this.state.automaticReinstall,reinstall_list:this.state.reinstallList}:{};return React.createElement(s,{open:this.props.open,onClose:function(){return e.props.onHide()},closeOnEscape:!1,className:"updateDeploymentModal"},React.createElement(s.Header,null,React.createElement(a,{name:"edit"})," Update deployment ",this.props.deployment.id),React.createElement(s.Content,null,React.createElement(o,{loading:this.state.loading,errors:this.state.errors,scrollToError:!0,onErrorsDismiss:function(){return e.setState({errors:{}})}},React.createElement(o.Field,{error:this.state.errors.blueprintName,label:"Blueprint",required:!0},React.createElement(o.Dropdown,{search:!0,selection:!0,value:this.state.blueprint.id,placeholder:"Select Blueprint",name:"blueprintName",options:v,onChange:this._selectBlueprint.bind(this)})),this.state.blueprint.id&&React.createElement(React.Fragment,null,!_.isEmpty(this.state.blueprint.plan.inputs)&&React.createElement(h,{onChange:this._handleYamlFileChange.bind(this),dataType:"deployment's inputs",fileLoading:this.state.fileLoading}),!_.isEmpty(this.state.blueprint.plan.data_types)&&React.createElement(p,{types:this.state.blueprint.plan.data_types}),React.createElement(d,null),_.isEmpty(this.state.blueprint.plan.inputs)&&React.createElement(l,{content:"No inputs available for the selected blueprint"})),f.getInputFields(this.state.blueprint.plan.inputs,this._handleDeploymentInputChange.bind(this),this.state.deploymentInputs,this.state.errors,this.state.blueprint.plan.data_types),React.createElement(o.Divider,null,React.createElement(i,{size:"tiny"},"Actions")),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Run install workflow",toggle:!0,name:"installWorkflow",help:"Run install lifecycle operations",checked:this.state.installWorkflow,onChange:this._handleInputChange.bind(this)})),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Run uninstall workflow",toggle:!0,name:"uninstallWorkflow",help:"Run uninstall lifecycle operations",checked:this.state.uninstallWorkflow,onChange:this._handleInputChange.bind(this)})),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Run install workflow first",help:"Run install workflow first and then uninstall workflow. Default: first uninstall and then install",toggle:!0,name:"installWorkflowFirst",checked:this.state.installWorkflowFirst,onChange:this._handleInputChange.bind(this)})),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Ignore failures in uninstall workflow",toggle:!0,name:"ignoreFailure",help:"Supply the parameter `ignore_failure` with the value `true` to the uninstall workflow",checked:this.state.ignoreFailure,onChange:this._handleInputChange.bind(this)})),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Run automatic reinstall",name:"automaticReinstall",toggle:!0,help:'Automatically reinstall node instances that their properties has been modified, as part of a deployment update. If not set, then node instances that were explicitly given to "Reinstall node instances list" will still be reinstalled',checked:this.state.automaticReinstall,onChange:this._handleInputChange.bind(this)})),React.createElement(c,{name:"reinstallList",deploymentId:this.props.deployment.id,label:"Reinstall node instances list",value:this.state.reinstallList,placeholder:"Choose node instances to reinstall",upward:!0,onChange:this._handleInputChange.bind(this),help:'Node instances ids to be reinstalled as part of deployment update. They will be reinstalled even if "Run automatic reinstall" is not set'}),React.createElement(o.Field,null,React.createElement(o.Checkbox,{label:"Force update",name:"force",toggle:!0,help:"Force running update in case a previous update on this deployment has failed to finished successfully",checked:this.state.force,onChange:this._handleInputChange.bind(this)}))),React.createElement(m,{open:this.state.showPreview,isPreview:!0,deploymentUpdate:this.state.previewData,executionParameters:b,onClose:function(){return e.setState({showPreview:!1})},onUpdate:this.onUpdate.bind(this),toolbox:this.props.toolbox})),React.createElement(s.Actions,null,React.createElement(r,{onClick:this.onCancel.bind(this),disabled:this.state.loading}),React.createElement(n,{onClick:this.onPreview.bind(this),disabled:this.state.loading,content:"Preview",icon:"zoom",color:"blue"}),React.createElement(n,{onClick:this.onUpdate.bind(this),disabled:this.state.loading,content:"Update",icon:"edit",color:"green"})))}}]),t}(React.Component);h()(y,"initialState",(function(e){return{loading:!1,errors:{},blueprints:[],yamlFile:null,fileLoading:!1,blueprint:Stage.Common.DeployBlueprintModal.EMPTY_BLUEPRINT,deploymentInputs:g({},e.deployment.inputs),installWorkflow:!0,uninstallWorkflow:!0,installWorkflowFirst:!1,ignoreFailure:!1,automaticReinstall:!0,reinstallList:[],showPreview:!1,previewData:{},force:!1}})),h()(y,"propTypes",{toolbox:PropTypes.object.isRequired,open:PropTypes.bool.isRequired,deployment:PropTypes.object.isRequired,onHide:PropTypes.func.isRequired}),Stage.defineCommon({name:"UpdateDeploymentModal",common:y})},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));var r=n(9),o=n.n(r),i=n(0),a=n.n(i),l=n(12),s=n.n(l),c=n(1),u=n.n(c),p=n(2),d=n.n(p),f=n(3),h=n.n(f),m=n(4),g=n.n(m),y=n(5),v=n.n(y),b=n(15);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e){var t=Stage.Basic.Header,n=e.oldBlueprint!==e.newBlueprint;return React.createElement(React.Fragment,null,React.createElement(t,null,"Blueprint"),n?React.createElement("span",null,"Changed from ",React.createElement("strong",null,e.oldBlueprint)," into ",React.createElement("strong",null,e.newBlueprint),"."):React.createElement("span",null,"Not changed."))}var C=function(e){function t(e){var n;return u()(this,t),(n=h()(this,g()(t).call(this,e))).state={showOnlyChanged:!1},n}return v()(t,e),d()(t,[{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.Form,r=t.Header,o=t.Icon,i=t.List,a=t.ParameterValue,l=t.ParameterValueDescription,s=t.Popup,c=t.PopupHelp,u=t.Table,p=Stage.Utils.Json,d=Array.sort(_.keys(this.props.newInputs)),f=_.chain(d).filter((function(t){return!_.isEqual(p.getStringValue(e.props.newInputs[t]||""),p.getStringValue(e.props.oldInputs[t]||""))})).uniq().value(),h=!_.isEqual(this.props.oldInputs,this.props.newInputs),m=function(e){var t=e.stringA,n=e.stringB,r=Object(b.diffChars)(String(t),String(n));return React.createElement("div",null,_.map(r,(function(e,t){var n=e.added?{color:"green"}:e.removed?{color:"red",textDecoration:"line-through"}:null;return React.createElement("span",{key:"part_".concat(t),style:n},e.value)})))};return React.createElement(React.Fragment,null,React.createElement(r,null,h&&React.createElement(n.Checkbox,{name:"showOnlyChanged",toggle:!0,label:"Show only changed",help:"Show only inputs which have different values",className:"rightFloated",checked:this.state.showOnlyChanged,onChange:function(){return e.setState({showOnlyChanged:!e.state.showOnlyChanged})}}),"Inputs",h&&React.createElement(r.Subheader,null,"See details: ",React.createElement(c,{content:React.createElement("div",null,React.createElement("div",null,"To show only changed inputs use ",React.createElement("strong",null,"Show only changed")," toggle."),React.createElement("br",null),React.createElement("div",null,"To see difference between old and new inputs hover over ",React.createElement(o,{name:"asterisk",color:"red",size:"tiny",className:"superscripted"})," character on the right side of changed input to open popup with change details."),React.createElement("br",null),React.createElement("div",null,"Inside popup you will see text in:",React.createElement(i,{bulleted:!0},React.createElement(i.Item,null,React.createElement("span",{style:{color:"green"}},"green")," - added characters"),React.createElement(i.Item,null,React.createElement("span",{style:{color:"red"}},"red")," - removed characters"),React.createElement(i.Item,null,React.createElement("span",{style:{color:"black"}},"black")," - unchanged characters"))))}))),h?React.createElement(u,{striped:!0},React.createElement(u.Header,null,React.createElement(u.Row,null,React.createElement(u.HeaderCell,{width:4},"Input"),React.createElement(u.HeaderCell,{width:6},"Old ",React.createElement(l,null)),React.createElement(u.HeaderCell,{width:6},"New ",React.createElement(l,null)))),React.createElement(u.Body,null,_.map(this.state.showOnlyChanged?f:d,(function(t){var n=_.get(e.props.oldInputs,t,""),r=p.getStringValue(n),i=_.get(e.props.newInputs,t,""),l=p.getStringValue(i),c=!_.isEqual(r,l);return React.createElement(u.Row,{key:t},React.createElement(u.Cell,null,t),React.createElement(u.Cell,null,React.createElement(a,{value:n,showCopyButton:!1})),React.createElement(u.Cell,null,React.createElement(a,{value:i,showCopyButton:!1}),c&&React.createElement(s,null,React.createElement(s.Trigger,null,React.createElement(o,{name:"asterisk",color:"red",size:"tiny",className:"superscripted"})),React.createElement(s.Content,null,React.createElement(m,{stringA:r,stringB:l})))))})))):React.createElement("span",null,"No inputs changed."))}}]),t}(React.Component);function S(e){var t=Stage.Basic,n=t.Card,r=t.Icon,o=t.Label,i=t.List;return React.createElement(n,{key:e.name,color:e.color},React.createElement(n.Content,null,React.createElement(n.Header,null,React.createElement(r,{name:e.icon,color:e.color}),_.capitalize(_.lowerCase(e.name)),e.action&&React.createElement(o,{className:"right floated"},e.action,": ",e.workflowSkipped?"No":"Yes")),React.createElement(n.Description,null,_.isEmpty(e.instances)?React.createElement("span",null,"No node instances"):React.createElement(i,{bulleted:!0},_.map(e.instances,(function(e){return React.createElement(i.Item,{key:e},e)}))))))}function k(e){var t=Stage.Basic,n=t.Card,r=t.Header,o=t.PopupHelp,i=!_.isEmpty(_.filter(e.types,(function(e){return _.size(e.instances)>0})));return React.createElement(React.Fragment,null,React.createElement(r,null,"Node Instances",i&&React.createElement(r.Subheader,null,"See details: ",React.createElement(o,{content:React.createElement("div",null,"Four different categories present added, removed, modified, explicitly reinstalled node instances.",React.createElement("br",null),"Bulleted list contain modified node instance ID and node ID in round brackets.",React.createElement("br",null),"In upper right corner of the card you can see if install/uninstall/reinstall workflows are executed.")}))),i?React.createElement(n.Group,{itemsPerRow:2},_.map(e.types,(function(e){return React.createElement(S,s()({key:e.name},e))}))):React.createElement("span",null,"No node instances changed."))}function P(e){var t=Stage.Basic,n=t.Header,r=t.Table,o=!_.isEmpty(e.steps);return React.createElement(React.Fragment,null,React.createElement(n,null,"Steps",o&&React.createElement(n.Subheader,null,"Action steps taken during update.")),o?React.createElement(r,{striped:!0,definition:!0},React.createElement(r.Header,null,React.createElement(r.Row,null,React.createElement(r.HeaderCell,{collapsing:!0}),React.createElement(r.HeaderCell,null,"Action"),React.createElement(r.HeaderCell,null,"Entity Type"),React.createElement(r.HeaderCell,null,"Entity ID"))),React.createElement(r.Body,null,_.map(e.steps,(function(e,t){return React.createElement(r.Row,{key:e.id},React.createElement(r.Cell,null,t+1),React.createElement(r.Cell,null,e.action),React.createElement(r.Cell,null,e.entity_type),React.createElement(r.Cell,null,e.entity_id))})))):React.createElement("span",null,"No action steps."))}var x=function(e){function t(e,n){var r;return u()(this,t),(r=h()(this,g()(t).call(this,e,n))).state=R({},t.initialState),r}return v()(t,e),d()(t,[{key:"shouldComponentUpdate",value:function(e,t){return!_.isEqual(this.props,e)||!_.isEqual(this.state,t)}},{key:"componentDidUpdate",value:function(e){var n=this;if(_.isEmpty(this.props.deploymentUpdateId)||e.open||!this.props.open)e.open&&!this.props.open&&this.setState(R({},t.initialState));else{this.setState({loading:!0});var r=new Stage.Common.DeploymentUpdatesActions(this.props.toolbox);r.doGetUpdate(this.props.deploymentUpdateId).then((function(e){_.isEmpty(n.props.executionParameters)&&!_.isEmpty(e.execution_id)?r.doGetExecutionParameters(e.execution_id).then((function(t){var r=t.parameters;return n.setState({loading:!1,error:null,deploymentUpdate:e,executionParameters:r})})).catch((function(e){return n.setState({loading:!1,error:e.message,deploymentUpdate:t.EMPTY_DEPLOYMENT_UPDATE})})):n.setState({loading:!1,error:null,deploymentUpdate:e})})).catch((function(e){n.setState({loading:!1,error:e.message,deploymentUpdate:t.EMPTY_DEPLOYMENT_UPDATE})}))}}},{key:"getInstances",value:function(e,t){var n=_.get(e,"deployment_update_node_instances.".concat(t,"_and_related.affected"),[]);return _.map(n,(function(e){return e.id}))}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.ApproveButton,r=t.CancelButton,i=t.Form,a=t.Icon,l=t.Modal,s=_.isEmpty(this.props.deploymentUpdateId)?this.props.deploymentUpdate:this.state.deploymentUpdate,c=_.isEmpty(this.props.executionParameters)?this.state.executionParameters:this.props.executionParameters;return React.createElement("div",null,React.createElement(l,{open:this.props.open,onClose:function(){return e.props.onClose()},className:"updateDetailsModal"},React.createElement(l.Header,null,React.createElement(a,{name:"zoom"})," Deployment update details",this.props.isPreview?" preview":s.id?" - ".concat(s.id):""),React.createElement(l.Content,{scrolling:!0},React.createElement(i,{loading:this.state.loading,errors:this.state.errors,onErrorsDismiss:function(){return e.setState({errors:{}})}},React.createElement(w,{oldBlueprint:s.old_blueprint_id,newBlueprint:s.new_blueprint_id}),React.createElement(C,{oldInputs:s.old_inputs,newInputs:s.new_inputs}),React.createElement(k,{types:[{name:"add",icon:"plus",color:"green",action:"Install",workflowSkipped:c.skip_install,instances:this.getInstances(s,"added")},{name:"remove",icon:"minus",color:"red",action:"Uninstall",workflowSkipped:c.skip_uninstall,instances:this.getInstances(s,"removed")},{name:"modify",icon:"edit",color:"teal",action:"Reinstall",workflowSkipped:c.skip_reinstall,instances:_.uniq([].concat(o()(this.getInstances(s,"extended")),o()(this.getInstances(s,"reduced"))))},{name:"explicit_reinstall",icon:"sync",color:"blue",instances:c.reinstall_list}]}),React.createElement(P,{steps:s.steps}))),React.createElement(l.Actions,null,React.createElement(r,{onClick:this.props.onClose,content:"Close"}),this.props.isPreview&&React.createElement(n,{onClick:this.props.onUpdate,content:"Update",icon:"edit",color:"green"}))))}}]),t}(React.Component);a()(x,"EMPTY_DEPLOYMENT_UPDATE",{old_inputs:{},new_inputs:{},old_blueprint_id:"",new_blueprint_id:"",steps:[]}),a()(x,"EMPTY_EXECUTION_PARAMETERS",{skip_install:!1,skip_uninstall:!1,skip_reinstall:!1,reinstall_list:[]}),a()(x,"initialState",{loading:!1,error:null,deploymentUpdate:R({},x.EMPTY_DEPLOYMENT_UPDATE),executionParameters:R({},x.EMPTY_EXECUTION_PARAMETERS)}),a()(x,"propTypes",{toolbox:PropTypes.object.isRequired,open:PropTypes.bool.isRequired,isPreview:PropTypes.bool,deploymentUpdateId:PropTypes.string,deploymentUpdate:PropTypes.object,executionParameters:PropTypes.object,onClose:PropTypes.func,onUpdate:PropTypes.func}),a()(x,"defaultProps",{isPreview:!1,deploymentUpdateId:"",deploymentUpdate:{},executionParameters:{},onClose:_.noop,onUpdate:_.noop}),Stage.defineCommon({name:"UpdateDetailsModal",common:x})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e){var n;return o()(this,t),(n=s()(this,u()(t).call(this,e))).state=t.initialState,n.blueprintFileRef=React.createRef(),n.imageFileRef=React.createRef(),n.actions=new Stage.Common.BlueprintActions(e.toolbox),n}return d()(t,e),a()(t,[{key:"componentDidMount",value:function(){var e=this;this.blueprintFileRef.current&&this.blueprintFileRef.current.reset(),this.imageFileRef.current&&this.imageFileRef.current.reset(),this.setState(t.initialState),(!_.isEmpty(this.props.blueprintUrl)&&Stage.Utils.Url.isUrl(this.props.blueprintUrl)||!_.isNil(this.props.blueprintFile))&&(this.setState({loading:!0}),this.actions.doListYamlFiles(this.props.blueprintUrl,this.props.blueprintFile,!1).then((function(t){e.setState({yamlFiles:t,loading:!1})})).catch((function(t){e.setState({yamlFiles:[],loading:!1}),e.props.onChange({errors:{error:t}})})))}},{key:"_handleInputChange",value:function(e,n){this.props.onChange(g({},t.NO_ERRORS,{},Stage.Basic.Form.fieldNameValue(n)))}},{key:"_onBlueprintUrlBlur",value:function(){var e=this;!_.isEmpty(this.props.blueprintUrl)&&Stage.Utils.Url.isUrl(this.props.blueprintUrl)?(this.setState({loading:!0},(function(){return e.props.onChange({blueprintFile:null})})),this.blueprintFileRef.current&&this.blueprintFileRef.current.reset(),this.actions.doListYamlFiles(this.props.blueprintUrl,null,!0).then((function(n){e.setState({yamlFiles:n,loading:!1},(function(){var r=n.shift(),o=_.includes(n,t.DEFAULT_BLUEPRINT_YAML_FILE)?t.DEFAULT_BLUEPRINT_YAML_FILE:n[0];e.props.onChange(g({},t.NO_ERRORS,{blueprintName:r,blueprintFileName:o}))}))})).catch((function(t){e.setState({loading:!1},(function(){return e.props.onChange({errors:{error:t.message},blueprintName:"",blueprintFileName:""})}))}))):this.setState({yamlFiles:[]},this.resetErrors)}},{key:"_onBlueprintUrlFocus",value:function(){this.props.blueprintFile&&(this.blueprintFileRef.current&&this.blueprintFileRef.current.reset(),this._onBlueprintFileReset())}},{key:"_onBlueprintFileChange",value:function(e){var n=this;e?(this.setState({loading:!0}),this.actions.doListYamlFiles(null,e,!0).then((function(r){var o=r.shift(),i=_.includes(r,t.DEFAULT_BLUEPRINT_YAML_FILE)?t.DEFAULT_BLUEPRINT_YAML_FILE:r[0];n.setState({yamlFiles:r,loading:!1},(function(){n.props.onChange(g({},t.NO_ERRORS,{blueprintFile:e,blueprintUrl:e.name,blueprintName:o,blueprintFileName:i}))}))})).catch((function(e){n.setState({loading:!1},(function(){return n.props.onChange({errors:{error:e.message},blueprintName:"",blueprintFileName:""})}))}))):this.setState({yamlFiles:[]},this.resetErrors)}},{key:"_onBlueprintFileReset",value:function(){var e=this;this.setState({yamlFiles:[]},(function(){return e.props.onChange(g({},t.NO_ERRORS,{blueprintFile:null,blueprintUrl:"",blueprintName:"",blueprintFileName:""}))}))}},{key:"_onBlueprintImageUrlFocus",value:function(){this.props.imageFile&&(this.imageFileRef.current&&this.imageFileRef.current.reset(),this._onBlueprintImageReset())}},{key:"_onBlueprintImageChange",value:function(e){e&&this.props.onChange(g({},t.NO_ERRORS,{imageUrl:e.name,imageFile:e}))}},{key:"_onBlueprintImageReset",value:function(){this.props.onChange(g({},t.NO_ERRORS,{imageUrl:"",imageFile:null}))}},{key:"resetErrors",value:function(){this.props.onChange(t.NO_ERRORS)}},{key:"render",value:function(){var e=Stage.Basic,t=e.Form,n=e.Label,r=_.map(this.state.yamlFiles,(function(e){return{text:e,value:e}}));return React.createElement(t,{loading:this.state.loading||this.props.loading,errors:this.props.showErrorsSummary?this.props.errors:null,onErrorsDismiss:this.resetErrors.bind(this)},React.createElement(t.Field,{label:"Blueprint package",required:!0,error:this.props.errors.blueprintUrl,help:"You can provide single YAML file or blueprint archive. Supported types are: yml, yaml, zip, tar, tar.gz and tar.bz2. The archive package must contain exactly one directory that includes at least one YAML file."},React.createElement(t.UrlOrFile,{name:"blueprint",value:this.props.blueprintUrl,placeholder:"Provide the blueprint's URL or click browse to select a file",onChangeUrl:this._handleInputChange.bind(this),onFocusUrl:this._onBlueprintUrlFocus.bind(this),onBlurUrl:this._onBlueprintUrlBlur.bind(this),onChangeFile:this._onBlueprintFileChange.bind(this),onResetFile:this._onBlueprintFileReset.bind(this),label:React.createElement(n,null,this.props.blueprintFile?"File":"URL"),fileInputRef:this.blueprintFileRef})),React.createElement(t.Field,{label:"Blueprint name",required:!0,error:this.props.errors.blueprintName,help:"The package is uploaded to the Manager as a blueprint with the name you specify here."},React.createElement(t.Input,{name:"blueprintName",value:this.props.blueprintName,onChange:this._handleInputChange.bind(this)})),React.createElement(t.Field,{label:"Blueprint YAML file",required:!0,error:this.props.errors.blueprintFileName,help:"If you choose archive as blueprint package, you must specify the blueprint YAML file for your environment, because the archive can contain more than one YAML file."},React.createElement(t.Dropdown,{name:"blueprintFileName",search:!0,selection:!0,options:r,value:this.props.blueprintFileName,onChange:this._handleInputChange.bind(this)})),React.createElement(t.Field,{label:"Blueprint icon",error:this.props.errors.imageUrl,help:"(Optional) The blueprint icon file is shown with the blueprint in the local blueprint widget."},React.createElement(t.UrlOrFile,{name:"image",value:this.props.imageUrl,placeholder:"Provide the image file URL or click browse to select a file",onChangeUrl:this._handleInputChange.bind(this),onFocusUrl:this._onBlueprintImageUrlFocus.bind(this),onBlurUrl:_.noop,onChangeFile:this._onBlueprintImageChange.bind(this),onResetFile:this._onBlueprintImageReset.bind(this),label:React.createElement(n,null,this.props.imageFile?"File":"URL"),fileInputRef:this.imageFileRef})))}}]),t}(React.Component);h()(y,"propTypes",{blueprintUrl:PropTypes.string,blueprintFile:PropTypes.object,blueprintName:PropTypes.string,blueprintFileName:PropTypes.string,imageUrl:PropTypes.string,imageFile:PropTypes.object,errors:PropTypes.object,loading:PropTypes.bool,showErrorsSummary:PropTypes.bool,onChange:PropTypes.func.isRequired,toolbox:PropTypes.object.isRequired}),h()(y,"defaultProps",{blueprintUrl:"",blueprintFile:null,blueprintName:"",blueprintFileName:"",imageUrl:"",imageFile:null,errors:{},loading:!1,showErrorsSummary:!0}),h()(y,"initialState",{loading:!1,yamlFiles:[]}),h()(y,"DEFAULT_BLUEPRINT_YAML_FILE","blueprint.yaml"),h()(y,"NO_ERRORS",{errors:{}}),Stage.defineCommon({name:"UploadBlueprintForm",common:y})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e){var n;return o()(this,t),(n=s()(this,u()(t).call(this,e))).state=t.initialState,n.actions=new Stage.Common.BlueprintActions(e.toolbox),n}return d()(t,e),a()(t,[{key:"componentDidUpdate",value:function(e){e.open&&!this.props.open&&this.setState(t.initialState)}},{key:"shouldComponentUpdate",value:function(e,t){return!_.isEqual(this.props.open,e.open)||!_.isEqual(this.state,t)}},{key:"uploadBlueprint",value:function(){var e=this,t=this.state.blueprintFile?"":this.state.blueprintUrl,n=this.state.imageFile?"":this.state.imageUrl,r={};if(this.state.blueprintFile||(_.isEmpty(t)?r.blueprintUrl="Please select blueprint package":Stage.Utils.Url.isUrl(t)||(r.blueprintUrl="Please provide valid URL for blueprint package")),_.isEmpty(this.state.blueprintName)&&(r.blueprintName="Please provide blueprint name"),_.isEmpty(this.state.blueprintFileName)&&(r.blueprintFileName="Please provide blueprint YAML file"),_.isEmpty(n)||Stage.Utils.Url.isUrl(t)||(r.imageUrl="Please provide valid URL for blueprint icon"),!_.isEmpty(r))return this.setState({errors:r}),!1;this.setState({loading:!0}),this.actions.doUpload(this.state.blueprintName,this.state.blueprintFileName,t,this.state.blueprintFile,n,this.state.imageFile,this.state.visibility).then((function(){e.setState({errors:{},loading:!1},e.props.onHide),e.props.toolbox.refresh()})).catch((function(t){e.setState({errors:{error:t.message},loading:!1})}))}},{key:"onFormFieldChange",value:function(e){this.setState(e)}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.ApproveButton,r=t.CancelButton,o=t.Icon,i=t.Modal,a=t.VisibilityField,l=Stage.Common.UploadBlueprintForm;return React.createElement("div",null,React.createElement(i,{open:this.props.open,onClose:this.props.onHide,className:"uploadBlueprintModal"},React.createElement(i.Header,null,React.createElement(o,{name:"upload"})," Upload blueprint",React.createElement(a,{visibility:this.state.visibility,className:"rightFloated",onVisibilityChange:function(t){return e.setState({visibility:t})}})),React.createElement(i.Content,null,React.createElement(l,{blueprintUrl:this.state.blueprintUrl,blueprintFile:this.state.blueprintFile,blueprintName:this.state.blueprintName,blueprintFileName:this.state.blueprintFileName,imageUrl:this.state.imageUrl,imageFile:this.state.imageFile,errors:this.state.errors,loading:this.state.loading,onChange:this.onFormFieldChange.bind(this),toolbox:this.props.toolbox})),React.createElement(i.Actions,null,React.createElement(r,{onClick:this.props.onHide,disabled:this.state.loading}),React.createElement(n,{onClick:this.uploadBlueprint.bind(this),disabled:this.state.loading,content:"Upload",icon:"upload",color:"green"}))))}}]),t}(React.Component);h()(m,"propTypes",{open:PropTypes.bool.isRequired,onHide:PropTypes.func.isRequired,toolbox:PropTypes.object.isRequired}),h()(m,"initialState",{loading:!1,visibility:Stage.Common.Consts.defaultVisibility,blueprintUrl:"",blueprintFile:null,blueprintName:"",blueprintFileName:"",imageUrl:"",imageFile:null,errors:{}}),Stage.defineCommon({name:"UploadBlueprintModal",common:m})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e){var n;return o()(this,t),(n=s()(this,u()(t).call(this,e))).wagonFileRef=React.createRef(),n.yamlFileRef=React.createRef(),n}return d()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.wagonFileRef.current&&this.wagonFileRef.current.reset(),this.yamlFileRef.current&&this.yamlFileRef.current.reset(),this.resetErrors()}},{key:"resetErrors",value:function(){this.props.onChange(t.NO_ERRORS)}},{key:"_handleInputChange",value:function(e,n){this.props.onChange(g({},t.NO_ERRORS,{},Stage.Basic.Form.fieldNameValue(n)))}},{key:"_onWagonUrlFocus",value:function(){this.props.wagonFile&&(this.wagonFileRef.current&&this.wagonFileRef.current.reset(),this._onWagonFileReset())}},{key:"_onWagonFileChange",value:function(e){this.props.onChange(g({},t.NO_ERRORS,{wagonFile:e||null,wagonUrl:e?e.name:""}))}},{key:"_onWagonFileReset",value:function(){this.props.onChange(g({},t.NO_ERRORS,{wagonFile:null,wagonUrl:""}))}},{key:"_onYamlUrlFocus",value:function(){this.props.yamlFile&&(this.yamlFileRef.current&&this.yamlFileRef.current.reset(),this._onYamlFileReset())}},{key:"_onYamlFileChange",value:function(e){this.props.onChange(g({},t.NO_ERRORS,{yamlFile:e||null,yamlUrl:e?e.name:""}))}},{key:"_onYamlFileReset",value:function(){this.props.onChange(g({},t.NO_ERRORS,{yamlFile:null,yamlUrl:""}))}},{key:"render",value:function(){var e=Stage.Basic,t=e.Container,n=e.Form,r=e.Label,o=[React.createElement(n.Field,{label:"Wagon file",required:this.props.addRequiredMarks,key:"wagon",error:this.props.errors.wagonUrl},React.createElement(n.UrlOrFile,{name:"wagon",value:this.props.wagonUrl,placeholder:this.props.wagonPlaceholder,onChangeUrl:this._handleInputChange.bind(this),onFocusUrl:this._onWagonUrlFocus.bind(this),onBlurUrl:_.noop,onChangeFile:this._onWagonFileChange.bind(this),onResetFile:this._onWagonFileReset.bind(this),label:React.createElement(r,null,this.props.wagonFile?"File":"URL"),fileInputRef:this.wagonFileRef})),React.createElement(n.Field,{label:"YAML file",required:this.props.addRequiredMarks,key:"yaml",error:this.props.errors.yamlUrl},React.createElement(n.UrlOrFile,{name:"yaml",value:this.props.yamlUrl,placeholder:this.props.yamlPlaceholder,onChangeUrl:this._handleInputChange.bind(this),onFocusUrl:this._onYamlUrlFocus.bind(this),onBlurUrl:_.noop,onChangeFile:this._onYamlFileChange.bind(this),onResetFile:this._onYamlFileReset.bind(this),label:React.createElement(r,null,this.props.yamlFile?"File":"URL"),fileInputRef:this.yamlFileRef}))];return this.props.wrapInForm?React.createElement(n,{errors:this.props.errors,onErrorsDismiss:this.resetErrors.bind(this),loading:this.props.loading},o):React.createElement(t,{fluid:!0},o)}}]),t}(React.Component);h()(y,"propTypes",{wagonUrl:PropTypes.string,wagonFile:PropTypes.object,wagonPlaceholder:PropTypes.string,yamlUrl:PropTypes.string,yamlFile:PropTypes.object,yamlPlaceholder:PropTypes.string,errors:PropTypes.object,loading:PropTypes.bool,onChange:PropTypes.func.isRequired,wrapInForm:PropTypes.bool,addRequiredMarks:PropTypes.bool}),h()(y,"defaultProps",{wagonUrl:"",wagonFile:null,wagonPlaceholder:"Provide the plugin's wagon file URL or click browse to select a file",yamlUrl:"",yamlFile:null,yamlPlaceholder:"Provide the plugin's YAML file URL or click browse to select a file",errors:{},loading:!1,wrapInForm:!0,addRequiredMarks:!0}),h()(y,"NO_ERRORS",{errors:{}}),Stage.defineCommon({name:"UploadPluginForm",common:y})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var g=function(e){function t(e){var n;return o()(this,t),(n=s()(this,u()(t).call(this,e))).state=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.initialState),n}return d()(t,e),a()(t,[{key:"componentDidUpdate",value:function(e){!e.open&&this.props.open&&this.setState(t.initialState)}},{key:"shouldComponentUpdate",value:function(e,t){return!_.isEqual(this.props.open,e.open)||!_.isEqual(this.state,t)}},{key:"uploadPlugin",value:function(){var e=this,t=this.state.wagonFile?"":this.state.wagonUrl,n=this.state.yamlFile?"":this.state.yamlUrl,r={};if(this.state.wagonFile||(_.isEmpty(t)?r.wagonUrl="Please select wagon file or provide URL to wagon file":Stage.Utils.Url.isUrl(t)||(r.wagonUrl="Please provide valid URL for wagon file")),this.state.yamlFile||(_.isEmpty(n)?r.yamlUrl="Please select YAML file or provide URL to YAML file":Stage.Utils.Url.isUrl(n)||(r.yamlUrl="Please provide valid URL for YAML file")),!_.isEmpty(r))return this.setState({errors:r}),!1;this.setState({loading:!0}),new Stage.Common.PluginActions(this.props.toolbox).doUpload(this.state.visibility,t,n,this.state.wagonFile,this.state.yamlFile).then((function(){e.setState({errors:{},loading:!1},e.props.onHide),e.props.toolbox.refresh()})).catch((function(t){e.setState({errors:{error:t.message},loading:!1})}))}},{key:"onFormFieldChange",value:function(e){this.setState(e)}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.ApproveButton,r=t.CancelButton,o=t.Icon,i=t.Modal,a=t.VisibilityField,l=Stage.Common.UploadPluginForm;return React.createElement(i,{open:this.props.open,onClose:this.props.onHide},React.createElement(i.Header,null,React.createElement(o,{name:"upload"})," Upload plugin",React.createElement(a,{visibility:this.state.visibility,className:"rightFloated",onVisibilityChange:function(t){return e.setState({visibility:t})}})),React.createElement(i.Content,null,React.createElement(l,{wagonUrl:this.state.wagonUrl,wagonFile:this.state.wagonFile,yamlUrl:this.state.yamlUrl,yamlFile:this.state.yamlFile,errors:this.state.errors,loading:this.state.loading,onChange:this.onFormFieldChange.bind(this)})),React.createElement(i.Actions,null,React.createElement(r,{onClick:this.props.onHide,disabled:this.state.loading}),React.createElement(n,{onClick:this.uploadPlugin.bind(this),disabled:this.state.loading,content:"Upload",icon:"upload",color:"green"})))}}]),t}(React.Component);h()(g,"propTypes",{open:PropTypes.bool.isRequired,onHide:PropTypes.func.isRequired,toolbox:PropTypes.object.isRequired}),h()(g,"initialState",{loading:!1,wagonUrl:"",wagonFile:null,yamlUrl:"",yamlFile:null,errors:{},visibility:Stage.Common.Consts.defaultVisibility}),Stage.defineCommon({name:"UploadPluginModal",common:g})},function(e,t,n){"use strict";n.r(t);var r=n(12),o=n.n(r),i=n(1),a=n.n(i),l=n(2),s=n.n(l),c=n(3),u=n.n(c),p=n(4),d=n.n(p),f=n(5),h=n.n(f),m=n(0),g=n.n(m),y=function(e){function t(){return a()(this,t),u()(this,d()(t).apply(this,arguments))}return h()(t,e),s()(t,[{key:"render",value:function(){var e=Stage.Basic.Menu,t=this.props,n=t.onClick,r=t.workflows;return _.map(r,(function(t){return React.createElement(e.Item,{name:t.name,content:_.capitalize(_.lowerCase(t.name)),key:t.name,onClick:function(){return n(t)}})}))}}]),t}(React.Component);g()(y,"propTypes",{workflows:PropTypes.array.isRequired,onClick:PropTypes.func}),g()(y,"defaultProps",{onClick:_.noop});var v=function(e){function t(e){var n;return a()(this,t),(n=u()(this,d()(t).call(this,e))).state={activeGroup:""},n}return h()(t,e),s()(t,[{key:"onGroupClick",value:function(e,t){e.stopPropagation();var n=t.index,r=this.state.activeGroup;this.setState({activeGroup:r===n?"":n})}},{key:"render",value:function(){var e=this,t=Stage.Basic,n=t.Accordion,r=t.Menu,o=this.props,i=o.workflowsGroups,a=o.onClick,l=this.state.activeGroup;return React.createElement(n,{as:r,vertical:!0,style:{boxShadow:"none"}},_.map(i,(function(t){return React.createElement(r.Item,{key:t.name},React.createElement(n.Title,{active:l===t.name,index:t.name,content:_.capitalize(_.lowerCase(t.name)),onClick:e.onGroupClick.bind(e)}),React.createElement(n.Content,{active:l===t.name},React.createElement(r.Menu,null,React.createElement(y,{workflows:t.workflows,onClick:a}))))})))}}]),t}(React.Component);g()(v,"propTypes",{workflowsGroups:PropTypes.arrayOf(PropTypes.shape({name:PropTypes.string,workflows:PropTypes.array})).isRequired,onClick:PropTypes.func}),g()(v,"defaultProps",{onClick:_.noop});var b=function(e){function t(){return a()(this,t),u()(this,d()(t).apply(this,arguments))}return h()(t,e),s()(t,[{key:"render",value:function(){var e=Stage.Basic,t=e.Menu,n=e.Popup,r=e.PopupMenu,i=this.props.workflows,a=_.chain(i).groupBy("plugin").map((function(e,t){return{name:t,workflows:e}})).sortBy("name").value(),l=1===_.size(a);return this.props.showInPopup?React.createElement(r,o()({className:"workflowAction",position:"bottom center",offset:0},this.props.popupMenuProps),!!this.props.trigger&&React.createElement(n.Trigger,null,this.props.trigger),l?React.createElement(t,{vertical:!0},React.createElement(y,{workflows:i,onClick:this.props.onClick})):React.createElement(v,{workflowsGroups:a,onClick:this.props.onClick})):l?React.createElement(y,{workflows:i,onClick:this.props.onClick}):React.createElement(v,{workflowsGroups:a,onClick:this.props.onClick})}}]),t}(React.Component);g()(b,"propTypes",{workflows:PropTypes.array.isRequired,onClick:PropTypes.func,popupMenuProps:PropTypes.object,showInPopup:PropTypes.bool,trigger:PropTypes.element}),g()(b,"defaultProps",{onClick:_.noop,showInPopup:!0,popupMenuProps:{},trigger:null}),Stage.defineCommon({name:"WorkflowsMenu",common:b})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(2),a=n.n(i),l=n(3),s=n.n(l),c=n(4),u=n.n(c),p=n(5),d=n.n(p),f=n(0),h=n.n(f),m=function(e){function t(e,n){return o()(this,t),s()(this,u()(t).call(this,e,n))}return d()(t,e),a()(t,[{key:"render",value:function(){var e=Stage.Basic.Form;return React.createElement(e.File,{name:"yamlFile",showInput:!1,showReset:!1,openButtonParams:{className:"rightFloated",content:"Load Values",labelPosition:"left"},onChange:this.props.onChange,help:"You can provide YAML file with ".concat(this.props.dataType," to automatically fill in the form."),loading:this.props.fileLoading,disabled:this.props.fileLoading})}}]),t}(React.Component);h()(m,"propTypes",{dataType:PropTypes.string,fileLoading:PropTypes.bool,onChange:PropTypes.func}),h()(m,"defaultProps",{dataType:"values",fileLoading:!1,onChange:_.noop}),Stage.defineCommon({name:"YamlFileButton",common:m})}]);
\ No newline at end of file
